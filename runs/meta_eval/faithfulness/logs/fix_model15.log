Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
======================================================================
Meta-Evaluation: UDS Faithfulness
======================================================================
P pool: 30 models (WITH forget knowledge)
N pool: 30 models (WITHOUT forget knowledge)
Batch size: 32
Delta threshold: 0.05
Output: runs/meta_eval/table2_faithfulness_fix
Metrics: em, es, prob, paraprob, truth_ratio, rouge, para_rouge, jailbreak_rouge, mia_loss, mia_zlib, mia_min_k, mia_min_kpp

Loading tokenizer + full + retain models...
  Full + Retain loaded on GPU (attn: sdpa)
Dataset: 367 examples
  Valid: 367, Skipped: 0
Model range: [15, 16) of 60 total

[1/1] P pool: open-unlearning/pos_tofu_Llama-3.2-1B-Instruct_full_lr3e-05_wd0.01_epoch10
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:07,  1.60it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:04,  2.26it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:05,  1.94it/s]Mem eval:  31%|███       | 4/13 [00:01<00:03,  2.26it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.52it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.76it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:02,  2.85it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  3.05it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  2.49it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:01,  2.71it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  2.82it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  2.90it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.28it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.70it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:08,  1.49it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:01<00:08,  1.31it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:02<00:08,  1.24it/s]Mem eval (multi):  31%|███       | 4/13 [00:03<00:07,  1.25it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:03<00:05,  1.34it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:04<00:04,  1.41it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:05<00:04,  1.27it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:05<00:03,  1.45it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:06<00:02,  1.42it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:07<00:02,  1.25it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:08<00:01,  1.27it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:09<00:00,  1.27it/s]Mem eval (multi): 100%|██████████| 13/13 [00:09<00:00,  1.37it/s]Mem eval (multi): 100%|██████████| 13/13 [00:09<00:00,  1.33it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:31,  1.96it/s]Mem eval (multi):   3%|▎         | 2/63 [00:01<00:38,  1.58it/s]Mem eval (multi):   5%|▍         | 3/63 [00:02<00:44,  1.34it/s]Mem eval (multi):   6%|▋         | 4/63 [00:02<00:39,  1.49it/s]Mem eval (multi):   8%|▊         | 5/63 [00:03<00:45,  1.27it/s]Mem eval (multi):  10%|▉         | 6/63 [00:04<00:46,  1.23it/s]Mem eval (multi):  11%|█         | 7/63 [00:05<00:42,  1.30it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:06<00:44,  1.25it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:06<00:44,  1.22it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:07<00:41,  1.27it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:08<00:43,  1.19it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:09<00:42,  1.19it/s]Mem eval (multi):  21%|██        | 13/63 [00:10<00:40,  1.23it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:11<00:40,  1.22it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:11<00:41,  1.17it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:12<00:40,  1.16it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:13<00:38,  1.20it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:14<00:37,  1.21it/s]Mem eval (multi):  30%|███       | 19/63 [00:15<00:35,  1.25it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:15<00:31,  1.35it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:16<00:31,  1.34it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:17<00:31,  1.31it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:18<00:30,  1.33it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:18<00:29,  1.33it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:19<00:27,  1.37it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:19<00:23,  1.59it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:20<00:24,  1.47it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:21<00:24,  1.42it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:22<00:23,  1.44it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:22<00:20,  1.62it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:23<00:20,  1.53it/s]Mem eval (multi):  51%|█████     | 32/63 [00:24<00:21,  1.47it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:24<00:19,  1.50it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:24<00:15,  1.82it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:25<00:12,  2.16it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:25<00:11,  2.45it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:25<00:09,  2.74it/s]Mem eval (multi):  60%|██████    | 38/63 [00:25<00:08,  3.02it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:26<00:07,  3.24it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:26<00:06,  3.42it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:26<00:06,  3.57it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:27<00:05,  3.51it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:27<00:05,  3.53it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:27<00:05,  3.54it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:27<00:05,  3.55it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:28<00:04,  3.55it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:28<00:04,  3.48it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:28<00:04,  3.45it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:29<00:04,  3.45it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:29<00:03,  3.45it/s]Mem eval (multi):  81%|████████  | 51/63 [00:29<00:03,  3.56it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:29<00:03,  3.57it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:30<00:02,  3.56it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:30<00:02,  3.46it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:30<00:02,  3.36it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:31<00:02,  3.33it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:31<00:01,  3.42it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:31<00:01,  3.33it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:32<00:01,  3.27it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:32<00:00,  3.29it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:32<00:00,  3.35it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:32<00:00,  3.38it/s]Mem eval (multi): 100%|██████████| 63/63 [00:33<00:00,  3.72it/s]Mem eval (multi): 100%|██████████| 63/63 [00:33<00:00,  1.90it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:07,  1.52it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:07,  1.40it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:08,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:07,  1.14it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:06,  1.16it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:04<00:05,  1.23it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:05<00:05,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.32it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:02,  1.39it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.41it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.44it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.37it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:09<00:00,  1.47it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:08,  1.46it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:10,  1.07it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:09,  1.05it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:08,  1.03it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:04<00:07,  1.09it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:05<00:06,  1.13it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.07it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:07<00:04,  1.16it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:08<00:03,  1.16it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.13it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:11<00:00,  1.25it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.43it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.31it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.05it/s] 31%|███       | 4/13 [00:01<00:02,  3.07it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.08it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.21it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.18it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.34it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.41it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.42it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.35it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.30it/s]100%|██████████| 13/13 [00:03<00:00,  3.67it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.24it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.23it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.21it/s] 31%|███       | 4/13 [00:01<00:02,  3.20it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.21it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.31it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.37it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.29it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.23it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.32it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.35it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.31it/s]100%|██████████| 13/13 [00:03<00:00,  3.59it/s]                                                 Done  110.3s
  Deleted cache: models--open-unlearning--pos_tofu_Llama-3.2-1B-Instruct_full_lr3e-05_wd0.01_epoch10 (4943 MB)

======================================================================
FAITHFULNESS RESULTS
======================================================================
>>> Faithfulness[em] = N/A
>>> Faithfulness[es] = N/A
>>> Faithfulness[prob] = N/A
>>> Faithfulness[paraprob] = N/A
>>> Faithfulness[truth_ratio] = N/A
>>> Faithfulness[rouge] = N/A
>>> Faithfulness[para_rouge] = N/A
>>> Faithfulness[jailbreak_rouge] = N/A
>>> Faithfulness[mia_loss] = N/A
>>> Faithfulness[mia_zlib] = N/A
>>> Faithfulness[mia_min_k] = N/A
>>> Faithfulness[mia_min_kpp] = N/A

Results saved to: runs/meta_eval/table2_faithfulness_fix/
  summary.json: AUC-ROC + pool stats
  results.json: per-model UDS scores
