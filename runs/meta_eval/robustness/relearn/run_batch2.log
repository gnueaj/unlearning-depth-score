======================================================================
Robustness Meta-Evaluation: RELEARN
======================================================================
GPU: 1
Models: 151 (1 retain + 150 unlearn)
Metrics: em, es, prob, paraprob, truth_ratio, rouge, para_rouge, jailbreak_rouge, mia_loss, mia_zlib, mia_min_k, mia_min_kpp, uds
Output: runs/meta_eval/robustness/relearn
Clear cache: False

Loading tokenizer and full model...
UDS data: 367 valid examples
Loading S1 cache from runs/meta_eval/s1_cache_sdpa.json...
Resumed from runs/meta_eval/robustness/relearn/results.json: 76 entries
Processing models [76:151] (75 models)

============================================================
[1/75] npo_lr2e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha1_epoch5
============================================================
  [Cache] Loaded 151 models from runs/method_eval/metrics_before.json
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.96it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.79it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.92it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.94it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.00it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.00it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.47it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.76it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.82it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.88it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.94it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.90it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.36it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.19it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.20it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.03it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.04it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.04it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:12,  2.02it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.96it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.83it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.87it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.95it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.96it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:09,  2.02it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:08,  2.13it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:06<00:08,  2.05it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.11it/s]Mem eval (multi):  50%|█████     | 16/32 [00:07<00:07,  2.04it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.07it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.10it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.19it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.28it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:04,  2.22it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.20it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.17it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.12it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.09it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.12it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.03it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.96it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.93it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.91it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.95it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.36it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.08it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.05it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.07s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.03it/s]gen:  57%|█████▋    | 4/7 [00:05<00:05,  1.75s/it]gen:  71%|███████▏  | 5/7 [00:08<00:04,  2.20s/it]gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.82s/it]gen: 100%|██████████| 7/7 [00:10<00:00,  1.50s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.01s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.28s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.10s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.04s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.04it/s]jb_gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.69s/it]jb_gen: 100%|██████████| 7/7 [00:09<00:00,  1.40s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.87it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.65it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.76it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.77it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.83it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.83it/s]100%|██████████| 7/7 [00:03<00:00,  2.28it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.81it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.84it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.81it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.78it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.22it/s]                                               Done in 91.7s
    uds: 0.3813
    em: 0.7983
    mia_loss: 0.9198

============================================================
[2/75] npo_lr2e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.02it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.78it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.90it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.92it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.98it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.98it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.44it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.85it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.81it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.94it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:17,  3.00s/it]gen:  29%|██▊       | 2/7 [00:06<00:15,  3.08s/it]gen:  43%|████▎     | 3/7 [00:07<00:08,  2.18s/it]gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.69s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.51s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.36s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.19s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.11s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.35s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.66s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.37s/it]jb_gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.16s/it]jb_gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.19s/it]jb_gen: 100%|██████████| 7/7 [00:08<00:00,  1.04s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 92.9s
    uds: 0.3936
    em: 0.7942
    mia_loss: 0.9189

============================================================
[3/75] npo_lr2e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.02it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.78it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.90it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.91it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.98it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.97it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.44it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.94it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.43s/it]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.19s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.01s/it]gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.06it/s]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.03s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.13s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.05s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:07,  1.17s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.07s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:03,  1.01it/s]jb_gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.03it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.08it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.07it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.16it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.2s
    uds: 0.4075
    em: 0.7947
    mia_loss: 0.9222

============================================================
[4/75] npo_lr5e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.99it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.08it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  1.99it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.87it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.91it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:03<00:18,  3.00s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.34s/it]gen:  43%|████▎     | 3/7 [00:07<00:10,  2.63s/it]gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.99s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.63s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.12s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.65s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:03<00:18,  3.05s/it]jb_gen:  29%|██▊       | 2/7 [00:06<00:15,  3.15s/it]jb_gen:  43%|████▎     | 3/7 [00:07<00:08,  2.17s/it]jb_gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.51s/it]jb_gen:  71%|███████▏  | 5/7 [00:11<00:03,  1.95s/it]jb_gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.36s/it]jb_gen: 100%|██████████| 7/7 [00:15<00:00,  1.81s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.74it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.81it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.25it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 101.7s
    uds: 0.6118
    em: 0.6789
    mia_loss: 0.6176

============================================================
[5/75] npo_lr5e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.72it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.01it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.13it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.09it/s]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.23s/it]gen:  43%|████▎     | 3/7 [00:05<00:06,  1.69s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.20s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.76s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.21s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.70s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:03<00:18,  3.05s/it]jb_gen:  29%|██▊       | 2/7 [00:06<00:15,  3.15s/it]jb_gen:  43%|████▎     | 3/7 [00:09<00:12,  3.10s/it]jb_gen:  57%|█████▋    | 4/7 [00:12<00:09,  3.07s/it]jb_gen:  71%|███████▏  | 5/7 [00:15<00:06,  3.06s/it]jb_gen:  86%|████████▌ | 6/7 [00:18<00:03,  3.08s/it]jb_gen: 100%|██████████| 7/7 [00:19<00:00,  2.30s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 105.4s
    uds: 0.6060
    em: 0.6774
    mia_loss: 0.6287

============================================================
[6/75] npo_lr5e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.99it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.88it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.01it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.08it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.01it/s]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.26s/it]gen:  43%|████▎     | 3/7 [00:05<00:06,  1.75s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.43s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.99s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.74s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.43s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.29s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.62s/it]jb_gen:  57%|█████▋    | 4/7 [00:05<00:03,  1.31s/it]jb_gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.21s/it]jb_gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.17s/it]jb_gen: 100%|██████████| 7/7 [00:08<00:00,  1.00s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 93.1s
    uds: 0.6400
    em: 0.6816
    mia_loss: 0.6452

============================================================
[7/75] npo_lr1e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr1e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.05it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.82it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.95it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.96it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.03it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.03it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.50it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]gen:  29%|██▊       | 2/7 [00:01<00:04,  1.04it/s]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.02it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.05it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.01it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.04it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.15s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.08s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.09s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.00s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.03s/it]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.13it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 86.8s
    uds: 0.1260
    em: 0.9091
    mia_loss: 0.9898

============================================================
[8/75] npo_lr1e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr1e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.04it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.81it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.95it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.96it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.03it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.02it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.49it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.74it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.09it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.07it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.12s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.05it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.02it/s]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.01s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.08it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:04,  1.22it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.01it/s]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.04it/s]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.04s/it]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.04it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.03it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.17it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 86.4s
    uds: 0.1344
    em: 0.9086
    mia_loss: 0.9896

============================================================
[9/75] npo_lr1e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr1e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.04it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.80it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.93it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.95it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.02it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.01it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.48it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.21it/s]gen:  29%|██▊       | 2/7 [00:01<00:05,  1.02s/it]gen:  43%|████▎     | 3/7 [00:02<00:04,  1.01s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.05it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.03it/s]gen:  86%|████████▌ | 6/7 [00:05<00:01,  1.01s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.07it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.16s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.03s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.03it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.11it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.09it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.20it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 86.0s
    uds: 0.1584
    em: 0.9029
    mia_loss: 0.9885

============================================================
[10/75] npo_lr2e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.78it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.90it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.91it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.97it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.14it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.98it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.79it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:17,  3.00s/it]gen:  29%|██▊       | 2/7 [00:06<00:15,  3.09s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.05s/it]gen:  57%|█████▋    | 4/7 [00:09<00:07,  2.41s/it]gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.90s/it]gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.62s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.33s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:17,  2.97s/it]jb_gen:  29%|██▊       | 2/7 [00:06<00:15,  3.11s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.06s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:04,  1.61s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:02,  1.46s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.33s/it]jb_gen: 100%|██████████| 7/7 [00:10<00:00,  1.16s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 96.8s
    uds: 0.3723
    em: 0.8067
    mia_loss: 0.9297

============================================================
[11/75] npo_lr2e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.01it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.78it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.90it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.91it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.97it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.08it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:03<00:18,  3.05s/it]gen:  29%|██▊       | 2/7 [00:06<00:15,  3.11s/it]gen:  43%|████▎     | 3/7 [00:07<00:08,  2.06s/it]gen:  57%|█████▋    | 4/7 [00:07<00:04,  1.54s/it]gen:  71%|███████▏  | 5/7 [00:08<00:02,  1.38s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.37s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.25s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.80s/it]jb_gen:  29%|██▊       | 2/7 [00:05<00:13,  2.63s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.86s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:04,  1.54s/it]jb_gen:  71%|███████▏  | 5/7 [00:07<00:02,  1.30s/it]jb_gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.23s/it]jb_gen: 100%|██████████| 7/7 [00:09<00:00,  1.07s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 94.0s
    uds: 0.3833
    em: 0.8003
    mia_loss: 0.9267

============================================================
[12/75] npo_lr2e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.01it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.78it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.90it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.91it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.98it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.97it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.98it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.09it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.42s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.22s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.09s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.04s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.05s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.14s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.05s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.03s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.07s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.00s/it]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.01it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.01it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.10it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.81it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.25it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.83it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.80it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.4s
    uds: 0.4049
    em: 0.7978
    mia_loss: 0.9268

============================================================
[13/75] npo_lr5e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.12it/s]gen:  29%|██▊       | 2/7 [00:01<00:04,  1.03it/s]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.05it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.10it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.07it/s]gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.66s/it]gen: 100%|██████████| 7/7 [00:08<00:00,  1.34s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.02it/s]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.29s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.66s/it]jb_gen:  57%|█████▋    | 4/7 [00:05<00:03,  1.32s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.94s/it]jb_gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.62s/it]jb_gen: 100%|██████████| 7/7 [00:10<00:00,  1.29s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.80it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 92.0s
    uds: 0.6009
    em: 0.6817
    mia_loss: 0.6151

============================================================
[14/75] npo_lr5e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.99it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.75it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.87it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.89it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.72it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.01it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.09it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.23it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.08s/it]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.07s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.14s/it]gen:  57%|█████▋    | 4/7 [00:06<00:05,  1.87s/it]gen:  71%|███████▏  | 5/7 [00:09<00:04,  2.27s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.86s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.47s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:03<00:18,  3.05s/it]jb_gen:  29%|██▊       | 2/7 [00:06<00:15,  3.15s/it]jb_gen:  43%|████▎     | 3/7 [00:07<00:09,  2.27s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.69s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:02,  1.42s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.30s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.13s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.80it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 95.5s
    uds: 0.6023
    em: 0.6787
    mia_loss: 0.6210

============================================================
[15/75] npo_lr5e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.99it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.76it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.88it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.95it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.13it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.08it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:07,  1.17s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.34s/it]gen:  43%|████▎     | 3/7 [00:05<00:06,  1.66s/it]gen:  57%|█████▋    | 4/7 [00:05<00:03,  1.32s/it]gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.19s/it]gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.19s/it]gen: 100%|██████████| 7/7 [00:08<00:00,  1.02s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.11it/s]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.26s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.64s/it]jb_gen:  57%|█████▋    | 4/7 [00:05<00:04,  1.35s/it]jb_gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.18s/it]jb_gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.19s/it]jb_gen: 100%|██████████| 7/7 [00:08<00:00,  1.05s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 90.8s
    uds: 0.6366
    em: 0.6891
    mia_loss: 0.6569

============================================================
[16/75] rmu_lr1e5_l5_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer5_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.13it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.87it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  2.00it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.09it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.09it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.58it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.24it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.09it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.14it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.03s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.00it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.04it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.04it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.17it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:07,  1.23s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.66s/it]jb_gen:  43%|████▎     | 3/7 [00:04<00:05,  1.41s/it]jb_gen:  57%|█████▋    | 4/7 [00:05<00:04,  1.35s/it]jb_gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.24s/it]jb_gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.15s/it]jb_gen: 100%|██████████| 7/7 [00:08<00:00,  1.02it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.7s
    uds: 0.0390
    em: 0.9678
    mia_loss: 0.9959

============================================================
[17/75] rmu_lr1e5_l10_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer10_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.14it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.86it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  2.00it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.09it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.09it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.58it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.24it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.98it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.09it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.91it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.14it/s]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.20s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.12s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.18s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.16s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.11s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.06it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.04s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.13s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.06s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.10s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.09s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.02s/it]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.14it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.2s
    uds: 0.0452
    em: 0.9696
    mia_loss: 0.9963

============================================================
[18/75] rmu_lr1e5_l15_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer15_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.14it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.87it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  2.00it/s]Mem eval:  57%|█████▋    | 4/7 [00:01<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.09it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.09it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.57it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.24it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.23it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.15it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.08it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.10it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.14s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.10s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.03s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.06s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.04s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.09it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.09s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.08s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.00s/it]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.06it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.06it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.20it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.1s
    uds: 0.0398
    em: 0.9660
    mia_loss: 0.9959

============================================================
[19/75] rmu_lr2e5_l5_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer5_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.10it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.85it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.98it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.00it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.07it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.06it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.54it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.98it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.02it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.01s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.01it/s]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.03s/it]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.03it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.01it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.13it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.14s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.11s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:03,  1.01it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.04it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.09it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.10it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.22it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.25it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.80it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 86.0s
    uds: 0.0702
    em: 0.9501
    mia_loss: 0.9948

============================================================
[20/75] rmu_lr2e5_l10_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer10_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.08it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.84it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.97it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.99it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.06it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.06it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.54it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.98it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.07it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.08it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.14it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.03s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.03it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.10it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.11it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.08it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.16it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.09it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.24s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.10s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.05s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.06it/s]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.02s/it]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.13it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.83it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 86.1s
    uds: 0.0778
    em: 0.9487
    mia_loss: 0.9944

============================================================
[21/75] rmu_lr2e5_l15_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer15_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.11it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.86it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.99it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.08it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.08it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.57it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.23it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.09it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.23it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.07it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.13s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.05s/it]gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.01it/s]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.03s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.01s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.12it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:07,  1.17s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.31s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.22s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.13s/it]jb_gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.31s/it]jb_gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.27s/it]jb_gen: 100%|██████████| 7/7 [00:08<00:00,  1.05s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 88.0s
    uds: 0.0433
    em: 0.9647
    mia_loss: 0.9957

============================================================
[22/75] rmu_lr5e5_l5_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer5_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.03it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.79it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.91it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.93it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.00it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.00it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.47it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.09it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.23it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.22it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.04s/it]gen:  43%|████▎     | 3/7 [00:02<00:04,  1.01s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.02it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.05it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.06it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.19it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.07s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.07s/it]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.07it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.09it/s]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.08s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.09s/it]jb_gen: 100%|██████████| 7/7 [00:07<00:00,  1.00it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.83it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.81it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.80it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 86.8s
    uds: 0.1858
    em: 0.8815
    mia_loss: 0.9852

============================================================
[23/75] rmu_lr5e5_l10_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer10_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.03it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.80it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.93it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.94it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.01it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.01it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.48it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.42s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.31s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.15s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.07s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.08s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.14s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.01it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.52s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.20s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.07it/s]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.00s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.02it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.16it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.4s
    uds: 0.1707
    em: 0.8959
    mia_loss: 0.9870

============================================================
[24/75] rmu_lr5e5_l15_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer15_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.09it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.84it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.97it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.99it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.07it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.06it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.55it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.98it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.92it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.92it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.09it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.91it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.45s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.25s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.17s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.07s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.06s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.03s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.10it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.03it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.04it/s]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.00it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.05it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.10it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.05it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.18it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.4s
    uds: 0.0596
    em: 0.9567
    mia_loss: 0.9949

============================================================
[25/75] rmu_lr1e5_l5_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer5_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.13it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.87it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.99it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.09it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.09it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.58it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.24it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.23it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.08it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.08it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.14it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.07s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.04it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.01it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.01it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.14it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.07it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.09s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.09s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.02it/s]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.01s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.01s/it]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.07it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.80it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.6s
    uds: 0.0429
    em: 0.9685
    mia_loss: 0.9962

============================================================
[26/75] rmu_lr1e5_l10_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer10_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.14it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.88it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:01,  2.01it/s]Mem eval:  57%|█████▋    | 4/7 [00:01<00:01,  2.02it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.10it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.58it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.25it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.13it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.08it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.15it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.05s/it]gen:  43%|████▎     | 3/7 [00:02<00:04,  1.00s/it]gen:  57%|█████▋    | 4/7 [00:03<00:03,  1.00s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.07s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.04s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.10it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.11it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.07s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.05s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.09s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.12s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.05s/it]jb_gen: 100%|██████████| 7/7 [00:07<00:00,  1.07it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.25it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.7s
    uds: 0.0463
    em: 0.9696
    mia_loss: 0.9963

============================================================
[27/75] rmu_lr1e5_l15_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer15_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.14it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.88it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:01,  2.01it/s]Mem eval:  57%|█████▋    | 4/7 [00:01<00:01,  2.02it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.10it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.58it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.25it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.09it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.07s/it]gen:  43%|████▎     | 3/7 [00:03<00:03,  1.00it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.04it/s]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.04s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.02s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.06it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.13s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.29s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:08,  2.09s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.64s/it]jb_gen:  71%|███████▏  | 5/7 [00:07<00:02,  1.38s/it]jb_gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.22s/it]jb_gen: 100%|██████████| 7/7 [00:08<00:00,  1.03s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 89.8s
    uds: 0.0364
    em: 0.9653
    mia_loss: 0.9959

============================================================
[28/75] rmu_lr2e5_l5_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer5_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.10it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.83it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.97it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.99it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.07it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.06it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.54it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.02it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.01s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.01it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.04it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.04it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.02it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.09it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.12s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.12s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:03,  1.01it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.10it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.14it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.12it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.24it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.76it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.80it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.0s
    uds: 0.0716
    em: 0.9477
    mia_loss: 0.9945

============================================================
[29/75] rmu_lr2e5_l10_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer10_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.09it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.84it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.97it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.99it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.06it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.05it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.53it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.20it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.74it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.85it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.94it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.81it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.94it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.11it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.03it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.09it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.05it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.08it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.15it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.10it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.93it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.07it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.09s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.01s/it]gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.01it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.04it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.03it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.15it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:07,  1.23s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.08s/it]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.10it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.10it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.15it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.04it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.12it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 86.9s
    uds: 0.0857
    em: 0.9397
    mia_loss: 0.9937

============================================================
[30/75] rmu_lr2e5_l15_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer15_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.12it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.86it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.99it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.09it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.08it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.56it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.23it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.83it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.01it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.07it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.12it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.11s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.04s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.06s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.07s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.07s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.08it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.22s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.17s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.11s/it]jb_gen:  71%|███████▏  | 5/7 [00:06<00:03,  1.54s/it]jb_gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.37s/it]jb_gen: 100%|██████████| 7/7 [00:08<00:00,  1.12s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 89.7s
    uds: 0.0466
    em: 0.9640
    mia_loss: 0.9956

============================================================
[31/75] rmu_lr5e5_l5_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer5_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.04it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.80it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.92it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.94it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.01it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.00it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.48it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.94it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.03it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.09it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.15it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.08it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.04s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.05it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.04it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.05it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.16it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.06it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.04s/it]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.09it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.09it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.10it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.13it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.15it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.83it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 86.7s
    uds: 0.1575
    em: 0.8904
    mia_loss: 0.9869

============================================================
[32/75] rmu_lr5e5_l10_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer10_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.06it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.82it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.94it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.96it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.03it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.03it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.50it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.08s/it]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.20s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.09s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.02s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.02s/it]gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.00it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.12it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.11s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.11s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.05s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.01it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.08it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.08it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.19it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.76it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.80it/s]100%|██████████| 7/7 [00:03<00:00,  2.19it/s]                                               Done in 87.3s
    uds: 0.1304
    em: 0.9188
    mia_loss: 0.9919

============================================================
[33/75] rmu_lr5e5_l15_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer15_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.10it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.85it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.98it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.07it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.07it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.55it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.22it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.74it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.85it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.94it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.03it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.10it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.48s/it]gen:  29%|██▊       | 2/7 [00:02<00:07,  1.48s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.21s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.08s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.10s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.10s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.06it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.14it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.10s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.03s/it]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.04it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.08it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.05it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.17it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.76it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 88.0s
    uds: 0.0562
    em: 0.9578
    mia_loss: 0.9949

============================================================
[34/75] simnpo_lr1e5_b35_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b3.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.11it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.86it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.99it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.00it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.08it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.08it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.57it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.23it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.88it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.85it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.30it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.01it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.02s/it]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.11s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.01s/it]gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.03it/s]gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.00it/s]gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.01it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.05it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.10it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.37s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.12s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.01s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.02s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.00it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.14it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.76it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.6s
    uds: 0.0390
    em: 0.9524
    mia_loss: 0.9948

============================================================
[35/75] simnpo_lr1e5_b35_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b3.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.09it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.84it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.97it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.99it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.07it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.06it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.55it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.74it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.94it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.11it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.03it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.09s/it]gen:  43%|████▎     | 3/7 [00:03<00:03,  1.00it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.10it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.06it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.01it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.11it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:07,  1.18s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.10s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.04s/it]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.06it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.11it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.08it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.22it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.83it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 86.9s
    uds: 0.0503
    em: 0.9436
    mia_loss: 0.9943

============================================================
[36/75] simnpo_lr1e5_b45_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b4.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.11it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.85it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.98it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.99it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.07it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.07it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.56it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.22it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.13it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.92it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.90it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.92it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.13it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.06s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.01it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.04it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.01it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.01it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.13it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.03it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.35s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.07s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.02it/s]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.00s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.00it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.15it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 88.2s
    uds: 0.0360
    em: 0.9522
    mia_loss: 0.9947

============================================================
[37/75] simnpo_lr1e5_b45_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b4.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.09it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.84it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.96it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.98it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.06it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.06it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.54it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.98it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.92it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]gen:  29%|██▊       | 2/7 [00:01<00:05,  1.00s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.04it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.13it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.05it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.03it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.12it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.10it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.05it/s]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.05it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.12it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.15it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.10it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.24it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 86.8s
    uds: 0.0491
    em: 0.9438
    mia_loss: 0.9944

============================================================
[38/75] simnpo_lr2e5_b35_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b3.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.04it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.80it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.94it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.96it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.02it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.01it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.49it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.03s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.28s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.14s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.05s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.12s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.15s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.01s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.08it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.05it/s]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.06it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.05it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.10it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:01,  1.01s/it]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.14it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 88.1s
    uds: 0.1139
    em: 0.9091
    mia_loss: 0.9890

============================================================
[39/75] simnpo_lr2e5_b35_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b3.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.03it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.80it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.93it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.95it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.02it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.00it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.47it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.16s/it]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.14s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.01s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.02s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.02s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.05s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.04it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.01it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.33s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.14s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.05s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.12s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.15s/it]jb_gen: 100%|██████████| 7/7 [00:07<00:00,  1.04it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 88.8s
    uds: 0.1510
    em: 0.8961
    mia_loss: 0.9856

============================================================
[40/75] simnpo_lr2e5_b45_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b4.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.04it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.80it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.93it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.95it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.03it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.02it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.49it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.72it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.83it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.01it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:07,  1.20s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.23s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.00s/it]gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.05it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.07it/s]gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.00it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.12it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:07,  1.31s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:07,  1.41s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.17s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.08s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.00s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.08s/it]jb_gen: 100%|██████████| 7/7 [00:07<00:00,  1.05it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 88.4s
    uds: 0.1168
    em: 0.9088
    mia_loss: 0.9887

============================================================
[41/75] simnpo_lr2e5_b45_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b4.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.03it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.80it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.93it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.94it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.01it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.00it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.47it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.01it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.08it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.08it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:07,  1.30s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.36s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.14s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.04s/it]gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.01it/s]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.03s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.06it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.13s/it]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.06it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.06it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.12it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.01it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.17it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.8s
    uds: 0.1548
    em: 0.8959
    mia_loss: 0.9854

============================================================
[42/75] simnpo_lr5e5_b35_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b3.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.91it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.11s/it]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.05s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.06it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.12it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.08it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.16it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.05it/s]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.09it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.17it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.11it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.02it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.12it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.83it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.80it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.1s
    uds: 0.4221
    em: 0.7659
    mia_loss: 0.9084

============================================================
[43/75] simnpo_lr5e5_b35_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b3.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.91it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.19it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.16s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.03s/it]gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.00it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.05it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.06it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.09it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.14s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.32s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.13s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.12s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.03s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.01it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.16it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.8s
    uds: 0.4982
    em: 0.7493
    mia_loss: 0.8729

============================================================
[44/75] simnpo_lr5e5_b45_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b4.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.91it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.14it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.07s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.02it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]gen:  71%|███████▏  | 5/7 [00:04<00:02,  1.02s/it]gen:  86%|████████▌ | 6/7 [00:05<00:01,  1.01s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.07it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.09s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.02s/it]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.09it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.19it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.17it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.11it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.19it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 86.9s
    uds: 0.4223
    em: 0.7680
    mia_loss: 0.9136

============================================================
[45/75] simnpo_lr5e5_b45_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b4.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.01it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.78it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.90it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.91it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.94it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.81it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.94it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.11it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.15it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.06it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.15s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.10s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.04s/it]gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.01it/s]gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.04it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.09it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.06it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.26s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.11s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.04it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.07it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.07it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.18it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.81it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.25it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.4s
    uds: 0.4801
    em: 0.7531
    mia_loss: 0.8807

============================================================
[46/75] simnpo_lr1e5_b35_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b3.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.10it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.85it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.98it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.99it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.07it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.07it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.55it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.87it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.01s/it]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.11s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.02it/s]gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.02it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.02it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.11it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.10it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.33s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.05s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.02it/s]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.00s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.00s/it]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.15it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.80it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.3s
    uds: 0.0439
    em: 0.9494
    mia_loss: 0.9946

============================================================
[47/75] simnpo_lr1e5_b35_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b3.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.09it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.84it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.96it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.98it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.06it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.05it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.54it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.20it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:07,  1.27s/it]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.17s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.06s/it]gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.04it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.07it/s]gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.03it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.11it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.05it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.04it/s]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.08it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.05it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.05it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.03it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.17it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.76it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.4s
    uds: 0.0545
    em: 0.9398
    mia_loss: 0.9941

============================================================
[48/75] simnpo_lr1e5_b45_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b4.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.10it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.85it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.98it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.00it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.07it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.07it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.56it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.22it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.01s/it]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.11s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.03it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.03it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.03it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.12it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.11s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.16s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:03,  1.04it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.13it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.08it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.06it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.20it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 86.9s
    uds: 0.0411
    em: 0.9486
    mia_loss: 0.9946

============================================================
[49/75] simnpo_lr1e5_b45_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b4.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.09it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.84it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.97it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.98it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.06it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.05it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.53it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.20it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.74it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.85it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:07,  1.18s/it]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.13s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.07it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.09it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.03it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.11it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.06it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.09s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:03,  1.01it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.03it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.09it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.05it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.19it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 86.8s
    uds: 0.0527
    em: 0.9408
    mia_loss: 0.9941

============================================================
[50/75] simnpo_lr2e5_b35_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b3.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.05it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.81it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.93it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.95it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.03it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.02it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.49it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.94it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.94it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.11it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.03it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.08it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.02s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.20s/it]gen:  43%|████▎     | 3/7 [00:03<00:03,  1.05it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.08it/s]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.04s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.10it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:07,  1.24s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.18s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.05s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.00it/s]jb_gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.07it/s]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.02s/it]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.15it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.3s
    uds: 0.1209
    em: 0.9057
    mia_loss: 0.9886

============================================================
[51/75] simnpo_lr2e5_b35_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b3.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.04it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.80it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.93it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.95it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.01it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.00it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.47it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.98it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.79it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.01s/it]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.02s/it]gen:  43%|████▎     | 3/7 [00:03<00:03,  1.00it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.06it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.05it/s]gen:  86%|████████▌ | 6/7 [00:05<00:01,  1.01s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.09it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.07it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.04s/it]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.12it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.19it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.20it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.05it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.22it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 86.7s
    uds: 0.1470
    em: 0.8957
    mia_loss: 0.9856

============================================================
[52/75] simnpo_lr2e5_b45_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b4.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.05it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.81it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.94it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.95it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.03it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.02it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.49it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.08it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.06s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.04it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.07it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.07it/s]gen:  86%|████████▌ | 6/7 [00:05<00:01,  1.02s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.11it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:08,  1.36s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.18s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.07s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.01s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.06it/s]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.04s/it]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.11it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.6s
    uds: 0.1283
    em: 0.9048
    mia_loss: 0.9884

============================================================
[53/75] simnpo_lr2e5_b45_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b4.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.04it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.80it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.93it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.95it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.02it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  2.01it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.48it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.13it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.03s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.05it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.09it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.05it/s]gen:  86%|████████▌ | 6/7 [00:05<00:01,  1.02s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.08it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.06it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.15s/it]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.05it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.06it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.10it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:01,  1.00s/it]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.16it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.3s
    uds: 0.1545
    em: 0.8952
    mia_loss: 0.9855

============================================================
[54/75] simnpo_lr5e5_b35_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b3.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.01it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.91it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.22it/s]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.20s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.03s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.03it/s]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.04s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.09it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.15it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.03it/s]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.10it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.16it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.13it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.10it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.18it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.5s
    uds: 0.4188
    em: 0.7711
    mia_loss: 0.9153

============================================================
[55/75] simnpo_lr5e5_b35_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b3.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.76it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.79it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.07it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.01s/it]gen:  29%|██▊       | 2/7 [00:02<00:07,  1.43s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.16s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.02s/it]gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.04it/s]gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.02it/s]gen: 100%|██████████| 7/7 [00:07<00:00,  1.07it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.01it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.30s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.11s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.01s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.05it/s]jb_gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.69s/it]jb_gen: 100%|██████████| 7/7 [00:08<00:00,  1.39s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 90.2s
    uds: 0.4962
    em: 0.7535
    mia_loss: 0.8805

============================================================
[56/75] simnpo_lr5e5_b45_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b4.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.11it/s]gen:  29%|██▊       | 2/7 [00:01<00:04,  1.03it/s]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.11it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.11it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.09it/s]gen:  86%|████████▌ | 6/7 [00:05<00:01,  1.02s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.10it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.03it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.04s/it]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.09it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.10it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.15it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.11it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.18it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.80it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.0s
    uds: 0.4129
    em: 0.7756
    mia_loss: 0.9193

============================================================
[57/75] simnpo_lr5e5_b45_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b4.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.91it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.98it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.97it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.08it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.05s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.24s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.10s/it]gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.03it/s]gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.05it/s]gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.05it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.10it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.12it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.24s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.08s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.01s/it]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.06it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.06it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.16it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.6s
    uds: 0.4852
    em: 0.7576
    mia_loss: 0.8848

============================================================
[58/75] undial_lr1e5_b10_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.13it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.88it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:01,  2.00it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.09it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.09it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.57it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.24it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.09s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.00s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.07it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.05it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.12it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.26s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.09s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.02s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.08it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.05it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.18it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.2s
    uds: 0.0461
    em: 0.9616
    mia_loss: 0.9960

============================================================
[59/75] undial_lr1e5_b10_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.13it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.87it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:01,  2.00it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.09it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.08it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.57it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.23it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.13it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.06s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.02it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.07it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.08it/s]gen:  86%|████████▌ | 6/7 [00:05<00:01,  1.03s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.06it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.04s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:07,  1.45s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.20s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.13s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.02s/it]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.01s/it]jb_gen: 100%|██████████| 7/7 [00:07<00:00,  1.12it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.9s
    uds: 0.0468
    em: 0.9626
    mia_loss: 0.9959

============================================================
[60/75] undial_lr1e5_b10_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.12it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.87it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  2.00it/s]Mem eval:  57%|█████▋    | 4/7 [00:01<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.09it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.09it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.58it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.24it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.01it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.98it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.92it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.79it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.92it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.07it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.03it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.23it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.08it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.05it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.08it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.87it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.91it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.11it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.07s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.01it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.07it/s]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.02s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.02s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.10it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.13s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:07,  1.54s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:05,  1.26s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.07s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.00it/s]jb_gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.03it/s]jb_gen: 100%|██████████| 7/7 [00:07<00:00,  1.12it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.9s
    uds: 0.0450
    em: 0.9659
    mia_loss: 0.9961

============================================================
[61/75] undial_lr1e4_b10_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.74it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.94it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.05it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.05s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.09it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.17it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.12it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.19it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.03it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.12s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.07s/it]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.05it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.14it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.10it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.21it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.2s
    uds: 0.4664
    em: 0.6286
    mia_loss: 0.8322

============================================================
[62/75] undial_lr1e4_b10_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.99it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.14s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.04s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.09it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.12it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.00it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.01it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.04it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.15s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.06s/it]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.09it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.03it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.20it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.80it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.6s
    uds: 0.4838
    em: 0.6632
    mia_loss: 0.8494

============================================================
[63/75] undial_lr1e4_b10_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.76it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.88it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.24it/s]gen:  29%|██▊       | 2/7 [00:01<00:04,  1.00it/s]gen:  43%|████▎     | 3/7 [00:02<00:04,  1.01s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.09it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.13it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.05it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.14it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.14it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.04s/it]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.01it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.14it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.16it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.07it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.20it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 86.7s
    uds: 0.4658
    em: 0.6914
    mia_loss: 0.8707

============================================================
[64/75] undial_lr3e4_b10_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.88it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.10it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:03<00:18,  3.01s/it]gen:  29%|██▊       | 2/7 [00:06<00:15,  3.10s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.05s/it]gen:  57%|█████▋    | 4/7 [00:09<00:07,  2.41s/it]gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.80s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.54s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.28s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.06s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.33s/it]jb_gen:  43%|████▎     | 3/7 [00:04<00:06,  1.56s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:06,  2.14s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.67s/it]jb_gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.47s/it]jb_gen: 100%|██████████| 7/7 [00:10<00:00,  1.17s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 96.9s
    uds: 0.7576
    em: 0.5319
    mia_loss: 0.8142

============================================================
[65/75] undial_lr3e4_b10_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.76it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.88it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.89it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.95it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.00it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.17it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.11s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.96s/it]gen:  57%|█████▋    | 4/7 [00:05<00:04,  1.46s/it]gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.21s/it]gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.07s/it]gen: 100%|██████████| 7/7 [00:08<00:00,  1.07it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:04,  1.29it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.13it/s]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.28it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.28it/s]jb_gen:  71%|███████▏  | 5/7 [00:03<00:01,  1.31it/s]jb_gen:  86%|████████▌ | 6/7 [00:04<00:00,  1.30it/s]jb_gen: 100%|██████████| 7/7 [00:05<00:00,  1.46it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.4s
    uds: 0.7529
    em: 0.5563
    mia_loss: 0.8107

============================================================
[66/75] undial_lr3e4_b10_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.95it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.72it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.01it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.92it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.03it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.09it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.10it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.22it/s]gen:  29%|██▊       | 2/7 [00:01<00:04,  1.05it/s]gen:  43%|████▎     | 3/7 [00:04<00:07,  1.87s/it]gen:  57%|█████▋    | 4/7 [00:07<00:06,  2.30s/it]gen:  71%|███████▏  | 5/7 [00:10<00:05,  2.55s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.73s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  2.13s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:04,  1.21it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.19it/s]jb_gen:  43%|████▎     | 3/7 [00:04<00:07,  1.85s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:06,  2.32s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:05,  2.58s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:02,  2.06s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.61s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 101.3s
    uds: 0.8171
    em: 0.5532
    mia_loss: 0.7528

============================================================
[67/75] undial_lr1e5_b10_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.12it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.86it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.99it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.00it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.08it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.08it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.56it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.22it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.74it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.98it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.14it/s]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.20s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.06s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.04it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.05it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.04it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.11it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.04s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.13s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.00s/it]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.06it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.05it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.18it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.3s
    uds: 0.0488
    em: 0.9570
    mia_loss: 0.9957

============================================================
[68/75] undial_lr1e5_b10_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.12it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.87it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  2.00it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.08it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.08it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.57it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.23it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.15it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.00it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.98it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  2.00it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.06it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.15it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.23it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.18it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.13it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.08it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.05it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.08it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.89it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.87it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.91it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.04it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.12it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.06s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.00s/it]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.01it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.05it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.03it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.10it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.03s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.28s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.11s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.04s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.03it/s]jb_gen:  86%|████████▌ | 6/7 [00:06<00:00,  1.03it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.16it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.5s
    uds: 0.0491
    em: 0.9594
    mia_loss: 0.9957

============================================================
[69/75] undial_lr1e5_b10_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.13it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.85it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.98it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  2.01it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:00,  2.08it/s]Mem eval:  86%|████████▌ | 6/7 [00:02<00:00,  2.09it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.57it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.23it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.98it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.14it/s]gen:  29%|██▊       | 2/7 [00:02<00:05,  1.03s/it]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.04it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.09it/s]gen:  71%|███████▏  | 5/7 [00:04<00:02,  1.01s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.13s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.03it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.12s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:07,  1.50s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.24s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.07s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.02it/s]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.04s/it]jb_gen: 100%|██████████| 7/7 [00:07<00:00,  1.08it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.20it/s]                                               Done in 87.9s
    uds: 0.0495
    em: 0.9649
    mia_loss: 0.9960

============================================================
[70/75] undial_lr1e4_b10_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.99it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.76it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.88it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.93it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.36it/s]gen:  29%|██▊       | 2/7 [00:01<00:04,  1.15it/s]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.19it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.18it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.08it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.11it/s]gen: 100%|██████████| 7/7 [00:05<00:00,  1.22it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:04,  1.26it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.06s/it]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.08it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.14it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.21it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.19it/s]jb_gen: 100%|██████████| 7/7 [00:05<00:00,  1.24it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.76it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 85.7s
    uds: 0.4435
    em: 0.6202
    mia_loss: 0.8407

============================================================
[71/75] undial_lr1e4_b10_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.98it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.85it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.16it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.02it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.94it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.03it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.09it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.16it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.10it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.21it/s]gen:  29%|██▊       | 2/7 [00:01<00:04,  1.13it/s]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.14it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.20it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.11it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.06it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.14it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.14it/s]jb_gen:  29%|██▊       | 2/7 [00:02<00:05,  1.09s/it]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.01it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.12it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.14it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.08it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.17it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.78it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 86.3s
    uds: 0.4663
    em: 0.6593
    mia_loss: 0.8671

============================================================
[72/75] undial_lr1e4_b10_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:02,  2.00it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.89it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.91it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.97it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.96it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.43it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.01it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.15it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.23it/s]gen:  29%|██▊       | 2/7 [00:01<00:04,  1.05it/s]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.03it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.06it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.03it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.09it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:04,  1.25it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.05it/s]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.01it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.09it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.15it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.11it/s]jb_gen: 100%|██████████| 7/7 [00:06<00:00,  1.22it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.74it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 86.4s
    uds: 0.4258
    em: 0.7018
    mia_loss: 0.8971

============================================================
[73/75] undial_lr3e4_b10_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.99it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.76it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.88it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.95it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  2.00it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.16it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.06s/it]gen:  29%|██▊       | 2/7 [00:02<00:04,  1.01it/s]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.10it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.13it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.18it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.15it/s]gen: 100%|██████████| 7/7 [00:05<00:00,  1.29it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:04,  1.25it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.15it/s]jb_gen:  43%|████▎     | 3/7 [00:04<00:07,  1.86s/it]jb_gen:  57%|█████▋    | 4/7 [00:05<00:04,  1.42s/it]jb_gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.20s/it]jb_gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.08s/it]jb_gen: 100%|██████████| 7/7 [00:07<00:00,  1.07it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.79it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 87.8s
    uds: 0.7095
    em: 0.5106
    mia_loss: 0.7848

============================================================
[74/75] undial_lr3e4_b10_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.99it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.76it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.88it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.95it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.42it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.91it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.32it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.16it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.84it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.91it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.93it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.10it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.02it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.08it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:06,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.24it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.14it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.06it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.12it/s]gen:  29%|██▊       | 2/7 [00:01<00:04,  1.02it/s]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.06it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.11it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.16it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.19it/s]gen: 100%|██████████| 7/7 [00:05<00:00,  1.29it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:05,  1.19it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:04,  1.18it/s]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.11it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.10it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.17it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.18it/s]jb_gen: 100%|██████████| 7/7 [00:05<00:00,  1.32it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.76it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.84it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.80it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.82it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.79it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 85.6s
    uds: 0.7035
    em: 0.5508
    mia_loss: 0.8050

============================================================
[75/75] undial_lr3e4_b10_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Finetuning on forget10 (subprocess)...
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.99it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.76it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.88it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.90it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.96it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.95it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.41it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:02,  1.73it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.84it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.90it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.31it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:14,  2.15it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:14,  1.99it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:01<00:13,  2.01it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:13,  2.01it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:02<00:13,  1.99it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:12,  1.93it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.80it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:12,  1.85it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:10,  1.94it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.99it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  2.11it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:08,  2.03it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  2.09it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:07,  2.02it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:08<00:07,  2.04it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:08<00:06,  2.07it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:09<00:05,  2.17it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:09<00:05,  2.25it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.19it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:10<00:04,  2.17it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.15it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:11<00:03,  2.09it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:12<00:03,  2.07it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:13<00:02,  2.01it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:13<00:02,  1.94it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:14<00:01,  1.90it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:14<00:01,  1.88it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:15<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.33it/s]Mem eval (multi): 100%|██████████| 32/32 [00:15<00:00,  2.05it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.03s/it]gen:  29%|██▊       | 2/7 [00:01<00:04,  1.01it/s]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.08it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.17it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.23it/s]gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.18it/s]gen: 100%|██████████| 7/7 [00:06<00:00,  1.17it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:00<00:04,  1.31it/s]jb_gen:  29%|██▊       | 2/7 [00:01<00:03,  1.26it/s]jb_gen:  43%|████▎     | 3/7 [00:02<00:03,  1.30it/s]jb_gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.08it/s]jb_gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.14it/s]jb_gen:  86%|████████▌ | 6/7 [00:05<00:00,  1.17it/s]jb_gen: 100%|██████████| 7/7 [00:05<00:00,  1.24it/s]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.86it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.75it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.76it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.82it/s]100%|██████████| 7/7 [00:03<00:00,  2.26it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.85it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.80it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.83it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.80it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]100%|██████████| 7/7 [00:03<00:00,  2.21it/s]                                               Done in 85.8s
    uds: 0.7426
    em: 0.5779
    mia_loss: 0.7824

============================================================
Done! Results saved to runs/meta_eval/robustness/relearn/results.json
============================================================
