======================================================================
Robustness Meta-Evaluation: RELEARN
======================================================================
GPU: 1
Models: 151 (1 retain + 150 unlearn)
Metrics: em, es, prob, paraprob, truth_ratio, rouge, para_rouge, jailbreak_rouge, mia_loss, mia_zlib, mia_min_k, mia_min_kpp, uds
Output: runs/meta_eval/robustness/relearn
Clear cache: False

Loading tokenizer and full model...
UDS data: 367 valid examples
Loading S1 cache from runs/meta_eval/s1_cache_sdpa.json...
Resumed from runs/meta_eval/robustness/relearn/results.json: 29 entries
Processing models [0:76] (76 models)

============================================================
[1/76] retain
  open-unlearning/tofu_Llama-3.2-1B-Instruct_retain90
============================================================
  Already computed, skipping

============================================================
[2/76] altpo_lr1e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[3/76] altpo_lr1e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[4/76] altpo_lr1e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[5/76] altpo_lr2e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[6/76] altpo_lr2e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[7/76] altpo_lr2e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[8/76] altpo_lr5e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[9/76] altpo_lr5e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[10/76] altpo_lr5e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[11/76] altpo_lr1e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[12/76] altpo_lr1e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[13/76] altpo_lr1e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[14/76] altpo_lr2e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[15/76] altpo_lr2e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[16/76] altpo_lr2e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[17/76] altpo_lr5e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[18/76] altpo_lr5e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[19/76] altpo_lr5e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[20/76] graddiff_lr1e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[21/76] graddiff_lr1e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[22/76] graddiff_lr1e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[23/76] graddiff_lr2e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[24/76] graddiff_lr2e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[25/76] graddiff_lr2e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[26/76] graddiff_lr5e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[27/76] graddiff_lr5e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha2_epoch5
============================================================
  Already computed, skipping
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.

============================================================
[28/76] graddiff_lr5e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[29/76] graddiff_lr1e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha1_epoch10
============================================================
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:15,  1.38s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.13it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.36it/s] 33%|███▎      | 4/12 [00:03<00:05,  1.48it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.57it/s] 50%|█████     | 6/12 [00:04<00:03,  1.62it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.72it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.72it/s] 92%|█████████▏| 11/12 [00:07<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.75it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.58it/s]
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
{'loss': 0.7298, 'grad_norm': 9.375, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.6077, 'train_samples_per_second': 52.579, 'train_steps_per_second': 1.577, 'train_loss': 0.6714997589588165, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.30it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.22it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:04,  2.29it/s]Mem eval:  31%|███       | 4/13 [00:01<00:03,  2.54it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  2.78it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.98it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.03it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.23it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.32it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.33it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.29it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.24it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.61it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.15it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.09it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.00it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.90it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.92it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.96it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.15it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.16it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.09it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.01it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.37it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.09it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.48it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.39it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.37it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.45it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.33it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.18it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.27it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.24it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.23it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.23it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.16it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.22it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.26it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.13it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.94it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.87it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.96it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.99it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.05it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.25it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.37it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.29it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.36it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.41it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.38it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.26it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.27it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.45it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.42it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.48it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.52it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.56it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.57it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.62it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.48it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.44it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.40it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.37it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.34it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.25it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.23it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.31it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.20it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.10it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.10it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.03it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.06it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.11it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.13it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.46it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.27it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:08,  1.39it/s]gen:  15%|█▌        | 2/13 [00:02<00:11,  1.09s/it]gen:  23%|██▎       | 3/13 [00:02<00:10,  1.01s/it]gen:  31%|███       | 4/13 [00:03<00:08,  1.06it/s]gen:  38%|███▊      | 5/13 [00:04<00:06,  1.15it/s]gen:  46%|████▌     | 6/13 [00:05<00:05,  1.20it/s]gen:  54%|█████▍    | 7/13 [00:06<00:04,  1.23it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.33it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.22it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.13it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.07it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.08it/s]gen: 100%|██████████| 13/13 [00:11<00:00,  1.14it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.25it/s]jb_gen:  15%|█▌        | 2/13 [00:02<00:12,  1.11s/it]jb_gen:  23%|██▎       | 3/13 [00:02<00:09,  1.01it/s]jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.15it/s]jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.28it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.36it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.36it/s]jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.34it/s]jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.22it/s]jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.27it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.32it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.23it/s]jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.33it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.08it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.98it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s] 31%|███       | 4/13 [00:01<00:03,  2.76it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.85it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.94it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.90it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.04it/s] 69%|██████▉   | 9/13 [00:03<00:01,  3.10it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.09it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.03it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.98it/s]100%|██████████| 13/13 [00:04<00:00,  3.33it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.05it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.97it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.91it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.02it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]100%|██████████| 13/13 [00:04<00:00,  3.25it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 94.8s
    uds: 0.0610
    em: 0.9334
    mia_loss: 0.9926

============================================================
[30/76] graddiff_lr1e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha2_epoch10
============================================================
  [Cache] Loaded 151 models from runs/method_eval/metrics_before.json
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.24s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.21it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.41it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.51it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.64it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.69it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.60it/s]
{'loss': 0.5164, 'grad_norm': 9.625, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5121, 'train_samples_per_second': 53.247, 'train_steps_per_second': 1.597, 'train_loss': 0.4893031617005666, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.41it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.26it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  2.99it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.00it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.12it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.23it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.19it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.35it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.42it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.40it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.34it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.28it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.65it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.34it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.09it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.00it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.85it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.91it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.93it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.97it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.10it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.14it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.16it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.08it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.02it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.36it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.09it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.47it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.36it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.43it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.30it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.15it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.25it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.23it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.22it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.21it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.15it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.21it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.24it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.13it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.93it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.87it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.95it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.99it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.05it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.25it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.23it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.20it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.26it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.27it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.38it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.47it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.36it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.41it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.38it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.26it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.27it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.45it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.42it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.47it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.53it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.58it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.61it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.65it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.51it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.46it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.41it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.38it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.35it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.25it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.23it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.30it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.19it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.09it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.10it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.03it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.06it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.11it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.12it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.45it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.27it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:08,  1.41it/s]gen:  15%|█▌        | 2/13 [00:01<00:10,  1.08it/s]gen:  23%|██▎       | 3/13 [00:02<00:09,  1.08it/s]gen:  31%|███       | 4/13 [00:03<00:08,  1.10it/s]gen:  38%|███▊      | 5/13 [00:04<00:07,  1.11it/s]gen:  46%|████▌     | 6/13 [00:05<00:05,  1.24it/s]gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.24it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.35it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.26it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.21it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.11it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.11it/s]gen: 100%|██████████| 13/13 [00:11<00:00,  1.16it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:08,  1.38it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:10,  1.09it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.14it/s]jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.21it/s]jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.30it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.30it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.24it/s]jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.36it/s]jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.31it/s]jb_gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.35it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.33it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.26it/s]jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.36it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.05it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.96it/s] 23%|██▎       | 3/13 [00:01<00:04,  2.03it/s] 31%|███       | 4/13 [00:01<00:03,  2.28it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.50it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.68it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.73it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.91it/s] 69%|██████▉   | 9/13 [00:03<00:01,  3.00it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.02it/s] 85%|████████▍ | 11/13 [00:03<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.30it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.02it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]100%|██████████| 13/13 [00:04<00:00,  3.26it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 94.9s
    uds: 0.0588
    em: 0.9400
    mia_loss: 0.9933

============================================================
[31/76] graddiff_lr1e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.21s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.23it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.42it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.52it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.60it/s] 50%|█████     | 6/12 [00:04<00:03,  1.64it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.69it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.60it/s]
{'loss': 0.323, 'grad_norm': 9.4375, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.4915, 'train_samples_per_second': 53.394, 'train_steps_per_second': 1.602, 'train_loss': 0.3216981341441472, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.43it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.28it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.54it/s]Mem eval:  31%|███       | 4/13 [00:01<00:04,  1.91it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.26it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.56it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:02,  2.72it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  2.99it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.16it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.23it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.23it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.22it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.60it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.85it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.08it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.00it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.90it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.93it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.96it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.09it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.13it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.15it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.08it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.01it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.36it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.09it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.45it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.37it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.36it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.44it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.16it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.26it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.23it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.21it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.22it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.15it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.21it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.24it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.12it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.95it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.25it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.37it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.29it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.36it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.41it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.38it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.26it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.27it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.45it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.41it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.47it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.52it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.58it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.60it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.64it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.50it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.45it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.40it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.37it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.34it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.22it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.31it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.20it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.10it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.10it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.03it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.05it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.10it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.12it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.45it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.27it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:08,  1.41it/s]gen:  15%|█▌        | 2/13 [00:01<00:08,  1.29it/s]gen:  23%|██▎       | 3/13 [00:02<00:08,  1.15it/s]gen:  31%|███       | 4/13 [00:03<00:07,  1.16it/s]gen:  38%|███▊      | 5/13 [00:04<00:06,  1.17it/s]gen:  46%|████▌     | 6/13 [00:04<00:05,  1.23it/s]gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.21it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.32it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.24it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.19it/s]gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.24it/s]gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.15it/s]gen: 100%|██████████| 13/13 [00:10<00:00,  1.21it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:08,  1.48it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.30it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.14it/s]jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.21it/s]jb_gen:  38%|███▊      | 5/13 [00:03<00:06,  1.33it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.36it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.34it/s]jb_gen:  62%|██████▏   | 8/13 [00:05<00:03,  1.44it/s]jb_gen:  69%|██████▉   | 9/13 [00:06<00:03,  1.30it/s]jb_gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.33it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.37it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.28it/s]jb_gen: 100%|██████████| 13/13 [00:09<00:00,  1.35it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.08it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.98it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.93it/s] 31%|███       | 4/13 [00:01<00:04,  2.20it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.44it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.63it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.88it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.98it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.01it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.30it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.90it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.02it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]100%|██████████| 13/13 [00:04<00:00,  3.25it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 93.8s
    uds: 0.0391
    em: 0.9506
    mia_loss: 0.9951

============================================================
[32/76] graddiff_lr2e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.24s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.21it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.41it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.51it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.60it/s]
{'loss': 8.3188, 'grad_norm': 10.0625, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5138, 'train_samples_per_second': 53.236, 'train_steps_per_second': 1.597, 'train_loss': 7.051736970742543, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.29it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.17it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.51it/s]Mem eval:  31%|███       | 4/13 [00:02<00:04,  1.87it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.21it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.50it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:02,  2.66it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  2.92it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.07it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.12it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.12it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.10it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.47it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.77it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.09it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.90it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.93it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.96it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.09it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.13it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.15it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.08it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.01it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.35it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.08it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.46it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.35it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.44it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.16it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.26it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.22it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.21it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.21it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.15it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.20it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.24it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.12it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.95it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.99it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.25it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.37it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.29it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.36it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.41it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.38it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.26it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.27it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.45it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.41it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.47it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.53it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.59it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.61it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.66it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.51it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.46it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.41it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.38it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.35it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.28it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.25it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.23it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.30it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.19it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.08it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.09it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.02it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.05it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.10it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.12it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.45it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.27it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:08,  1.46it/s]gen:  15%|█▌        | 2/13 [00:01<00:10,  1.03it/s]gen:  23%|██▎       | 3/13 [00:02<00:09,  1.07it/s]gen:  31%|███       | 4/13 [00:03<00:08,  1.10it/s]gen:  38%|███▊      | 5/13 [00:04<00:06,  1.22it/s]gen:  46%|████▌     | 6/13 [00:05<00:05,  1.21it/s]gen:  54%|█████▍    | 7/13 [00:05<00:05,  1.20it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.26it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.33it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.30it/s]gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.29it/s]gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.27it/s]gen: 100%|██████████| 13/13 [00:10<00:00,  1.29it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:07,  1.55it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:09,  1.15it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.11it/s]jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.13it/s]jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.24it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.23it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:05,  1.15it/s]jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.26it/s]jb_gen:  69%|██████▉   | 9/13 [00:07<00:02,  1.34it/s]jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.32it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.30it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.28it/s]jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.35it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.08it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.97it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.94it/s] 31%|███       | 4/13 [00:01<00:04,  2.21it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.45it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.65it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.70it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.89it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.98it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.01it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.98it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.30it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.91it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.99it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.02it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]100%|██████████| 13/13 [00:04<00:00,  3.26it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 94.3s
    uds: 0.2644
    em: 0.8422
    mia_loss: 0.9633

============================================================
[33/76] graddiff_lr2e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.24s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.21it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.42it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.51it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.60it/s] 50%|█████     | 6/12 [00:04<00:03,  1.64it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.69it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.60it/s]
{'loss': 19.0042, 'grad_norm': 12.8125, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.4948, 'train_samples_per_second': 53.37, 'train_steps_per_second': 1.601, 'train_loss': 15.967574258645376, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.27it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.17it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.51it/s]Mem eval:  31%|███       | 4/13 [00:02<00:04,  1.88it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.22it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.50it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:02,  2.66it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  2.91it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.06it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.11it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.11it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.09it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.46it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.76it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.09it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.00it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.90it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.92it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.96it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.09it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.13it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.15it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.07it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.35it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.08it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.45it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.36it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.43it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.31it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.16it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.26it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.22it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.21it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.22it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.15it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.21it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.24it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.12it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.94it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.24it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.37it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.29it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.35it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.40it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.37it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.25it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.26it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.44it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.41it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.46it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.51it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.57it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.60it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.64it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.50it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.45it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.40it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.36it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.34it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.22it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.20it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.30it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.30it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.19it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.08it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.09it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.17it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.07it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.02it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.05it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.10it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.12it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.45it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.26it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:10,  1.17it/s]gen:  15%|█▌        | 2/13 [00:01<00:10,  1.08it/s]gen:  23%|██▎       | 3/13 [00:02<00:10,  1.01s/it]gen:  31%|███       | 4/13 [00:03<00:08,  1.11it/s]gen:  38%|███▊      | 5/13 [00:04<00:07,  1.11it/s]gen:  46%|████▌     | 6/13 [00:05<00:06,  1.12it/s]gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.06it/s]gen:  62%|██████▏   | 8/13 [00:07<00:04,  1.14it/s]gen:  69%|██████▉   | 9/13 [00:08<00:03,  1.13it/s]gen:  77%|███████▋  | 10/13 [00:09<00:02,  1.06it/s]gen:  85%|████████▍ | 11/13 [00:10<00:01,  1.01it/s]gen:  92%|█████████▏| 12/13 [00:11<00:01,  1.06s/it]gen: 100%|██████████| 13/13 [00:12<00:00,  1.03s/it]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:11,  1.07it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:10,  1.03it/s]jb_gen:  23%|██▎       | 3/13 [00:03<00:10,  1.08s/it]jb_gen:  31%|███       | 4/13 [00:04<00:08,  1.00it/s]jb_gen:  38%|███▊      | 5/13 [00:04<00:07,  1.08it/s]jb_gen:  46%|████▌     | 6/13 [00:05<00:06,  1.16it/s]jb_gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.10it/s]jb_gen:  62%|██████▏   | 8/13 [00:07<00:04,  1.22it/s]jb_gen:  69%|██████▉   | 9/13 [00:08<00:03,  1.15it/s]jb_gen:  77%|███████▋  | 10/13 [00:09<00:02,  1.07it/s]jb_gen:  85%|████████▍ | 11/13 [00:10<00:01,  1.04it/s]jb_gen:  92%|█████████▏| 12/13 [00:11<00:00,  1.00it/s]jb_gen: 100%|██████████| 13/13 [00:12<00:00,  1.08it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.07it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.97it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.93it/s] 31%|███       | 4/13 [00:01<00:04,  2.19it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.43it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.63it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.88it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.97it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.00it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.29it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.85it/s] 31%|███       | 4/13 [00:01<00:03,  2.84it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.89it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.98it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.89it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.96it/s] 85%|████████▍ | 11/13 [00:03<00:00,  2.99it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.99it/s]100%|██████████| 13/13 [00:04<00:00,  3.24it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 98.1s
    uds: 0.3261
    em: 0.8206
    mia_loss: 0.9546

============================================================
[34/76] graddiff_lr2e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.22s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.22it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.42it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.51it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.60it/s] 50%|█████     | 6/12 [00:04<00:03,  1.64it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.69it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.60it/s]
{'loss': 15.6601, 'grad_norm': 11.0625, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.4956, 'train_samples_per_second': 53.364, 'train_steps_per_second': 1.601, 'train_loss': 13.151782224575678, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.28it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.17it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.44it/s]Mem eval:  31%|███       | 4/13 [00:02<00:04,  1.81it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.16it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.46it/s]Mem eval:  54%|█████▍    | 7/13 [00:03<00:02,  2.62it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  2.88it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.04it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.10it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.11it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.09it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.46it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.73it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.07it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.98it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.89it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.92it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.95it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.09it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.13it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.14it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.06it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  2.99it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.34it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.07it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.45it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.37it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.35it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.43it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.31it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.15it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.25it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.22it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.20it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.20it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.14it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.20it/s]Mem eval (multi):  21%|██        | 13/63 [00:04<00:15,  3.23it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.11it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.94it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.25it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.37it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.45it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.29it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.36it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.41it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.38it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.26it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.27it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.45it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.42it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.47it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.52it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.58it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.60it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.64it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.50it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.45it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.40it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.37it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.34it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.23it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.30it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.18it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.08it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.09it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.17it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.07it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.02it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.04it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.09it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.11it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.44it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.26it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:09,  1.28it/s]gen:  15%|█▌        | 2/13 [00:01<00:08,  1.30it/s]gen:  23%|██▎       | 3/13 [00:02<00:09,  1.07it/s]gen:  31%|███       | 4/13 [00:03<00:08,  1.10it/s]gen:  38%|███▊      | 5/13 [00:04<00:07,  1.00it/s]gen:  46%|████▌     | 6/13 [00:05<00:06,  1.15it/s]gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.11it/s]gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.19it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.24it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.21it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.23it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.12it/s]gen: 100%|██████████| 13/13 [00:11<00:00,  1.21it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:10,  1.13it/s]jb_gen:  15%|█▌        | 2/13 [00:02<00:12,  1.11s/it]jb_gen:  23%|██▎       | 3/13 [00:03<00:12,  1.28s/it]jb_gen:  31%|███       | 4/13 [00:04<00:10,  1.13s/it]jb_gen:  38%|███▊      | 5/13 [00:05<00:07,  1.00it/s]jb_gen:  46%|████▌     | 6/13 [00:05<00:06,  1.12it/s]jb_gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.15it/s]jb_gen:  62%|██████▏   | 8/13 [00:07<00:04,  1.24it/s]jb_gen:  69%|██████▉   | 9/13 [00:08<00:03,  1.16it/s]jb_gen:  77%|███████▋  | 10/13 [00:09<00:02,  1.14it/s]jb_gen:  85%|████████▍ | 11/13 [00:10<00:01,  1.17it/s]jb_gen:  92%|█████████▏| 12/13 [00:11<00:00,  1.08it/s]jb_gen: 100%|██████████| 13/13 [00:11<00:00,  1.16it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.07it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.96it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.91it/s] 31%|███       | 4/13 [00:01<00:04,  2.18it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.43it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.63it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.88it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.97it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.00it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.93it/s]100%|██████████| 13/13 [00:04<00:00,  3.29it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.85it/s] 31%|███       | 4/13 [00:01<00:03,  2.84it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.89it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.98it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.95it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.89it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.97it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.00it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]100%|██████████| 13/13 [00:04<00:00,  3.25it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 96.7s
    uds: 0.2452
    em: 0.8578
    mia_loss: 0.9739

============================================================
[35/76] graddiff_lr5e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.25s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.21it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.41it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.51it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.60it/s] 50%|█████     | 6/12 [00:04<00:03,  1.64it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.69it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.60it/s]
{'loss': 82.9873, 'grad_norm': 218.0, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5066, 'train_samples_per_second': 53.286, 'train_steps_per_second': 1.599, 'train_loss': 80.0508804321289, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.23it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.12it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.50it/s]Mem eval:  31%|███       | 4/13 [00:02<00:04,  1.86it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.19it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.48it/s]Mem eval:  54%|█████▍    | 7/13 [00:03<00:02,  2.62it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  2.87it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.01it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.07it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.07it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.05it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.41it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.73it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.07it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.89it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.91it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.95it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.08it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:03<00:01,  3.12it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.14it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.06it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  2.99it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.34it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.07it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.46it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.36it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.43it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.31it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.16it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.25it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.22it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.20it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.21it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.15it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.20it/s]Mem eval (multi):  21%|██        | 13/63 [00:04<00:15,  3.23it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.11it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.94it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.25it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.24it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.36it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.29it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.36it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.41it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.38it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.26it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.27it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.45it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.41it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.46it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.52it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.57it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.60it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.64it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.50it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.44it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.40it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.37it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.33it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.22it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.20it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.30it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.30it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.29it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.19it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.08it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.09it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.17it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.07it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.02it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.05it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.10it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.12it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.44it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.26it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:02<00:30,  2.52s/it]gen:  15%|█▌        | 2/13 [00:05<00:27,  2.51s/it]gen:  23%|██▎       | 3/13 [00:07<00:25,  2.52s/it]gen:  31%|███       | 4/13 [00:10<00:22,  2.53s/it]gen:  38%|███▊      | 5/13 [00:12<00:20,  2.53s/it]gen:  46%|████▌     | 6/13 [00:15<00:17,  2.53s/it]gen:  54%|█████▍    | 7/13 [00:17<00:15,  2.52s/it]gen:  62%|██████▏   | 8/13 [00:20<00:12,  2.53s/it]gen:  69%|██████▉   | 9/13 [00:22<00:10,  2.53s/it]gen:  77%|███████▋  | 10/13 [00:23<00:05,  1.95s/it]gen:  85%|████████▍ | 11/13 [00:25<00:04,  2.14s/it]gen:  92%|█████████▏| 12/13 [00:28<00:02,  2.26s/it]gen: 100%|██████████| 13/13 [00:31<00:00,  2.34s/it]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:02<00:30,  2.55s/it]jb_gen:  15%|█▌        | 2/13 [00:05<00:27,  2.54s/it]jb_gen:  23%|██▎       | 3/13 [00:07<00:25,  2.56s/it]jb_gen:  31%|███       | 4/13 [00:10<00:22,  2.55s/it]jb_gen:  38%|███▊      | 5/13 [00:12<00:20,  2.55s/it]jb_gen:  46%|████▌     | 6/13 [00:15<00:17,  2.54s/it]jb_gen:  54%|█████▍    | 7/13 [00:17<00:15,  2.54s/it]jb_gen:  62%|██████▏   | 8/13 [00:20<00:12,  2.54s/it]jb_gen:  69%|██████▉   | 9/13 [00:22<00:10,  2.54s/it]jb_gen:  77%|███████▋  | 10/13 [00:23<00:05,  2.00s/it]jb_gen:  85%|████████▍ | 11/13 [00:26<00:04,  2.17s/it]jb_gen:  92%|█████████▏| 12/13 [00:28<00:02,  2.28s/it]jb_gen: 100%|██████████| 13/13 [00:31<00:00,  2.35s/it]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.03it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.95it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.93it/s] 31%|███       | 4/13 [00:01<00:04,  2.20it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.44it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.63it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.88it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.98it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.01it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.29it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.90it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.84it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.89it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.95it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.89it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.97it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.01it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]100%|██████████| 13/13 [00:04<00:00,  3.25it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 140.3s
    uds: 0.8983
    em: 0.1586
    mia_loss: 0.1228

============================================================
[36/76] graddiff_lr5e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:17,  1.61s/it] 17%|█▋        | 2/12 [00:02<00:09,  1.02it/s] 25%|██▌       | 3/12 [00:02<00:07,  1.27it/s] 33%|███▎      | 4/12 [00:03<00:05,  1.41it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.52it/s] 50%|█████     | 6/12 [00:04<00:03,  1.58it/s] 58%|█████▊    | 7/12 [00:05<00:03,  1.65it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.66it/s] 75%|███████▌  | 9/12 [00:06<00:01,  1.68it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.70it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.70it/s] 92%|█████████▏| 11/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.52it/s]
{'loss': 57.5939, 'grad_norm': 466.0, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.8702, 'train_samples_per_second': 50.825, 'train_steps_per_second': 1.525, 'train_loss': 49.84703222910563, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.22it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.11it/s]Mem eval:  23%|██▎       | 3/13 [00:02<00:12,  1.21s/it]Mem eval:  31%|███       | 4/13 [00:03<00:07,  1.16it/s]Mem eval:  38%|███▊      | 5/13 [00:03<00:05,  1.50it/s]Mem eval:  46%|████▌     | 6/13 [00:03<00:03,  1.84it/s]Mem eval:  54%|█████▍    | 7/13 [00:04<00:02,  2.11it/s]Mem eval:  62%|██████▏   | 8/13 [00:04<00:02,  2.43it/s]Mem eval:  69%|██████▉   | 9/13 [00:04<00:01,  2.66it/s]Mem eval:  77%|███████▋  | 10/13 [00:05<00:01,  2.81it/s]Mem eval:  85%|████████▍ | 11/13 [00:05<00:00,  2.88it/s]Mem eval:  92%|█████████▏| 12/13 [00:05<00:00,  2.92it/s]Mem eval: 100%|██████████| 13/13 [00:05<00:00,  3.30it/s]Mem eval: 100%|██████████| 13/13 [00:05<00:00,  2.19it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.08it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.98it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.82it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.82it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.88it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.91it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.94it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.08it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:03<00:01,  3.12it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.13it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.05it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  2.99it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.34it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.07it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.46it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.37it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.35it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.42it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.30it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.15it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.25it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.22it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.21it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.20it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.14it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.20it/s]Mem eval (multi):  21%|██        | 13/63 [00:04<00:15,  3.23it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.11it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.85it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.93it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.97it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.03it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.23it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.21it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.18it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.23it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.25it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.36it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.44it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.28it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.35it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.40it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.37it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.25it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.26it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.34it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.43it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.40it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.45it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.51it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.56it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.58it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.63it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.48it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.42it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.38it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.35it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:14<00:05,  3.32it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.25it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.22it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.21it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.20it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.30it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.30it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.28it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.17it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.06it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.07it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.15it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.06it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.01it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.04it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.09it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.11it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.43it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.25it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:02<00:30,  2.53s/it]gen:  15%|█▌        | 2/13 [00:05<00:27,  2.52s/it]gen:  23%|██▎       | 3/13 [00:07<00:25,  2.54s/it]gen:  31%|███       | 4/13 [00:10<00:22,  2.53s/it]gen:  38%|███▊      | 5/13 [00:12<00:20,  2.52s/it]gen:  46%|████▌     | 6/13 [00:15<00:17,  2.51s/it]gen:  54%|█████▍    | 7/13 [00:17<00:15,  2.51s/it]gen:  62%|██████▏   | 8/13 [00:20<00:12,  2.50s/it]gen:  69%|██████▉   | 9/13 [00:22<00:10,  2.51s/it]gen:  77%|███████▋  | 10/13 [00:25<00:07,  2.50s/it]gen:  85%|████████▍ | 11/13 [00:27<00:05,  2.51s/it]gen:  92%|█████████▏| 12/13 [00:30<00:02,  2.51s/it]gen: 100%|██████████| 13/13 [00:32<00:00,  2.50s/it]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:02<00:30,  2.54s/it]jb_gen:  15%|█▌        | 2/13 [00:05<00:27,  2.54s/it]jb_gen:  23%|██▎       | 3/13 [00:07<00:25,  2.56s/it]jb_gen:  31%|███       | 4/13 [00:10<00:22,  2.54s/it]jb_gen:  38%|███▊      | 5/13 [00:12<00:20,  2.55s/it]jb_gen:  46%|████▌     | 6/13 [00:15<00:17,  2.55s/it]jb_gen:  54%|█████▍    | 7/13 [00:17<00:15,  2.55s/it]jb_gen:  62%|██████▏   | 8/13 [00:20<00:12,  2.55s/it]jb_gen:  69%|██████▉   | 9/13 [00:22<00:10,  2.55s/it]jb_gen:  77%|███████▋  | 10/13 [00:25<00:07,  2.55s/it]jb_gen:  85%|████████▍ | 11/13 [00:28<00:05,  2.56s/it]jb_gen:  92%|█████████▏| 12/13 [00:30<00:02,  2.56s/it]jb_gen: 100%|██████████| 13/13 [00:33<00:00,  2.55s/it]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.06it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.96it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.92it/s] 31%|███       | 4/13 [00:01<00:04,  2.19it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.43it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.63it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.87it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.97it/s] 77%|███████▋  | 10/13 [00:03<00:01,  3.00it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.96it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.93it/s]100%|██████████| 13/13 [00:04<00:00,  3.29it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.89it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.88it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.85it/s] 31%|███       | 4/13 [00:01<00:03,  2.83it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.88it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.97it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.02it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.95it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.89it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.97it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.00it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]100%|██████████| 13/13 [00:04<00:00,  3.24it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 142.1s
    uds: 0.9676
    em: 0.0199
    mia_loss: 0.0527

============================================================
[37/76] graddiff_lr5e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.25s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.21it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.41it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.51it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.64it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.69it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.60it/s]
{'loss': 82.7203, 'grad_norm': 1008.0, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5105, 'train_samples_per_second': 53.259, 'train_steps_per_second': 1.598, 'train_loss': 78.07708549499512, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.20it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.11it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.50it/s]Mem eval:  31%|███       | 4/13 [00:02<00:04,  1.86it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.19it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.47it/s]Mem eval:  54%|█████▍    | 7/13 [00:03<00:02,  2.63it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  2.87it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.01it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.06it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.06it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.05it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.42it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.73it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.08it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.82it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.82it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.88it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.90it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.94it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.07it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:03<00:01,  3.11it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.12it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.04it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  2.98it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.33it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.06it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.45it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.37it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.34it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.42it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.29it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.13it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.23it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.20it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.19it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.20it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.14it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.19it/s]Mem eval (multi):  21%|██        | 13/63 [00:04<00:15,  3.22it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.10it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.94it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.25it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.36it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.45it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.29it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.36it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.39it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.36it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.24it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.26it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.32it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.42it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.40it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.45it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.50it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.55it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.58it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.63it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.48it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.43it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.39it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.35it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:14<00:05,  3.33it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.25it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.22it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.20it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.19it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.29it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.30it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.29it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.18it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.07it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.07it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.15it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.05it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.00it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.03it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.08it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.10it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.43it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.25it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:02<00:31,  2.63s/it]gen:  15%|█▌        | 2/13 [00:05<00:28,  2.58s/it]gen:  23%|██▎       | 3/13 [00:07<00:25,  2.59s/it]gen:  31%|███       | 4/13 [00:10<00:23,  2.57s/it]gen:  38%|███▊      | 5/13 [00:12<00:20,  2.56s/it]gen:  46%|████▌     | 6/13 [00:15<00:17,  2.55s/it]gen:  54%|█████▍    | 7/13 [00:17<00:15,  2.54s/it]======================================================================
Robustness Meta-Evaluation: RELEARN
======================================================================
GPU: 1
Models: 151 (1 retain + 150 unlearn)
Metrics: em, es, prob, paraprob, truth_ratio, rouge, para_rouge, jailbreak_rouge, mia_loss, mia_zlib, mia_min_k, mia_min_kpp, uds
Output: runs/meta_eval/robustness/relearn
Clear cache: False

Loading tokenizer and full model...
UDS data: 367 valid examples
Loading S1 cache from runs/meta_eval/s1_cache_sdpa.json...
Resumed from runs/meta_eval/robustness/relearn/results.json: 37 entries
Processing models [0:76] (76 models)

============================================================
[1/76] retain
  open-unlearning/tofu_Llama-3.2-1B-Instruct_retain90
============================================================
  Already computed, skipping

============================================================
[2/76] altpo_lr1e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[3/76] altpo_lr1e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[4/76] altpo_lr1e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[5/76] altpo_lr2e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[6/76] altpo_lr2e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[7/76] altpo_lr2e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[8/76] altpo_lr5e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[9/76] altpo_lr5e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[10/76] altpo_lr5e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[11/76] altpo_lr1e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[12/76] altpo_lr1e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[13/76] altpo_lr1e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[14/76] altpo_lr2e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[15/76] altpo_lr2e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[16/76] altpo_lr2e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[17/76] altpo_lr5e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[18/76] altpo_lr5e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[19/76] altpo_lr5e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[20/76] graddiff_lr1e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[21/76] graddiff_lr1e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[22/76] graddiff_lr1e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[23/76] graddiff_lr2e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[24/76] graddiff_lr2e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[25/76] graddiff_lr2e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[26/76] graddiff_lr5e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[27/76] graddiff_lr5e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha2_epoch5
============================================================
  Already computed, skipping
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

============================================================
[28/76] graddiff_lr5e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[29/76] graddiff_lr1e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[30/76] graddiff_lr1e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[31/76] graddiff_lr1e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[32/76] graddiff_lr2e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[33/76] graddiff_lr2e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[34/76] graddiff_lr2e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[35/76] graddiff_lr5e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[36/76] graddiff_lr5e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[37/76] graddiff_lr5e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha5_epoch10
============================================================
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:18,  1.52s/it] 15%|█▌        | 2/13 [00:02<00:10,  1.08it/s] 23%|██▎       | 3/13 [00:02<00:07,  1.34it/s] 31%|███       | 4/13 [00:03<00:06,  1.49it/s] 38%|███▊      | 5/13 [00:03<00:04,  1.60it/s] 46%|████▌     | 6/13 [00:04<00:04,  1.67it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.74it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.76it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.77it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.79it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.79it/s] 85%|████████▍ | 11/13 [00:06<00:01,  1.83it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.83it/s]100%|██████████| 13/13 [00:07<00:00,  2.14it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.14it/s]100%|██████████| 13/13 [00:07<00:00,  1.68it/s]
{'loss': 81.5422, 'grad_norm': 988.0, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.7404, 'train_samples_per_second': 51.677, 'train_steps_per_second': 1.679, 'train_loss': 74.01449115459735, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.33it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.29it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.06it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.10it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.21it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.32it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.28it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.44it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.50it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.48it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.42it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.36it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.73it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.42it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.29it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.20it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  3.03it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:02,  3.04it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.08it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.11it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.15it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.30it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.34it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.36it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.27it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.21it/s]Mem eval (multi): 100%|██████████| 13/13 [00:03<00:00,  3.57it/s]Mem eval (multi): 100%|██████████| 13/13 [00:03<00:00,  3.28it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.71it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:16,  3.62it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.59it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.67it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.54it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:16,  3.37it/s]Mem eval (multi):  11%|█         | 7/63 [00:01<00:16,  3.47it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:15,  3.45it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.43it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.43it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.36it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:14,  3.42it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.45it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.33it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.12it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.06it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.15it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.18it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.24it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:05<00:12,  3.45it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.43it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.40it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.46it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.48it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.58it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.66it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:07<00:10,  3.50it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:09,  3.52it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.58it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.62it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:08,  3.60it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:08,  3.47it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.49it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:09<00:08,  3.56it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.66it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.63it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.68it/s]Mem eval (multi):  60%|██████    | 38/63 [00:10<00:06,  3.72it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.77it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.79it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.83it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.69it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.64it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.61it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:12<00:05,  3.58it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.55it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.47it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.45it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.43it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.41it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.51it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:14<00:03,  3.52it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.51it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.39it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:15<00:02,  3.29it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.29it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.38it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.28it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.22it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.25it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.31it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:17<00:00,  3.33it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.66it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.47it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:02<00:29,  2.50s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:04<00:27,  2.49s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:07<00:24,  2.50s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:09<00:22,  2.49s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:12<00:19,  2.49s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:14<00:17,  2.48s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:17<00:14,  2.48s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:19<00:12,  2.47s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:22<00:09,  2.47s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:24<00:07,  2.46s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:27<00:04,  2.47s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:29<00:02,  2.46s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:32<00:00,  2.46s/it]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:02<00:29,  2.50s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:04<00:27,  2.49s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:07<00:25,  2.54s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:10<00:22,  2.53s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:12<00:20,  2.51s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:15<00:17,  2.51s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:17<00:15,  2.50s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:20<00:12,  2.50s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:22<00:09,  2.50s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:25<00:07,  2.49s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:27<00:05,  2.50s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:30<00:02,  2.50s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:32<00:00,  2.49s/it]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.34it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.24it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.00it/s] 31%|███       | 4/13 [00:01<00:02,  3.02it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.12it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.22it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.17it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.32it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.39it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.39it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.27it/s]100%|██████████| 13/13 [00:03<00:00,  3.63it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.16it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.16it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.13it/s] 31%|███       | 4/13 [00:01<00:02,  3.12it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.18it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.34it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.25it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.19it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.28it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.31it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 137.9s
    uds: 0.9524
    em: 0.0577
    mia_loss: 0.0476

============================================================
[38/76] idkdpo_lr1e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha1_epoch5
============================================================
  [Cache] Loaded 151 models from runs/method_eval/metrics_before.json
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:14,  1.23s/it] 15%|█▌        | 2/13 [00:01<00:08,  1.23it/s] 23%|██▎       | 3/13 [00:02<00:08,  1.20it/s] 31%|███       | 4/13 [00:03<00:06,  1.37it/s] 38%|███▊      | 5/13 [00:03<00:05,  1.50it/s] 46%|████▌     | 6/13 [00:04<00:04,  1.59it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.66it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.69it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.72it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.74it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.74it/s] 85%|████████▍ | 11/13 [00:07<00:01,  1.78it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.78it/s]100%|██████████| 13/13 [00:07<00:00,  2.08it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.08it/s]100%|██████████| 13/13 [00:07<00:00,  1.64it/s]
{'loss': 0.3845, 'grad_norm': 11.9375, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.9182, 'train_samples_per_second': 50.517, 'train_steps_per_second': 1.642, 'train_loss': 0.37590540372408354, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.62it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.45it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.18it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.20it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.32it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.42it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.38it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.55it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.62it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.60it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.53it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.47it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.84it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.54it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.23it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.15it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  3.00it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.05it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.08it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.12it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.31it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.32it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.24it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.17it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.52it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.25it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.66it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.57it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.54it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.61it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.49it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.42it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.40it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.32it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.38it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.42it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.29it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.09it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.02it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.11it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.15it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.20it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:05<00:12,  3.41it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.39it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.36it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.43it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.44it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.54it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.63it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.45it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.48it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.54it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.58it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:08,  3.56it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.44it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.45it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:09<00:08,  3.52it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.62it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.60it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.65it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.70it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.75it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.78it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.82it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.68it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.63it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.59it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:12<00:05,  3.55it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.52it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.45it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.42it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.40it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.39it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.49it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.50it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.48it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.37it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:15<00:02,  3.26it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.26it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.35it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.25it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.19it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.22it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.27it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.29it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.62it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.44it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:08,  1.39it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:08,  1.29it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:08,  1.13it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:07,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:06,  1.16it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:04<00:05,  1.27it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:05<00:05,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.32it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.27it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.26it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:10<00:00,  1.26it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:10,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:09,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:09,  1.11it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.26it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.12it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.12it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.13it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.23it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.30it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.36it/s] 15%|█▌        | 2/13 [00:00<00:04,  2.32it/s] 23%|██▎       | 3/13 [00:01<00:04,  2.10it/s] 31%|███       | 4/13 [00:01<00:03,  2.40it/s] 38%|███▊      | 5/13 [00:01<00:03,  2.66it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.88it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.95it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.15it/s] 69%|██████▉   | 9/13 [00:03<00:01,  3.26it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.30it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.25it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.22it/s]100%|██████████| 13/13 [00:04<00:00,  3.59it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.17it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.17it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.14it/s] 31%|███       | 4/13 [00:01<00:02,  3.13it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.19it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.35it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.20it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.29it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.31it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 91.9s
    uds: 0.0643
    em: 0.9443
    mia_loss: 0.9947

============================================================
[39/76] idkdpo_lr1e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:17,  1.48s/it] 15%|█▌        | 2/13 [00:02<00:10,  1.08it/s] 23%|██▎       | 3/13 [00:02<00:07,  1.32it/s] 31%|███       | 4/13 [00:03<00:06,  1.46it/s] 38%|███▊      | 5/13 [00:03<00:05,  1.57it/s] 46%|████▌     | 6/13 [00:04<00:04,  1.64it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.70it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.72it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.73it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.75it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.75it/s] 85%|████████▍ | 11/13 [00:07<00:01,  1.79it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.79it/s]100%|██████████| 13/13 [00:07<00:00,  2.09it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.09it/s]100%|██████████| 13/13 [00:07<00:00,  1.65it/s]
{'loss': 0.3541, 'grad_norm': 11.625, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.8698, 'train_samples_per_second': 50.827, 'train_steps_per_second': 1.652, 'train_loss': 0.35018519254831165, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.61it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.44it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.16it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.18it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.29it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.41it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.38it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.55it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.62it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.60it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.52it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.47it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.84it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.53it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.24it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.15it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  3.00it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.05it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.08it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.12it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.27it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.31it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.32it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.24it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.16it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.52it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.25it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.67it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.57it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.54it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.62it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.49it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.43it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.40it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.32it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.38it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.41it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.28it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.08it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.02it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.10it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.14it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.20it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:12,  3.41it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.39it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.36it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.42it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.44it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.54it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.63it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.48it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.54it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.58it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:08,  3.56it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.45it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:09<00:08,  3.53it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.62it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.59it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.64it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.70it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.75it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.77it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.81it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.68it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.63it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.59it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:12<00:05,  3.55it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.52it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.45it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.42it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.40it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.38it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.48it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.49it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.48it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.37it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:15<00:02,  3.25it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.26it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.35it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.24it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.21it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.27it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.28it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.62it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.44it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:08,  1.34it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:09,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:09,  1.03it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:08,  1.11it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:07,  1.14it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:05<00:05,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.32it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:02,  1.36it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.25it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.15it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:10<00:00,  1.23it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.32it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.32it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:09,  1.10it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.14it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:04<00:07,  1.11it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.28it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.32it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.36it/s] 15%|█▌        | 2/13 [00:00<00:05,  2.06it/s] 23%|██▎       | 3/13 [00:01<00:06,  1.51it/s] 31%|███       | 4/13 [00:02<00:04,  1.89it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.24it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.54it/s] 54%|█████▍    | 7/13 [00:03<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.95it/s] 69%|██████▉   | 9/13 [00:03<00:01,  3.11it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.19it/s] 85%|████████▍ | 11/13 [00:04<00:00,  3.18it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.17it/s]100%|██████████| 13/13 [00:04<00:00,  3.55it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.17it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.17it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.14it/s] 31%|███       | 4/13 [00:01<00:02,  3.13it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.19it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.35it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.20it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.29it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 92.5s
    uds: 0.0607
    em: 0.9471
    mia_loss: 0.9950

============================================================
[40/76] idkdpo_lr1e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:14,  1.25s/it] 15%|█▌        | 2/13 [00:01<00:09,  1.22it/s] 23%|██▎       | 3/13 [00:02<00:06,  1.43it/s] 31%|███       | 4/13 [00:02<00:05,  1.54it/s] 38%|███▊      | 5/13 [00:03<00:04,  1.63it/s] 46%|████▌     | 6/13 [00:04<00:04,  1.68it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.73it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.73it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.74it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.74it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.74it/s] 85%|████████▍ | 11/13 [00:06<00:01,  1.78it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.78it/s]100%|██████████| 13/13 [00:07<00:00,  2.08it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.08it/s]100%|██████████| 13/13 [00:07<00:00,  1.70it/s]
{'loss': 0.3057, 'grad_norm': 10.9375, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.6532, 'train_samples_per_second': 52.266, 'train_steps_per_second': 1.699, 'train_loss': 0.3062981917307927, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.63it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.46it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.18it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.19it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.31it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.43it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.39it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.56it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.62it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.60it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.54it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.48it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.85it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.54it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.23it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.15it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.98it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.99it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.07it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.30it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.32it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.24it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.16it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.52it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.24it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.66it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.58it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.55it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.62it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.49it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.33it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.43it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.40it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.40it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.40it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.32it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.38it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.42it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.29it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.08it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.02it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.10it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.14it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.20it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:05<00:12,  3.41it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.38it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.35it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.42it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.44it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.54it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.63it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.48it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.54it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.59it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:08,  3.56it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.44it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:09<00:08,  3.52it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.62it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.59it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.64it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.70it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.75it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.77it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.82it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.67it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.62it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.58it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:12<00:05,  3.55it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.52it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.44it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.42it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.40it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.38it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.49it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.49it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.48it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.37it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:15<00:02,  3.26it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.26it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.35it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.25it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.19it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.22it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.27it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.29it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.62it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.44it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:08,  1.45it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:08,  1.34it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:08,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:08,  1.06it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:07,  1.11it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:05<00:05,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.13it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.13it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:10<00:00,  1.26it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:10,  1.07it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:09,  1.00it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:08,  1.07it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:04<00:07,  1.12it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:05<00:05,  1.23it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.32it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.26it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.31it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.37it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.29it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.39it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.35it/s] 15%|█▌        | 2/13 [00:00<00:05,  2.06it/s] 23%|██▎       | 3/13 [00:01<00:06,  1.51it/s] 31%|███       | 4/13 [00:02<00:04,  1.89it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.23it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.53it/s] 54%|█████▍    | 7/13 [00:03<00:02,  2.68it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.94it/s] 69%|██████▉   | 9/13 [00:03<00:01,  3.10it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.19it/s] 85%|████████▍ | 11/13 [00:04<00:00,  3.18it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.17it/s]100%|██████████| 13/13 [00:04<00:00,  3.55it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.17it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.17it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.14it/s] 31%|███       | 4/13 [00:01<00:02,  3.13it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.18it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.35it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.20it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.29it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 91.7s
    uds: 0.0480
    em: 0.9521
    mia_loss: 0.9955

============================================================
[41/76] idkdpo_lr2e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:14,  1.24s/it] 15%|█▌        | 2/13 [00:01<00:08,  1.22it/s] 23%|██▎       | 3/13 [00:02<00:06,  1.44it/s] 31%|███       | 4/13 [00:02<00:05,  1.54it/s] 38%|███▊      | 5/13 [00:03<00:04,  1.63it/s] 46%|████▌     | 6/13 [00:03<00:04,  1.68it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.73it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.74it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.75it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s] 85%|████████▍ | 11/13 [00:06<00:01,  1.80it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.79it/s]100%|██████████| 13/13 [00:07<00:00,  2.10it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.10it/s]100%|██████████| 13/13 [00:07<00:00,  1.71it/s]
{'loss': 0.7335, 'grad_norm': 10.125, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.6112, 'train_samples_per_second': 52.554, 'train_steps_per_second': 1.708, 'train_loss': 0.7019256628476657, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.51it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.35it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.09it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.12it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.24it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.35it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.29it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.46it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.54it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.52it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.45it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.39it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.74it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.45it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.24it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.14it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.97it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.98it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.07it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.30it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.32it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.24it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.17it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.52it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.24it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.67it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.58it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.54it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.62it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.49it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.33it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.43it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.40it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.32it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.38it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.42it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.30it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.08it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.01it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.10it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.14it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.20it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:05<00:12,  3.41it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.39it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.36it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.43it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.44it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.54it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.63it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.49it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.54it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.58it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.56it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.45it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:09<00:08,  3.53it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.62it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.59it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.64it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.69it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.75it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.77it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.81it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.67it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.62it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.58it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:12<00:05,  3.55it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.53it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.45it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.42it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.40it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.39it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.48it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.49it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.48it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.36it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:15<00:02,  3.25it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.26it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.35it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.24it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.21it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.26it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.28it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.61it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.44it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:08,  1.43it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:08,  1.35it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:09,  1.10it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:07,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:06,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:04<00:05,  1.28it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.33it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:02,  1.34it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:10<00:00,  1.27it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.31it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.28it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:06,  1.29it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:03<00:05,  1.36it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:04<00:04,  1.40it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.40it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:05<00:03,  1.49it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:06<00:02,  1.46it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.45it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:07<00:01,  1.40it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:09<00:00,  1.26it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:01<00:06,  1.81it/s] 23%|██▎       | 3/13 [00:01<00:06,  1.44it/s] 31%|███       | 4/13 [00:02<00:04,  1.82it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.17it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.47it/s] 54%|█████▍    | 7/13 [00:03<00:02,  2.65it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.90it/s] 69%|██████▉   | 9/13 [00:03<00:01,  3.08it/s] 77%|███████▋  | 10/13 [00:04<00:00,  3.17it/s] 85%|████████▍ | 11/13 [00:04<00:00,  3.17it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.17it/s]100%|██████████| 13/13 [00:04<00:00,  3.54it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.17it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.16it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.13it/s] 31%|███       | 4/13 [00:01<00:02,  3.12it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.18it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.35it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.20it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.29it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.58it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 90.8s
    uds: 0.1875
    em: 0.8823
    mia_loss: 0.9823

============================================================
[42/76] idkdpo_lr2e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:14,  1.25s/it] 15%|█▌        | 2/13 [00:01<00:09,  1.22it/s] 23%|██▎       | 3/13 [00:02<00:08,  1.21it/s] 31%|███       | 4/13 [00:03<00:07,  1.20it/s] 38%|███▊      | 5/13 [00:03<00:05,  1.37it/s] 46%|████▌     | 6/13 [00:04<00:04,  1.48it/s] 54%|█████▍    | 7/13 [00:05<00:03,  1.58it/s] 62%|██████▏   | 8/13 [00:05<00:03,  1.63it/s] 69%|██████▉   | 9/13 [00:06<00:02,  1.67it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.71it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.71it/s] 85%|████████▍ | 11/13 [00:07<00:01,  1.76it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.77it/s]100%|██████████| 13/13 [00:08<00:00,  2.07it/s]                                               100%|██████████| 13/13 [00:08<00:00,  2.07it/s]100%|██████████| 13/13 [00:08<00:00,  1.59it/s]
{'loss': 0.6268, 'grad_norm': 9.5625, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 8.1827, 'train_samples_per_second': 48.884, 'train_steps_per_second': 1.589, 'train_loss': 0.6055562404485849, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.50it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.37it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.12it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.13it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.24it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.36it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.32it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.48it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.56it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.53it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.47it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.41it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.77it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.47it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.24it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.15it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:02,  3.00it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.06it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.08it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.12it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.27it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.31it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.33it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.25it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.18it/s]Mem eval (multi): 100%|██████████| 13/13 [00:03<00:00,  3.53it/s]Mem eval (multi): 100%|██████████| 13/13 [00:03<00:00,  3.25it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.66it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.58it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.55it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.62it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.49it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.33it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.43it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.40it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.32it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.38it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.42it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.29it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.07it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.01it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.10it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.13it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.20it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:12,  3.41it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.38it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.35it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.42it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.44it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.54it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.63it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.48it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.54it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.59it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:08,  3.56it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.44it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:09<00:08,  3.52it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.62it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.59it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.63it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.69it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.74it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.77it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.81it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.67it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.62it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.57it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.54it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.52it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.44it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.41it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.39it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.38it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.48it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.48it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.48it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.35it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:15<00:02,  3.24it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.25it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.34it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.23it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.17it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.20it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.26it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.28it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.60it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.43it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:08,  1.35it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:09,  1.11it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:09,  1.05it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:08,  1.02it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:07,  1.07it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:05<00:06,  1.13it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.09it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:07<00:04,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.23it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.15it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.16it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:11<00:00,  1.22it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.32it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.13it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:03<00:06,  1.33it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.37it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.25it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.35it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:06<00:02,  1.36it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.37it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.37it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:09<00:00,  1.33it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:01<00:06,  1.81it/s] 23%|██▎       | 3/13 [00:01<00:06,  1.55it/s] 31%|███       | 4/13 [00:02<00:04,  1.93it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.27it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.56it/s] 54%|█████▍    | 7/13 [00:03<00:02,  2.71it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  3.12it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.20it/s] 85%|████████▍ | 11/13 [00:04<00:00,  3.19it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.18it/s]100%|██████████| 13/13 [00:04<00:00,  3.56it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.17it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.17it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.14it/s] 31%|███       | 4/13 [00:01<00:02,  3.12it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.18it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.35it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.19it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.28it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.58it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 92.5s
    uds: 0.1584
    em: 0.8977
    mia_loss: 0.9862

============================================================
[43/76] idkdpo_lr2e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:14,  1.23s/it] 15%|█▌        | 2/13 [00:01<00:08,  1.23it/s] 23%|██▎       | 3/13 [00:02<00:06,  1.44it/s] 31%|███       | 4/13 [00:02<00:05,  1.55it/s] 38%|███▊      | 5/13 [00:03<00:04,  1.64it/s] 46%|████▌     | 6/13 [00:03<00:04,  1.68it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.74it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.74it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.75it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s] 85%|████████▍ | 11/13 [00:06<00:01,  1.80it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.79it/s]100%|██████████| 13/13 [00:07<00:00,  2.10it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.10it/s]100%|██████████| 13/13 [00:07<00:00,  1.71it/s]
{'loss': 0.4999, 'grad_norm': 10.0, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.604, 'train_samples_per_second': 52.604, 'train_steps_per_second': 1.71, 'train_loss': 0.49323325890761155, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.53it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.37it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.14it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.16it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.28it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.39it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.34it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.51it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.58it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.56it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.49it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.43it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.79it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.49it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.24it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.15it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.99it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.05it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.07it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.30it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.32it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.24it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.17it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.53it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.25it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.66it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.57it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.55it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.62it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.49it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.42it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.40it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.38it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.31it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.37it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.41it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.28it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.07it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.01it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.09it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.13it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.19it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:12,  3.41it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.38it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.35it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.41it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.43it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.53it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.62it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.45it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.47it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.53it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.58it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.55it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.45it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.53it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.63it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.60it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.64it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.69it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.75it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.77it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.81it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.67it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.62it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.58it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.54it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.51it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.44it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.41it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.39it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.37it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.47it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.48it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.47it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.35it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.24it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.24it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.34it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.23it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.21it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.26it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.28it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.61it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.43it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:08,  1.39it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:09,  1.16it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:08,  1.15it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:07,  1.14it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:06,  1.16it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:05<00:05,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.33it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.33it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.28it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.32it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:10<00:00,  1.27it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.29it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.34it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:07,  1.32it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:06,  1.34it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:03<00:05,  1.43it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:04<00:04,  1.48it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.28it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:05<00:03,  1.40it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:06<00:02,  1.48it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.47it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:07<00:01,  1.50it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:08<00:00,  1.31it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:09<00:00,  1.40it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:09,  1.24it/s] 15%|█▌        | 2/13 [00:01<00:10,  1.02it/s] 23%|██▎       | 3/13 [00:02<00:09,  1.03it/s] 31%|███       | 4/13 [00:03<00:06,  1.40it/s] 38%|███▊      | 5/13 [00:03<00:04,  1.77it/s] 46%|████▌     | 6/13 [00:03<00:03,  2.12it/s] 54%|█████▍    | 7/13 [00:04<00:02,  2.35it/s] 62%|██████▏   | 8/13 [00:04<00:01,  2.66it/s] 69%|██████▉   | 9/13 [00:04<00:01,  2.88it/s] 77%|███████▋  | 10/13 [00:04<00:00,  3.02it/s] 85%|████████▍ | 11/13 [00:05<00:00,  3.07it/s] 92%|█████████▏| 12/13 [00:05<00:00,  3.09it/s]100%|██████████| 13/13 [00:05<00:00,  3.48it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.17it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.16it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.13it/s] 31%|███       | 4/13 [00:01<00:02,  3.12it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.18it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.35it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.25it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.19it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.28it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.31it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.31it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 91.4s
    uds: 0.1176
    em: 0.9177
    mia_loss: 0.9909

============================================================
[44/76] idkdpo_lr5e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:14,  1.25s/it] 15%|█▌        | 2/13 [00:01<00:09,  1.17it/s] 23%|██▎       | 3/13 [00:02<00:07,  1.40it/s] 31%|███       | 4/13 [00:02<00:05,  1.51it/s] 38%|███▊      | 5/13 [00:03<00:04,  1.61it/s] 46%|████▌     | 6/13 [00:04<00:04,  1.67it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.72it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.73it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.74it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s] 85%|████████▍ | 11/13 [00:06<00:01,  1.80it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.79it/s]100%|██████████| 13/13 [00:07<00:00,  2.10it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.10it/s]100%|██████████| 13/13 [00:07<00:00,  1.69it/s]
{'loss': 1.3346, 'grad_norm': 11.0625, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.6807, 'train_samples_per_second': 52.079, 'train_steps_per_second': 1.693, 'train_loss': 1.292584932767428, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.44it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.32it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.05it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.08it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.19it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.30it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.26it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.43it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.48it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.47it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.40it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.34it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.70it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.40it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.23it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.14it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.98it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.99it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.05it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.07it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.30it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.32it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.24it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.16it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.52it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.24it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.65it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.57it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.54it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.62it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.48it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.42it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.40it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.33it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.38it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.41it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.28it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.07it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.00it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.09it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.13it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.19it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:12,  3.40it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.38it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.36it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.42it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.44it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.53it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.62it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.45it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.48it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.54it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.58it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.55it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.44it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.52it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.61it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.59it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.64it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.69it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.74it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.76it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.80it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.66it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.61it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.57it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.54it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.51it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.44it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.41it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.39it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.38it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.48it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.49it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.48it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.36it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.25it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.26it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.35it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.24it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.21it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.26it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.28it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.61it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.43it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:09,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:08,  1.26it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:08,  1.16it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:07,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:06,  1.29it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:04<00:05,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:05<00:05,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.19it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:10<00:00,  1.22it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.33it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:09,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:09,  1.08it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.15it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.28it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.28it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.23it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.25it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.26it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.37it/s] 15%|█▌        | 2/13 [00:01<00:06,  1.70it/s] 23%|██▎       | 3/13 [00:02<00:08,  1.16it/s] 31%|███       | 4/13 [00:02<00:05,  1.54it/s] 38%|███▊      | 5/13 [00:02<00:04,  1.91it/s] 46%|████▌     | 6/13 [00:03<00:03,  2.25it/s] 54%|█████▍    | 7/13 [00:03<00:02,  2.46it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.75it/s] 69%|██████▉   | 9/13 [00:04<00:01,  2.96it/s] 77%|███████▋  | 10/13 [00:04<00:00,  3.07it/s] 85%|████████▍ | 11/13 [00:04<00:00,  3.10it/s] 92%|█████████▏| 12/13 [00:05<00:00,  3.11it/s]100%|██████████| 13/13 [00:05<00:00,  3.50it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.17it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.16it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.13it/s] 31%|███       | 4/13 [00:01<00:02,  3.12it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.17it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.34it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.19it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.28it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 92.6s
    uds: 0.4256
    em: 0.7690
    mia_loss: 0.8769

============================================================
[45/76] idkdpo_lr5e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:15,  1.26s/it] 15%|█▌        | 2/13 [00:01<00:09,  1.21it/s] 23%|██▎       | 3/13 [00:02<00:07,  1.43it/s] 31%|███       | 4/13 [00:02<00:05,  1.53it/s] 38%|███▊      | 5/13 [00:03<00:04,  1.62it/s] 46%|████▌     | 6/13 [00:04<00:04,  1.67it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.72it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.73it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.74it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.75it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.75it/s] 85%|████████▍ | 11/13 [00:06<00:01,  1.79it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.79it/s]100%|██████████| 13/13 [00:07<00:00,  2.09it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.09it/s]100%|██████████| 13/13 [00:07<00:00,  1.70it/s]
{'loss': 1.1581, 'grad_norm': 10.625, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.6572, 'train_samples_per_second': 52.239, 'train_steps_per_second': 1.698, 'train_loss': 1.1260059613447924, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.45it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.33it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.05it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.09it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.20it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.31it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.26it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.42it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.49it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.47it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.40it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.34it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.70it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.41it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.24it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.15it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.97it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.98it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.07it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.10it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.25it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.29it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.30it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.22it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.15it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.51it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.23it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.66it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.57it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.55it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.62it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.48it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.31it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.41it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.39it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.38it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.38it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.32it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.37it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.41it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.29it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.07it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.00it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.10it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.13it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.19it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:12,  3.40it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.38it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.35it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.42it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.44it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.54it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.62it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.45it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.47it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.54it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.58it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.55it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.44it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.51it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.61it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.58it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.63it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.68it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.73it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.75it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.80it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.65it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.61it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.57it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.53it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.51it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.44it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.41it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.39it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.37it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.48it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.48it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.47it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.35it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.24it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.25it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.34it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.23it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.17it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.20it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.26it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.28it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.61it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.43it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:09,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:09,  1.12it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:09,  1.11it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:07,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:06,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:04<00:05,  1.28it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.27it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.35it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.29it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.27it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.28it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:10<00:00,  1.29it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.14it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.15it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.23it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.34it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.06it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.11it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.10it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:11<00:00,  1.17it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.40it/s] 15%|█▌        | 2/13 [00:01<00:07,  1.48it/s] 23%|██▎       | 3/13 [00:02<00:07,  1.34it/s] 31%|███       | 4/13 [00:02<00:05,  1.72it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.08it/s] 46%|████▌     | 6/13 [00:03<00:02,  2.40it/s] 54%|█████▍    | 7/13 [00:03<00:02,  2.59it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.86it/s] 69%|██████▉   | 9/13 [00:03<00:01,  3.04it/s] 77%|███████▋  | 10/13 [00:04<00:00,  3.14it/s] 85%|████████▍ | 11/13 [00:04<00:00,  3.15it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.15it/s]100%|██████████| 13/13 [00:05<00:00,  3.53it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.18it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.17it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.13it/s] 31%|███       | 4/13 [00:01<00:02,  3.12it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.18it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.35it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.20it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.29it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 92.8s
    uds: 0.3608
    em: 0.7929
    mia_loss: 0.9218

============================================================
[46/76] idkdpo_lr5e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:14,  1.24s/it] 15%|█▌        | 2/13 [00:01<00:08,  1.23it/s] 23%|██▎       | 3/13 [00:02<00:06,  1.44it/s] 31%|███       | 4/13 [00:03<00:06,  1.32it/s] 38%|███▊      | 5/13 [00:03<00:05,  1.46it/s] 46%|████▌     | 6/13 [00:04<00:04,  1.56it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.64it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.67it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.70it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.73it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.73it/s] 85%|████████▍ | 11/13 [00:07<00:01,  1.77it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.77it/s]100%|██████████| 13/13 [00:07<00:00,  2.07it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.07it/s]100%|██████████| 13/13 [00:07<00:00,  1.64it/s]
{'loss': 0.9598, 'grad_norm': 10.5, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.9108, 'train_samples_per_second': 50.564, 'train_steps_per_second': 1.643, 'train_loss': 0.9372367125291091, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.46it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.33it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.08it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.10it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.22it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.32it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.28it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.44it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.51it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.49it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.42it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.36it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.72it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.42it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.23it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.14it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.98it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.99it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.05it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.07it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.25it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.29it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.31it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.23it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.16it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.52it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.24it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.65it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.57it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.54it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.61it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.49it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.33it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.43it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.40it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.38it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.38it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.31it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.38it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.41it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.29it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.08it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.01it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.10it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.14it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.20it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:12,  3.41it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.38it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.36it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.42it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.45it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.55it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.63it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.47it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.53it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.57it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.55it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.44it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.52it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.61it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.59it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.64it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.69it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.74it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.76it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.81it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.67it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.62it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.58it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.55it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.52it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.44it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.42it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.40it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.38it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.48it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.49it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.48it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.36it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:15<00:02,  3.25it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.25it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.34it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.24it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.21it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.26it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.28it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.61it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.43it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:09,  1.30it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:09,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:09,  1.08it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:08,  1.10it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:07,  1.08it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:05<00:06,  1.09it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.30it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.25it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.19it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:10<00:00,  1.24it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:08,  1.48it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.23it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:09,  1.11it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:08,  1.12it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.33it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:05<00:05,  1.10it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.28it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.27it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.25it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.26it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:01<00:06,  1.80it/s] 23%|██▎       | 3/13 [00:01<00:06,  1.54it/s] 31%|███       | 4/13 [00:02<00:04,  1.91it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.26it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.55it/s] 54%|█████▍    | 7/13 [00:03<00:02,  2.70it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.95it/s] 69%|██████▉   | 9/13 [00:03<00:01,  3.11it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.20it/s] 85%|████████▍ | 11/13 [00:04<00:00,  3.18it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.17it/s]100%|██████████| 13/13 [00:04<00:00,  3.55it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.17it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.17it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.14it/s] 31%|███       | 4/13 [00:01<00:02,  3.13it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.18it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.34it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.19it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.28it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.31it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 92.5s
    uds: 0.2960
    em: 0.8224
    mia_loss: 0.9515

============================================================
[47/76] idkdpo_lr1e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:14,  1.24s/it] 15%|█▌        | 2/13 [00:01<00:09,  1.22it/s] 23%|██▎       | 3/13 [00:02<00:06,  1.44it/s] 31%|███       | 4/13 [00:02<00:05,  1.54it/s] 38%|███▊      | 5/13 [00:03<00:04,  1.63it/s] 46%|████▌     | 6/13 [00:04<00:04,  1.68it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.73it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.74it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.75it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s] 85%|████████▍ | 11/13 [00:06<00:01,  1.80it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.79it/s]100%|██████████| 13/13 [00:07<00:00,  2.09it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.09it/s]100%|██████████| 13/13 [00:07<00:00,  1.71it/s]
{'loss': 0.4178, 'grad_norm': 11.5625, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.6248, 'train_samples_per_second': 52.46, 'train_steps_per_second': 1.705, 'train_loss': 0.4050202644788302, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.58it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.43it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.17it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.19it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.29it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.41it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.37it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.54it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.61it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.59it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.52it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.46it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.83it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.52it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.24it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.15it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.98it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.98it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.07it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.30it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.31it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.23it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.16it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.51it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.24it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.66it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.57it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.54it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.62it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.48it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.31it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.42it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.39it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.38it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.38it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.31it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.36it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.41it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.28it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.08it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.01it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.10it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.14it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.20it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:12,  3.41it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.39it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.35it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.42it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.43it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.54it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.63it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.48it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.54it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.58it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.56it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.45it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.52it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.62it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.59it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.64it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.69it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.75it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.77it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.81it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.66it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.62it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.58it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.55it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.51it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.44it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.41it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.40it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.38it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.49it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.50it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.48it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.37it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:15<00:02,  3.26it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.26it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.35it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.24it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.19it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.21it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.27it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.28it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.61it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.43it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:08,  1.40it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:08,  1.26it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:08,  1.19it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:07,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:06,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:04<00:05,  1.29it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.27it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.38it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:06<00:03,  1.33it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.26it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.14it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:10<00:00,  1.25it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:09,  1.11it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:08,  1.10it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:04<00:07,  1.05it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:05<00:06,  1.15it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:06<00:04,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.17it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.29it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.31it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.25it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.32it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:01<00:09,  1.13it/s] 23%|██▎       | 3/13 [00:04<00:18,  1.81s/it] 31%|███       | 4/13 [00:04<00:10,  1.22s/it] 38%|███▊      | 5/13 [00:05<00:07,  1.12it/s] 46%|████▌     | 6/13 [00:05<00:04,  1.46it/s] 54%|█████▍    | 7/13 [00:05<00:03,  1.76it/s] 62%|██████▏   | 8/13 [00:06<00:02,  2.11it/s] 69%|██████▉   | 9/13 [00:06<00:01,  2.41it/s] 77%|███████▋  | 10/13 [00:06<00:01,  2.65it/s] 85%|████████▍ | 11/13 [00:06<00:00,  2.79it/s] 92%|█████████▏| 12/13 [00:07<00:00,  2.89it/s]100%|██████████| 13/13 [00:07<00:00,  3.30it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.18it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.17it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.14it/s] 31%|███       | 4/13 [00:01<00:02,  3.12it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.18it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.35it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.20it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.28it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 94.2s
    uds: 0.0732
    em: 0.9407
    mia_loss: 0.9944

============================================================
[48/76] idkdpo_lr1e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:14,  1.24s/it] 15%|█▌        | 2/13 [00:01<00:08,  1.23it/s] 23%|██▎       | 3/13 [00:02<00:06,  1.44it/s] 31%|███       | 4/13 [00:02<00:05,  1.55it/s] 38%|███▊      | 5/13 [00:03<00:04,  1.64it/s] 46%|████▌     | 6/13 [00:03<00:04,  1.68it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.73it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.74it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.75it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s] 85%|████████▍ | 11/13 [00:06<00:01,  1.80it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.79it/s]100%|██████████| 13/13 [00:07<00:00,  2.10it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.10it/s]100%|██████████| 13/13 [00:07<00:00,  1.71it/s]
{'loss': 0.3788, 'grad_norm': 11.0, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.6094, 'train_samples_per_second': 52.567, 'train_steps_per_second': 1.708, 'train_loss': 0.3717171228848971, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.58it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.42it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.15it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.18it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.29it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.41it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.37it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.54it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.61it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.59it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.52it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.47it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.84it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.52it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.23it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.14it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.98it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.99it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.05it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.07it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.30it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.32it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.23it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.17it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.52it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.24it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.67it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.57it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.55it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.63it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.50it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.33it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.43it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.40it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.40it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.40it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.33it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.38it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.42it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.29it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.08it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.01it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.09it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.13it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.19it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:05<00:12,  3.40it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.38it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.35it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.42it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.44it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.54it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.62it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.45it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.47it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.53it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.57it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.55it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.42it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.44it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.51it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.61it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.58it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.63it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.68it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.74it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.76it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.81it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.66it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.61it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.57it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.54it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.51it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.44it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.42it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.39it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.37it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.47it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.48it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.48it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.36it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:15<00:02,  3.25it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.26it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.35it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.24it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.21it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.26it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.28it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.61it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.43it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:08,  1.38it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:09,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:08,  1.13it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:07,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:03<00:06,  1.31it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:04<00:05,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.29it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.32it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.25it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.15it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.12it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:10<00:00,  1.22it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.23it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:10,  1.08it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:09,  1.07it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:08,  1.10it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:04<00:07,  1.08it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:05<00:05,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.16it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:07<00:04,  1.14it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.30it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.30it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:11,  1.05it/s] 15%|█▌        | 2/13 [00:04<00:25,  2.34s/it] 23%|██▎       | 3/13 [00:06<00:24,  2.45s/it] 31%|███       | 4/13 [00:07<00:14,  1.62s/it] 38%|███▊      | 5/13 [00:07<00:09,  1.15s/it] 46%|████▌     | 6/13 [00:07<00:05,  1.17it/s] 54%|█████▍    | 7/13 [00:08<00:04,  1.47it/s] 62%|██████▏   | 8/13 [00:08<00:02,  1.81it/s] 69%|██████▉   | 9/13 [00:08<00:01,  2.14it/s] 77%|███████▋  | 10/13 [00:08<00:01,  2.42it/s] 85%|████████▍ | 11/13 [00:09<00:00,  2.60it/s] 92%|█████████▏| 12/13 [00:09<00:00,  2.75it/s]100%|██████████| 13/13 [00:09<00:00,  3.17it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.18it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.17it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.14it/s] 31%|███       | 4/13 [00:01<00:02,  3.12it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.18it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.35it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.20it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.29it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.32it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.58it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 97.0s
    uds: 0.0637
    em: 0.9444
    mia_loss: 0.9947

============================================================
[49/76] idkdpo_lr1e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:14,  1.24s/it] 15%|█▌        | 2/13 [00:01<00:08,  1.23it/s] 23%|██▎       | 3/13 [00:02<00:06,  1.44it/s] 31%|███       | 4/13 [00:02<00:05,  1.55it/s] 38%|███▊      | 5/13 [00:03<00:04,  1.64it/s] 46%|████▌     | 6/13 [00:03<00:04,  1.68it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.74it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.74it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.75it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.76it/s] 85%|████████▍ | 11/13 [00:06<00:01,  1.80it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.79it/s]100%|██████████| 13/13 [00:07<00:00,  2.09it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.09it/s]100%|██████████| 13/13 [00:07<00:00,  1.71it/s]
{'loss': 0.3211, 'grad_norm': 11.5625, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.603, 'train_samples_per_second': 52.611, 'train_steps_per_second': 1.71, 'train_loss': 0.3203165622857901, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.60it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.45it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.17it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.19it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.31it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.42it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.38it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.55it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.62it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.61it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.54it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.48it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.85it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.54it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.22it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.14it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.97it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.98it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.07it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.30it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.31it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.23it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.16it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.51it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.24it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.66it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.57it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.55it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.62it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.49it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.42it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.39it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.32it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.38it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.41it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.29it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.07it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.01it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.09it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.13it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.20it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:12,  3.41it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.38it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.35it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.42it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.44it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.54it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.63it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.48it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.53it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.58it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.55it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.45it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.52it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.61it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.58it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:10<00:07,  3.63it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:06,  3.68it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.74it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:11<00:06,  3.76it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:11<00:05,  3.80it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.66it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.62it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:12<00:05,  3.56it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.54it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:04,  3.51it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:13<00:04,  3.44it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:13<00:04,  3.41it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.39it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:14<00:03,  3.38it/s]Mem eval (multi):  81%|████████  | 51/63 [00:14<00:03,  3.48it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.48it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:15<00:02,  3.48it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:15<00:02,  3.36it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.25it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:16<00:02,  3.25it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:16<00:01,  3.34it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:16<00:01,  3.23it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:17<00:01,  3.17it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:17<00:00,  3.21it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:17<00:00,  3.26it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.28it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.61it/s]Mem eval (multi): 100%|██████████| 63/63 [00:18<00:00,  3.43it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:   8%|▊         | 1/13 [00:00<00:08,  1.36it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  15%|█▌        | 2/13 [00:01<00:09,  1.16it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  23%|██▎       | 3/13 [00:02<00:09,  1.10it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  31%|███       | 4/13 [00:03<00:08,  1.03it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  38%|███▊      | 5/13 [00:04<00:07,  1.10it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  46%|████▌     | 6/13 [00:05<00:05,  1.22it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.12it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  62%|██████▏   | 8/13 [00:07<00:04,  1.15it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.14it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.11it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.15it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
gen: 100%|██████████| 13/13 [00:11<00:00,  1.24it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.29it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  15%|█▌        | 2/13 [00:01<00:10,  1.05it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  23%|██▎       | 3/13 [00:02<00:10,  1.01s/it]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  31%|███       | 4/13 [00:03<00:08,  1.08it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.16it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  46%|████▌     | 6/13 [00:05<00:05,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.08it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.20it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.18it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.21it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.29it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.24it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.29it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:13,  1.13s/it] 15%|█▌        | 2/13 [00:04<00:28,  2.59s/it] 23%|██▎       | 3/13 [00:08<00:30,  3.04s/it] 31%|███       | 4/13 [00:08<00:17,  1.98s/it] 38%|███▊      | 5/13 [00:08<00:11,  1.38s/it] 46%|████▌     | 6/13 [00:09<00:07,  1.01s/it] 54%|█████▍    | 7/13 [00:09<00:04,  1.27it/s] 62%|██████▏   | 8/13 [00:09<00:03,  1.60it/s] 69%|██████▉   | 9/13 [00:10<00:02,  1.92it/s] 77%|███████▋  | 10/13 [00:10<00:01,  2.21it/s] 85%|████████▍ | 11/13 [00:10<00:00,  2.43it/s] 92%|█████████▏| 12/13 [00:11<00:00,  2.60it/s]100%|██████████| 13/13 [00:11<00:00,  3.02it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.13it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.14it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.11it/s] 31%|███       | 4/13 [00:01<00:02,  3.10it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.16it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.26it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.32it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.24it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.18it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.27it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.31it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.31it/s]100%|██████████| 13/13 [00:03<00:00,  3.56it/s]                                               huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 100.7s
    uds: 0.0496
    em: 0.9506
    mia_loss: 0.9953

============================================================
[50/76] idkdpo_lr2e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:15,  1.26s/it] 15%|█▌        | 2/13 [00:01<00:09,  1.21it/s] 23%|██▎       | 3/13 [00:02<00:07,  1.43it/s] 31%|███       | 4/13 [00:02<00:05,  1.54it/s] 38%|███▊      | 5/13 [00:03<00:04,  1.63it/s] 46%|████▌     | 6/13 [00:04<00:04,  1.68it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.73it/s] 62%|██████▏   | 8/13 [00:05<00:02,  1.73it/s] 69%|██████▉   | 9/13 [00:05<00:02,  1.73it/s] 77%|███████▋  | 10/13 [00:06<00:01,  1.74it/s]                                                77%|███████▋  | 10/13 [00:06<00:01,  1.74it/s] 85%|████████▍ | 11/13 [00:06<00:01,  1.78it/s] 92%|█████████▏| 12/13 [00:07<00:00,  1.78it/s]100%|██████████| 13/13 [00:07<00:00,  2.08it/s]                                               100%|██████████| 13/13 [00:07<00:00,  2.08it/s]100%|██████████| 13/13 [00:07<00:00,  1.70it/s]
{'loss': 0.7494, 'grad_norm': 10.125, 'learning_rate': 6.153846153846155e-06, 'epoch': 0.8}
{'train_runtime': 7.6673, 'train_samples_per_second': 52.17, 'train_steps_per_second': 1.696, 'train_loss': 0.7156292200088501, 'epoch': 1.0}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.49it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.36it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  3.09it/s]Mem eval:  31%|███       | 4/13 [00:01<00:02,  3.12it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.23it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.34it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.30it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.46it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.54it/s]Mem eval:  77%|███████▋  | 10/13 [00:02<00:00,  3.52it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.45it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.39it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.74it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.45it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.23it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.14it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:00<00:03,  2.98it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.98it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:01<00:02,  3.07it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.26it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.30it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.32it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.24it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.16it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.52it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.24it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:16,  3.65it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.57it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:16,  3.54it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:16,  3.62it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:16,  3.49it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:16,  3.43it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.40it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:02<00:15,  3.39it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:15,  3.32it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.38it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:14,  3.42it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:14,  3.29it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:15,  3.07it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:04<00:15,  3.00it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:14,  3.10it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.14it/s]Mem eval (multi):  30%|███       | 19/63 [00:05<00:13,  3.20it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:12,  3.41it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.39it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.36it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:06<00:11,  3.42it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.44it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:10,  3.54it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:07<00:10,  3.63it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.48it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:09,  3.54it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:08<00:09,  3.58it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.55it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:09<00:08,  3.44it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.52it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:07,  3.61it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:10<00:07,  3.59it/s]======================================================================
Robustness Meta-Evaluation: RELEARN
======================================================================
GPU: 1
Models: 151 (1 retain + 150 unlearn)
Metrics: em, es, prob, paraprob, truth_ratio, rouge, para_rouge, jailbreak_rouge, mia_loss, mia_zlib, mia_min_k, mia_min_kpp, uds
Output: runs/meta_eval/robustness/relearn
Clear cache: False

Loading tokenizer and full model...
UDS data: 367 valid examples
Loading S1 cache from runs/meta_eval/s1_cache_sdpa.json...
Resumed from runs/meta_eval/robustness/relearn/results.json: 50 entries
Processing models [0:76] (76 models)

============================================================
[1/76] retain
  open-unlearning/tofu_Llama-3.2-1B-Instruct_retain90
============================================================
  Already computed, skipping

============================================================
[2/76] altpo_lr1e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[3/76] altpo_lr1e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[4/76] altpo_lr1e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[5/76] altpo_lr2e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[6/76] altpo_lr2e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[7/76] altpo_lr2e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[8/76] altpo_lr5e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[9/76] altpo_lr5e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[10/76] altpo_lr5e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[11/76] altpo_lr1e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[12/76] altpo_lr1e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[13/76] altpo_lr1e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[14/76] altpo_lr2e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[15/76] altpo_lr2e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[16/76] altpo_lr2e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[17/76] altpo_lr5e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[18/76] altpo_lr5e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[19/76] altpo_lr5e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[20/76] graddiff_lr1e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[21/76] graddiff_lr1e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[22/76] graddiff_lr1e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[23/76] graddiff_lr2e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[24/76] graddiff_lr2e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[25/76] graddiff_lr2e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[26/76] graddiff_lr5e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[27/76] graddiff_lr5e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha2_epoch5
============================================================
  Already computed, skipping
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.

============================================================
[28/76] graddiff_lr5e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[29/76] graddiff_lr1e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[30/76] graddiff_lr1e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[31/76] graddiff_lr1e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[32/76] graddiff_lr2e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[33/76] graddiff_lr2e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[34/76] graddiff_lr2e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[35/76] graddiff_lr5e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[36/76] graddiff_lr5e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[37/76] graddiff_lr5e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[38/76] idkdpo_lr1e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[39/76] idkdpo_lr1e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[40/76] idkdpo_lr1e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[41/76] idkdpo_lr2e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[42/76] idkdpo_lr2e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[43/76] idkdpo_lr2e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[44/76] idkdpo_lr5e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[45/76] idkdpo_lr5e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[46/76] idkdpo_lr5e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[47/76] idkdpo_lr1e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[48/76] idkdpo_lr1e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[49/76] idkdpo_lr1e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha5_epoch10
============================================================
  Already computed, skipping

============================================================
[50/76] idkdpo_lr2e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha1_epoch10
============================================================
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:15,  1.44s/it] 17%|█▋        | 2/12 [00:01<00:09,  1.11it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.34it/s] 33%|███▎      | 4/12 [00:03<00:05,  1.47it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.57it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.69it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.70it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.71it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.73it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.73it/s] 92%|█████████▏| 11/12 [00:07<00:00,  1.77it/s]100%|██████████| 12/12 [00:07<00:00,  1.76it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.76it/s]100%|██████████| 12/12 [00:07<00:00,  1.58it/s]
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
{'loss': 0.7534, 'grad_norm': 10.25, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.6164, 'train_samples_per_second': 52.518, 'train_steps_per_second': 1.576, 'train_loss': 0.7353324890136719, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.20it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.15it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:03,  2.92it/s]Mem eval:  31%|███       | 4/13 [00:01<00:03,  2.97it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.07it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.18it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.15it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.31it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.38it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.36it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.29it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.24it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.59it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.29it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.11it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.01it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.85it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.85it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.91it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.93it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.97it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.15it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.17it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.09it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.03it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.38it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.10it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.50it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.40it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.37it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.45it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.33it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.18it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.27it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.24it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.23it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.23it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.17it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.23it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.27it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.14it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.95it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.87it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.96it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.99it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.25it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.36it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.45it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.29it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:10,  3.36it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.41it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.38it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.26it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.27it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.36it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.45it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.42it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.47it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.52it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.58it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.60it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.64it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.50it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.44it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.40it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.37it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.34it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.23it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.30it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.19it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.08it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.09it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.03it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.05it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.10it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.12it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.45it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.27it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:09,  1.27it/s]gen:  15%|█▌        | 2/13 [00:01<00:09,  1.15it/s]gen:  23%|██▎       | 3/13 [00:02<00:08,  1.12it/s]gen:  31%|███       | 4/13 [00:03<00:07,  1.16it/s]gen:  38%|███▊      | 5/13 [00:04<00:07,  1.12it/s]gen:  46%|████▌     | 6/13 [00:05<00:06,  1.10it/s]gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.12it/s]gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.24it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.23it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.11it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.15it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.06it/s]gen: 100%|██████████| 13/13 [00:11<00:00,  1.15it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.22it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:09,  1.21it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.23it/s]jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.27it/s]jb_gen:  38%|███▊      | 5/13 [00:03<00:06,  1.31it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.36it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.42it/s]jb_gen:  62%|██████▏   | 8/13 [00:05<00:03,  1.45it/s]jb_gen:  69%|██████▉   | 9/13 [00:06<00:02,  1.40it/s]jb_gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.41it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.38it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.18it/s]jb_gen: 100%|██████████| 13/13 [00:09<00:00,  1.29it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.07it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.97it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s] 31%|███       | 4/13 [00:01<00:03,  2.76it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.85it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.94it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.90it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.04it/s] 69%|██████▉   | 9/13 [00:03<00:01,  3.09it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.08it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.02it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.98it/s]100%|██████████| 13/13 [00:04<00:00,  3.33it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.90it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.01it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]100%|██████████| 13/13 [00:04<00:00,  3.25it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 94.6s
    uds: 0.2038
    em: 0.8748
    mia_loss: 0.9802

============================================================
[51/76] idkdpo_lr2e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha2_epoch10
============================================================
  [Cache] Loaded 151 models from runs/method_eval/metrics_before.json
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.24s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.21it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.41it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.51it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.64it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.60it/s]
{'loss': 0.6479, 'grad_norm': 9.6875, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5109, 'train_samples_per_second': 53.256, 'train_steps_per_second': 1.598, 'train_loss': 0.6352085471153259, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.31it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.18it/s]Mem eval:  23%|██▎       | 3/13 [00:00<00:03,  2.93it/s]Mem eval:  31%|███       | 4/13 [00:01<00:03,  2.96it/s]Mem eval:  38%|███▊      | 5/13 [00:01<00:02,  3.06it/s]Mem eval:  46%|████▌     | 6/13 [00:01<00:02,  3.17it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:01,  3.12it/s]Mem eval:  62%|██████▏   | 8/13 [00:02<00:01,  3.28it/s]Mem eval:  69%|██████▉   | 9/13 [00:02<00:01,  3.36it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.33it/s]Mem eval:  85%|████████▍ | 11/13 [00:03<00:00,  3.27it/s]Mem eval:  92%|█████████▏| 12/13 [00:03<00:00,  3.21it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.57it/s]Mem eval: 100%|██████████| 13/13 [00:03<00:00,  3.27it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.07it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.89it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.92it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.95it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.09it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.13it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.14it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.06it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.34it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.08it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.47it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.35it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.42it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.30it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.14it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.25it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.22it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.21it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.21it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.15it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.20it/s]Mem eval (multi):  21%|██        | 13/63 [00:04<00:15,  3.24it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.12it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.94it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.03it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.24it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.21it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.18it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.24it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.25it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.36it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.44it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.29it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.36it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.40it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.37it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.24it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.26it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.34it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.43it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.40it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.45it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.51it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.57it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.59it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.63it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.48it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.43it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.39it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.36it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:14<00:05,  3.33it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.26it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.22it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.20it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.30it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.30it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.29it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.19it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.08it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.08it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.17it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.07it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.01it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.04it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.10it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.11it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.44it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.26it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:09,  1.33it/s]gen:  15%|█▌        | 2/13 [00:01<00:09,  1.15it/s]gen:  23%|██▎       | 3/13 [00:02<00:09,  1.10it/s]gen:  31%|███       | 4/13 [00:03<00:08,  1.05it/s]gen:  38%|███▊      | 5/13 [00:04<00:07,  1.05it/s]gen:  46%|████▌     | 6/13 [00:05<00:06,  1.08it/s]gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.15it/s]gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.22it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.17it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.16it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.20it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.20it/s]gen: 100%|██████████| 13/13 [00:11<00:00,  1.26it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.28it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.31it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.19it/s]jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.25it/s]jb_gen:  38%|███▊      | 5/13 [00:03<00:06,  1.31it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.29it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.35it/s]jb_gen:  62%|██████▏   | 8/13 [00:05<00:03,  1.42it/s]jb_gen:  69%|██████▉   | 9/13 [00:06<00:02,  1.37it/s]jb_gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.32it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.24it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.18it/s]jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.28it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.05it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.96it/s] 23%|██▎       | 3/13 [00:01<00:04,  2.01it/s] 31%|███       | 4/13 [00:01<00:03,  2.26it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.48it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.67it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.72it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.90it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.99it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.01it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.29it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.90it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.84it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.89it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.98it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.03it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.95it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.00it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]100%|██████████| 13/13 [00:04<00:00,  3.25it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 94.8s
    uds: 0.1735
    em: 0.8890
    mia_loss: 0.9848

============================================================
[52/76] idkdpo_lr2e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.26s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.20it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.40it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.50it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.68it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.70it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.70it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.59it/s]
{'loss': 0.5179, 'grad_norm': 10.0, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5461, 'train_samples_per_second': 53.008, 'train_steps_per_second': 1.59, 'train_loss': 0.5144646068414053, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.33it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.19it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.51it/s]Mem eval:  31%|███       | 4/13 [00:02<00:04,  1.88it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.23it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.53it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  2.95it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.11it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.16it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.16it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.15it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.51it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.80it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.07it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.98it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.89it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.91it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.95it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.09it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.13it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.15it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.07it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.35it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.08it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.46it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.36it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.44it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.16it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.26it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.22it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.21it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.22it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.15it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.20it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.24it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.12it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.94it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.24it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.21it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.37it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.29it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.36it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.41it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.38it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.26it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.27it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.45it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.41it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.47it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.52it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.57it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.60it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.64it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.49it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.44it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.40it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.37it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.34it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.25it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.23it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.30it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.18it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.08it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.09it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.17it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.07it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.02it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.05it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.09it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.12it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.45it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.26it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:08,  1.35it/s]gen:  15%|█▌        | 2/13 [00:01<00:08,  1.24it/s]gen:  23%|██▎       | 3/13 [00:02<00:08,  1.15it/s]gen:  31%|███       | 4/13 [00:03<00:07,  1.18it/s]gen:  38%|███▊      | 5/13 [00:04<00:06,  1.20it/s]gen:  46%|████▌     | 6/13 [00:04<00:05,  1.23it/s]gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.20it/s]gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.24it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.25it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.20it/s]gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.26it/s]gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.20it/s]gen: 100%|██████████| 13/13 [00:10<00:00,  1.27it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:08,  1.41it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:09,  1.14it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.22it/s]jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.23it/s]jb_gen:  38%|███▊      | 5/13 [00:03<00:05,  1.35it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.39it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.37it/s]jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.28it/s]jb_gen:  69%|██████▉   | 9/13 [00:06<00:02,  1.38it/s]jb_gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.41it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.48it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.31it/s]jb_gen: 100%|██████████| 13/13 [00:09<00:00,  1.42it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.07it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.97it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.92it/s] 31%|███       | 4/13 [00:01<00:04,  2.19it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.43it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.63it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.88it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.97it/s] 77%|███████▋  | 10/13 [00:03<00:01,  3.00it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.96it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.93it/s]100%|██████████| 13/13 [00:04<00:00,  3.28it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.90it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.88it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.85it/s] 31%|███       | 4/13 [00:01<00:03,  2.84it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.89it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.98it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.03it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.95it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.01it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]100%|██████████| 13/13 [00:04<00:00,  3.25it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 94.6s
    uds: 0.1313
    em: 0.9081
    mia_loss: 0.9896

============================================================
[53/76] idkdpo_lr5e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.27s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.19it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.40it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.50it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.58it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.68it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.59it/s]
{'loss': 1.3559, 'grad_norm': 12.125, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5448, 'train_samples_per_second': 53.017, 'train_steps_per_second': 1.591, 'train_loss': 1.3256185054779053, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.27it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.15it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.50it/s]Mem eval:  31%|███       | 4/13 [00:02<00:04,  1.86it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.20it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.49it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:02,  2.64it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  2.89it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.03it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.09it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.09it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.08it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.44it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.75it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.07it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.90it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.92it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.95it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.09it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.13it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.14it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.06it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.35it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.08it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.46it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.36it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.44it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.16it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.25it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.22it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.20it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.20it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.14it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.20it/s]Mem eval (multi):  21%|██        | 13/63 [00:04<00:15,  3.24it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.12it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.93it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.95it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.24it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.21it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.36it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.45it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.28it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.35it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.40it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.37it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.25it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.27it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.34it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.44it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.40it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.46it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.52it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.57it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.60it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.64it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.50it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.45it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.40it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.37it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.34it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.22it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.31it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.20it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.09it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.10it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.02it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.05it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.10it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.12it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.44it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.26it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:11,  1.05it/s]gen:  15%|█▌        | 2/13 [00:01<00:09,  1.18it/s]gen:  23%|██▎       | 3/13 [00:02<00:09,  1.07it/s]gen:  31%|███       | 4/13 [00:03<00:07,  1.18it/s]gen:  38%|███▊      | 5/13 [00:04<00:06,  1.21it/s]gen:  46%|████▌     | 6/13 [00:05<00:05,  1.22it/s]gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.22it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.32it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.28it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.26it/s]gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.27it/s]gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.21it/s]gen: 100%|██████████| 13/13 [00:10<00:00,  1.22it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:10,  1.17it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:09,  1.17it/s]jb_gen:  23%|██▎       | 3/13 [00:04<00:16,  1.61s/it]jb_gen:  31%|███       | 4/13 [00:05<00:11,  1.29s/it]jb_gen:  38%|███▊      | 5/13 [00:05<00:08,  1.09s/it]jb_gen:  46%|████▌     | 6/13 [00:06<00:06,  1.05it/s]jb_gen:  54%|█████▍    | 7/13 [00:07<00:05,  1.09it/s]jb_gen:  62%|██████▏   | 8/13 [00:07<00:04,  1.23it/s]jb_gen:  69%|██████▉   | 9/13 [00:08<00:03,  1.25it/s]jb_gen:  77%|███████▋  | 10/13 [00:09<00:02,  1.25it/s]jb_gen:  85%|████████▍ | 11/13 [00:10<00:01,  1.24it/s]jb_gen:  92%|█████████▏| 12/13 [00:11<00:00,  1.23it/s]jb_gen: 100%|██████████| 13/13 [00:11<00:00,  1.24it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.05it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.95it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.91it/s] 31%|███       | 4/13 [00:01<00:04,  2.18it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.42it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.62it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.88it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.98it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.01it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.30it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.90it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.91it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.99it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.02it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]100%|██████████| 13/13 [00:04<00:00,  3.26it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 96.5s
    uds: 0.4227
    em: 0.7652
    mia_loss: 0.8705

============================================================
[54/76] idkdpo_lr5e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.27s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.19it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.40it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.50it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.59it/s]
{'loss': 1.184, 'grad_norm': 11.8125, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5408, 'train_samples_per_second': 53.045, 'train_steps_per_second': 1.591, 'train_loss': 1.1635775566101074, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.28it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.17it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.50it/s]Mem eval:  31%|███       | 4/13 [00:02<00:04,  1.87it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.21it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.50it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:02,  2.66it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  2.91it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.06it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.12it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.11it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.10it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.46it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.76it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.09it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.00it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.85it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.90it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.92it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.96it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.10it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.14it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.16it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.08it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.01it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.36it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.09it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.49it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.39it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.37it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.45it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.33it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.18it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.27it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.24it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.23it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.23it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.17it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.22it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.26it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.14it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.94it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.88it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.96it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.99it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.05it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.26it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.23it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.21it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.26it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.28it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.38it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.47it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.32it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:10,  3.37it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.42it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.39it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.27it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.28it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.36it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.46it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.42it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.48it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.53it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.59it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.61it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.66it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.51it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.46it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.42it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.39it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.36it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.28it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.26it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.22it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.33it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.34it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.32it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.21it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.10it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.11it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.19it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.09it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.04it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.06it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.11it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.13it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.46it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.28it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:08,  1.34it/s]gen:  15%|█▌        | 2/13 [00:01<00:08,  1.30it/s]gen:  23%|██▎       | 3/13 [00:02<00:08,  1.17it/s]gen:  31%|███       | 4/13 [00:03<00:07,  1.23it/s]gen:  38%|███▊      | 5/13 [00:04<00:06,  1.20it/s]gen:  46%|████▌     | 6/13 [00:04<00:05,  1.26it/s]gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.30it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.39it/s]gen:  69%|██████▉   | 9/13 [00:06<00:02,  1.38it/s]gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.30it/s]gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.28it/s]gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.19it/s]gen: 100%|██████████| 13/13 [00:10<00:00,  1.26it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.28it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.27it/s]jb_gen:  23%|██▎       | 3/13 [00:04<00:15,  1.57s/it]jb_gen:  31%|███       | 4/13 [00:04<00:11,  1.25s/it]jb_gen:  38%|███▊      | 5/13 [00:05<00:08,  1.06s/it]jb_gen:  46%|████▌     | 6/13 [00:06<00:06,  1.06it/s]jb_gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.15it/s]jb_gen:  62%|██████▏   | 8/13 [00:07<00:03,  1.29it/s]jb_gen:  69%|██████▉   | 9/13 [00:08<00:03,  1.31it/s]jb_gen:  77%|███████▋  | 10/13 [00:09<00:02,  1.25it/s]jb_gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.26it/s]jb_gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.25it/s]jb_gen: 100%|██████████| 13/13 [00:11<00:00,  1.36it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.05it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.95it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.91it/s] 31%|███       | 4/13 [00:01<00:04,  2.19it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.43it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.63it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.88it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.98it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.00it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.30it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.05it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.02it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]100%|██████████| 13/13 [00:04<00:00,  3.26it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 95.4s
    uds: 0.3625
    em: 0.7865
    mia_loss: 0.9159

============================================================
[55/76] idkdpo_lr5e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.26s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.20it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.40it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.50it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.59it/s]
{'loss': 0.9676, 'grad_norm': 11.0, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5448, 'train_samples_per_second': 53.017, 'train_steps_per_second': 1.59, 'train_loss': 0.9550298551718394, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.29it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.17it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.50it/s]Mem eval:  31%|███       | 4/13 [00:02<00:04,  1.86it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.20it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.50it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:02,  2.65it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  2.90it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.05it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.12it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.11it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.10it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.46it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.76it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.09it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.00it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.85it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.91it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.93it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.96it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.10it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.14it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.16it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.08it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.02it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.36it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.09it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.47it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.37it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.45it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.33it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.17it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.27it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.25it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.23it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.22it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.16it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.22it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.25it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.13it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.94it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.88it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.95it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.99it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.24it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.21it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.37it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.37it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.41it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.39it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.27it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.28it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.36it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.45it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.42it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.48it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.53it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.59it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.61it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.65it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.51it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.45it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.41it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.38it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.35it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.28it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.25it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.22it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.33it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.33it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.32it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.21it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.10it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.11it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.19it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.09it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.04it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.06it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.11it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.13it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.46it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.28it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:07,  1.56it/s]gen:  15%|█▌        | 2/13 [00:01<00:09,  1.15it/s]gen:  23%|██▎       | 3/13 [00:02<00:09,  1.10it/s]gen:  31%|███       | 4/13 [00:03<00:08,  1.12it/s]gen:  38%|███▊      | 5/13 [00:04<00:07,  1.12it/s]gen:  46%|████▌     | 6/13 [00:05<00:06,  1.14it/s]gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.21it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.31it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.18it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.17it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.15it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.17it/s]gen: 100%|██████████| 13/13 [00:10<00:00,  1.20it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:08,  1.42it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.27it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.16it/s]jb_gen:  31%|███       | 4/13 [00:03<00:08,  1.01it/s]jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.16it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.26it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:05,  1.19it/s]jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.29it/s]jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.25it/s]jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.27it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.25it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.17it/s]jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.28it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.07it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.97it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.92it/s] 31%|███       | 4/13 [00:01<00:04,  2.20it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.44it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.64it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.70it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.89it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.98it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.01it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.30it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.90it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.05it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.91it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.99it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.02it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]100%|██████████| 13/13 [00:04<00:00,  3.26it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 95.5s
    uds: 0.2967
    em: 0.8201
    mia_loss: 0.9504

============================================================
[56/76] idknll_lr1e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr1e-05_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.26s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.20it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.40it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.50it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.68it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.69it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.70it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.70it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.73it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.73it/s]100%|██████████| 12/12 [00:07<00:00,  1.59it/s]
{'loss': 0.2231, 'grad_norm': 9.125, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5473, 'train_samples_per_second': 52.999, 'train_steps_per_second': 1.59, 'train_loss': 0.22352541734774908, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.47it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.33it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.54it/s]Mem eval:  31%|███       | 4/13 [00:01<00:04,  1.92it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.29it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.59it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:02,  2.75it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  3.02it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.19it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.25it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.25it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.25it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.63it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.87it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.08it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.82it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.89it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.92it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.95it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.09it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.13it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.15it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.07it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.35it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.08it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.48it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.39it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.36it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.44it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.33it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.17it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.26it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.23it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.22it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.22it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.16it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.21it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.25it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.13it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.93it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.94it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.25it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.20it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.26it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.27it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.38it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.32it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.37it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.42it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.39it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.26it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.28it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.36it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.46it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.42it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.47it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.53it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.58it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.61it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.65it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.50it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.45it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.41it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.37it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.35it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.28it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.25it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.23it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.22it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.31it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.20it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.09it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.10it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.03it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.06it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.11it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.13it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.46it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.27it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:08,  1.40it/s]gen:  15%|█▌        | 2/13 [00:01<00:10,  1.09it/s]gen:  23%|██▎       | 3/13 [00:02<00:10,  1.04s/it]gen:  31%|███       | 4/13 [00:03<00:09,  1.00s/it]gen:  38%|███▊      | 5/13 [00:04<00:07,  1.04it/s]gen:  46%|████▌     | 6/13 [00:05<00:06,  1.06it/s]gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.06it/s]gen:  62%|██████▏   | 8/13 [00:07<00:04,  1.21it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.24it/s]gen:  77%|███████▋  | 10/13 [00:09<00:02,  1.14it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.21it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.15it/s]gen: 100%|██████████| 13/13 [00:11<00:00,  1.13it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.28it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.23it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.14it/s]jb_gen:  31%|███       | 4/13 [00:03<00:08,  1.09it/s]jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.21it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.26it/s]jb_gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.12it/s]jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.27it/s]jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.21it/s]jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.24it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.32it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.31it/s]jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.38it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.06it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.96it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.91it/s] 31%|███       | 4/13 [00:01<00:04,  2.19it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.43it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.63it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.88it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.98it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.01it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.30it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.90it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.02it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]100%|██████████| 13/13 [00:04<00:00,  3.26it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 95.7s
    uds: 0.0371
    em: 0.9670
    mia_loss: 0.9965

============================================================
[57/76] idknll_lr1e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr1e-05_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:14,  1.29s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.18it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.39it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.49it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.58it/s] 50%|█████     | 6/12 [00:04<00:03,  1.62it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.68it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.58it/s]
{'loss': 0.2195, 'grad_norm': 9.4375, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5722, 'train_samples_per_second': 52.825, 'train_steps_per_second': 1.585, 'train_loss': 0.21978260080019632, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.45it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.31it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.54it/s]Mem eval:  31%|███       | 4/13 [00:01<00:04,  1.92it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.29it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.59it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:02,  2.75it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  3.02it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.19it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.26it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.26it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.26it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.63it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.87it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.08it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.00it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.85it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.85it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.90it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.93it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.97it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.10it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.15it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.16it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.08it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.02it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.36it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.09it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.46it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.39it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.36it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.45it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.33it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.17it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.27it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.24it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.23it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.22it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.16it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.22it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.25it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.13it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.94it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.87it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.96it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.99it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.05it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.26it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.23it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.21it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.26it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.28it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.38it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.32it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:10,  3.37it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.42it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.39it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.27it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.28it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.36it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.46it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.43it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.47it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.53it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.59it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.61it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.65it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.50it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.45it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.41it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.37it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.35it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.25it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.23it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.22it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.33it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.32it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.20it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.09it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.10it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.09it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.04it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.07it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.12it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.13it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.46it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.28it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:08,  1.46it/s]gen:  15%|█▌        | 2/13 [00:01<00:08,  1.27it/s]gen:  23%|██▎       | 3/13 [00:02<00:10,  1.01s/it]gen:  31%|███       | 4/13 [00:03<00:08,  1.02it/s]gen:  38%|███▊      | 5/13 [00:04<00:07,  1.06it/s]gen:  46%|████▌     | 6/13 [00:05<00:05,  1.19it/s]gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.25it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.37it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.28it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.29it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.28it/s]gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.20it/s]gen: 100%|██████████| 13/13 [00:10<00:00,  1.29it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.29it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:09,  1.12it/s]jb_gen:  23%|██▎       | 3/13 [00:03<00:10,  1.08s/it]jb_gen:  31%|███       | 4/13 [00:03<00:09,  1.00s/it]jb_gen:  38%|███▊      | 5/13 [00:04<00:07,  1.07it/s]jb_gen:  46%|████▌     | 6/13 [00:05<00:06,  1.15it/s]jb_gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.09it/s]jb_gen:  62%|██████▏   | 8/13 [00:07<00:04,  1.24it/s]jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.20it/s]jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.24it/s]jb_gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.31it/s]jb_gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.30it/s]jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.39it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.07it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.97it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.92it/s] 31%|███       | 4/13 [00:01<00:04,  2.19it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.44it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.63it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.88it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.98it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.01it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.29it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.90it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.01it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]100%|██████████| 13/13 [00:04<00:00,  3.26it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 95.3s
    uds: 0.0354
    em: 0.9667
    mia_loss: 0.9964

============================================================
[58/76] idknll_lr1e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr1e-05_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.26s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.20it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.40it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.50it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.59it/s]
{'loss': 0.2167, 'grad_norm': 9.5, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5403, 'train_samples_per_second': 53.048, 'train_steps_per_second': 1.591, 'train_loss': 0.21737153828144073, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.45it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.32it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:06,  1.54it/s]Mem eval:  31%|███       | 4/13 [00:01<00:04,  1.92it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.28it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.59it/s]Mem eval:  54%|█████▍    | 7/13 [00:02<00:02,  2.75it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  3.01it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.18it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.25it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.25it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.25it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.63it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.87it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.08it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.00it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.90it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.93it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.96it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.09it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.14it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.15it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.07it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.01it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.36it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.08it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.49it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.40it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.36it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.44it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.17it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.26it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.23it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.22it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.22it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.16it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.21it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.25it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.13it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.93it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.95it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.99it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.25it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.23it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.20it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.26it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.28it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.38it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.47it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:10,  3.37it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.42it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.39it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.27it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.28it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.36it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.46it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.42it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.48it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.53it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.58it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.60it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.64it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.50it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.44it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.40it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.37it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.34it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.25it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.23it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.22it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.33it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.31it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.21it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.10it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.11it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.19it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.03it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.06it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.11it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.13it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.46it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.27it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:08,  1.39it/s]gen:  15%|█▌        | 2/13 [00:01<00:08,  1.30it/s]gen:  23%|██▎       | 3/13 [00:02<00:10,  1.02s/it]gen:  31%|███       | 4/13 [00:03<00:08,  1.01it/s]gen:  38%|███▊      | 5/13 [00:04<00:07,  1.05it/s]gen:  46%|████▌     | 6/13 [00:05<00:05,  1.18it/s]gen:  54%|█████▍    | 7/13 [00:06<00:04,  1.22it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.29it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.22it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.25it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.26it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.11it/s]gen: 100%|██████████| 13/13 [00:11<00:00,  1.19it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.28it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:09,  1.11it/s]jb_gen:  23%|██▎       | 3/13 [00:03<00:10,  1.10s/it]jb_gen:  31%|███       | 4/13 [00:03<00:08,  1.05it/s]jb_gen:  38%|███▊      | 5/13 [00:04<00:07,  1.10it/s]jb_gen:  46%|████▌     | 6/13 [00:05<00:05,  1.17it/s]jb_gen:  54%|█████▍    | 7/13 [00:06<00:04,  1.21it/s]jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.34it/s]jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.26it/s]jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.22it/s]jb_gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.30it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.29it/s]jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.38it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.04it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.96it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.92it/s] 31%|███       | 4/13 [00:01<00:04,  2.19it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.43it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.63it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.69it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.88it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.98it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.00it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.97it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.30it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.05it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.01it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]100%|██████████| 13/13 [00:04<00:00,  3.26it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 95.5s
    uds: 0.0355
    em: 0.9671
    mia_loss: 0.9964

============================================================
[59/76] idknll_lr2e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr2e-05_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.27s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.20it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.40it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.50it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.68it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.73it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.73it/s]100%|██████████| 12/12 [00:07<00:00,  1.59it/s]
{'loss': 0.2659, 'grad_norm': 10.125, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5472, 'train_samples_per_second': 52.999, 'train_steps_per_second': 1.59, 'train_loss': 0.2655493716398875, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.45it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.28it/s]Mem eval:  23%|██▎       | 3/13 [00:02<00:12,  1.26s/it]Mem eval:  31%|███       | 4/13 [00:03<00:08,  1.12it/s]Mem eval:  38%|███▊      | 5/13 [00:03<00:05,  1.48it/s]Mem eval:  46%|████▌     | 6/13 [00:03<00:03,  1.84it/s]Mem eval:  54%|█████▍    | 7/13 [00:04<00:02,  2.13it/s]Mem eval:  62%|██████▏   | 8/13 [00:04<00:02,  2.47it/s]Mem eval:  69%|██████▉   | 9/13 [00:04<00:01,  2.74it/s]Mem eval:  77%|███████▋  | 10/13 [00:05<00:01,  2.92it/s]Mem eval:  85%|████████▍ | 11/13 [00:05<00:00,  3.01it/s]Mem eval:  92%|█████████▏| 12/13 [00:05<00:00,  3.06it/s]Mem eval: 100%|██████████| 13/13 [00:05<00:00,  3.46it/s]Mem eval: 100%|██████████| 13/13 [00:05<00:00,  2.21it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.07it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.82it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.88it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.91it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.95it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.08it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:03<00:01,  3.13it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.14it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.07it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.35it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.07it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.46it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.36it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.44it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.16it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.26it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.23it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.22it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.22it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.16it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.21it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.24it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.12it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.85it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.94it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.25it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.20it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.27it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.37it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.35it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.40it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.37it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.25it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.26it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.44it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.41it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.46it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.51it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.57it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.59it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.64it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.49it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.45it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.40it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.36it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.33it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.25it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.23it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.30it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.18it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.08it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.09it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.17it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.03it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.05it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.10it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.12it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.45it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.26it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:08,  1.39it/s]gen:  15%|█▌        | 2/13 [00:01<00:08,  1.30it/s]gen:  23%|██▎       | 3/13 [00:02<00:08,  1.11it/s]gen:  31%|███       | 4/13 [00:03<00:07,  1.16it/s]gen:  38%|███▊      | 5/13 [00:04<00:06,  1.24it/s]gen:  46%|████▌     | 6/13 [00:04<00:05,  1.24it/s]gen:  54%|█████▍    | 7/13 [00:05<00:05,  1.16it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.29it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.28it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.29it/s]gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.32it/s]gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.25it/s]gen: 100%|██████████| 13/13 [00:10<00:00,  1.29it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.32it/s]jb_gen:  15%|█▌        | 2/13 [00:03<00:18,  1.69s/it]jb_gen:  23%|██▎       | 3/13 [00:04<00:14,  1.41s/it]jb_gen:  31%|███       | 4/13 [00:04<00:10,  1.16s/it]jb_gen:  38%|███▊      | 5/13 [00:05<00:08,  1.07s/it]jb_gen:  46%|████▌     | 6/13 [00:06<00:06,  1.09it/s]jb_gen:  54%|█████▍    | 7/13 [00:07<00:05,  1.14it/s]jb_gen:  62%|██████▏   | 8/13 [00:08<00:04,  1.19it/s]jb_gen:  69%|██████▉   | 9/13 [00:08<00:03,  1.16it/s]jb_gen:  77%|███████▋  | 10/13 [00:09<00:02,  1.14it/s]jb_gen:  85%|████████▍ | 11/13 [00:11<00:01,  1.02it/s]jb_gen:  92%|█████████▏| 12/13 [00:11<00:00,  1.05it/s]jb_gen: 100%|██████████| 13/13 [00:12<00:00,  1.16it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.07it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.97it/s] 23%|██▎       | 3/13 [00:01<00:05,  1.92it/s] 31%|███       | 4/13 [00:01<00:04,  2.19it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.43it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.63it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.68it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.87it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.97it/s] 77%|███████▋  | 10/13 [00:03<00:01,  3.00it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.96it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.94it/s]100%|██████████| 13/13 [00:04<00:00,  3.29it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.90it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.88it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.98it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.01it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]100%|██████████| 13/13 [00:04<00:00,  3.25it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 98.1s
    uds: 0.0585
    em: 0.9563
    mia_loss: 0.9961

============================================================
[60/76] idknll_lr2e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr2e-05_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.26s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.20it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.40it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.50it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.68it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.69it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.70it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.70it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.73it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.73it/s]100%|██████████| 12/12 [00:07<00:00,  1.59it/s]
{'loss': 0.2617, 'grad_norm': 10.8125, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5489, 'train_samples_per_second': 52.988, 'train_steps_per_second': 1.59, 'train_loss': 0.26138854026794434, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.41it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.27it/s]Mem eval:  23%|██▎       | 3/13 [00:01<00:07,  1.39it/s]Mem eval:  31%|███       | 4/13 [00:02<00:05,  1.77it/s]Mem eval:  38%|███▊      | 5/13 [00:02<00:03,  2.14it/s]Mem eval:  46%|████▌     | 6/13 [00:02<00:02,  2.46it/s]Mem eval:  54%|█████▍    | 7/13 [00:03<00:02,  2.65it/s]Mem eval:  62%|██████▏   | 8/13 [00:03<00:01,  2.93it/s]Mem eval:  69%|██████▉   | 9/13 [00:03<00:01,  3.11it/s]Mem eval:  77%|███████▋  | 10/13 [00:03<00:00,  3.19it/s]Mem eval:  85%|████████▍ | 11/13 [00:04<00:00,  3.21it/s]Mem eval:  92%|█████████▏| 12/13 [00:04<00:00,  3.20it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  3.58it/s]Mem eval: 100%|██████████| 13/13 [00:04<00:00,  2.76it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.07it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.89it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.91it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.95it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.08it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:03<00:01,  3.12it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.14it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.07it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.35it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.07it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.47it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.35it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.42it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.30it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.14it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.24it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.22it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.21it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.21it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.15it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.20it/s]Mem eval (multi):  21%|██        | 13/63 [00:04<00:15,  3.23it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.12it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.94it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.24it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.21it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.24it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.36it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.45it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.28it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.35it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.41it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.38it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.26it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.27it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.44it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.41it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.47it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.52it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.57it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.60it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.64it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.50it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.44it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.40it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.36it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:14<00:05,  3.33it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.26it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.22it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.30it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.19it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.08it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.09it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.17it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.07it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.02it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.05it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.10it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.11it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.44it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.26it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:09,  1.21it/s]gen:  15%|█▌        | 2/13 [00:01<00:09,  1.18it/s]gen:  23%|██▎       | 3/13 [00:02<00:08,  1.12it/s]gen:  31%|███       | 4/13 [00:03<00:08,  1.09it/s]gen:  38%|███▊      | 5/13 [00:04<00:07,  1.10it/s]gen:  46%|████▌     | 6/13 [00:05<00:06,  1.15it/s]gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.10it/s]gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.23it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.16it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.16it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.20it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.15it/s]gen: 100%|██████████| 13/13 [00:11<00:00,  1.21it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.29it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.26it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:09,  1.11it/s]jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.16it/s]jb_gen:  38%|███▊      | 5/13 [00:04<00:07,  1.14it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.25it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:05,  1.16it/s]jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.26it/s]jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.19it/s]jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.19it/s]jb_gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.19it/s]jb_gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.20it/s]jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.29it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.06it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.96it/s] 23%|██▎       | 3/13 [00:01<00:04,  2.38it/s] 31%|███       | 4/13 [00:01<00:03,  2.53it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.69it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.82it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.82it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.97it/s] 69%|██████▉   | 9/13 [00:03<00:01,  3.04it/s] 77%|███████▋  | 10/13 [00:03<00:00,  3.05it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.00it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.96it/s]100%|██████████| 13/13 [00:04<00:00,  3.31it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.90it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.88it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.85it/s] 31%|███       | 4/13 [00:01<00:03,  2.84it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.89it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.98it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.95it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.89it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.97it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.01it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]100%|██████████| 13/13 [00:04<00:00,  3.25it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 96.1s
    uds: 0.0581
    em: 0.9556
    mia_loss: 0.9959

============================================================
[61/76] idknll_lr2e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr2e-05_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.25s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.21it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.41it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.51it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.64it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.69it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.60it/s]
{'loss': 0.2499, 'grad_norm': 10.5625, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5131, 'train_samples_per_second': 53.241, 'train_steps_per_second': 1.597, 'train_loss': 0.24940694123506546, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.44it/s]Mem eval:  15%|█▌        | 2/13 [00:00<00:03,  3.30it/s]Mem eval:  23%|██▎       | 3/13 [00:03<00:16,  1.69s/it]Mem eval:  31%|███       | 4/13 [00:04<00:10,  1.16s/it]Mem eval:  38%|███▊      | 5/13 [00:04<00:06,  1.18it/s]Mem eval:  46%|████▌     | 6/13 [00:04<00:04,  1.52it/s]Mem eval:  54%|█████▍    | 7/13 [00:05<00:03,  1.83it/s]Mem eval:  62%|██████▏   | 8/13 [00:05<00:02,  2.19it/s]Mem eval:  69%|██████▉   | 9/13 [00:05<00:01,  2.49it/s]Mem eval:  77%|███████▋  | 10/13 [00:06<00:01,  2.72it/s]Mem eval:  85%|████████▍ | 11/13 [00:06<00:00,  2.86it/s]Mem eval:  92%|█████████▏| 12/13 [00:06<00:00,  2.96it/s]Mem eval: 100%|██████████| 13/13 [00:06<00:00,  3.37it/s]Mem eval: 100%|██████████| 13/13 [00:06<00:00,  1.90it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.08it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.99it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.89it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.92it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.95it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.08it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.12it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.14it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.06it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.34it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.07it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.48it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.35it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.43it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.30it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.15it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.25it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.22it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.21it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.21it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.15it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.20it/s]Mem eval (multi):  21%|██        | 13/63 [00:04<00:15,  3.24it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.12it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.92it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.86it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.94it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.24it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.20it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.26it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.37it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.45it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.29it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.35it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.39it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.37it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.25it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.26it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.44it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.41it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.46it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.52it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.57it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.59it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.64it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:06,  3.49it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.44it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.39it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.36it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.33it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.22it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.31it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.30it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.19it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.08it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.09it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.03it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.05it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.10it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.12it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.45it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.26it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:10,  1.18it/s]gen:  15%|█▌        | 2/13 [00:01<00:09,  1.13it/s]gen:  23%|██▎       | 3/13 [00:02<00:09,  1.08it/s]gen:  31%|███       | 4/13 [00:03<00:07,  1.13it/s]gen:  38%|███▊      | 5/13 [00:04<00:07,  1.10it/s]gen:  46%|████▌     | 6/13 [00:05<00:05,  1.24it/s]gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.21it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.25it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.17it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.16it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.21it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.11it/s]gen: 100%|██████████| 13/13 [00:11<00:00,  1.22it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:09,  1.33it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.27it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.16it/s]jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.21it/s]jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.20it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.30it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:05,  1.20it/s]jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.31it/s]jb_gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.23it/s]jb_gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.25it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.20it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.22it/s]jb_gen: 100%|██████████| 13/13 [00:10<00:00,  1.29it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.06it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.96it/s] 23%|██▎       | 3/13 [00:01<00:06,  1.66it/s] 31%|███       | 4/13 [00:01<00:04,  1.97it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.25it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.49it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.59it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.80it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.92it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.97it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.94it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.92it/s]100%|██████████| 13/13 [00:04<00:00,  3.28it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.91it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.05it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.91it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.99it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.02it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.02it/s]100%|██████████| 13/13 [00:04<00:00,  3.26it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 97.8s
    uds: 0.0543
    em: 0.9597
    mia_loss: 0.9959

============================================================
[62/76] idknll_lr5e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr5e-05_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:14,  1.29s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.18it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.39it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.49it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.58it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.59it/s]
{'loss': 0.5316, 'grad_norm': 11.3125, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5561, 'train_samples_per_second': 52.938, 'train_steps_per_second': 1.588, 'train_loss': 0.5252005805571874, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.34it/s]Mem eval:  15%|█▌        | 2/13 [00:01<00:06,  1.59it/s]Mem eval:  23%|██▎       | 3/13 [00:05<00:23,  2.38s/it]Mem eval:  31%|███       | 4/13 [00:06<00:14,  1.59s/it]Mem eval:  38%|███▊      | 5/13 [00:06<00:09,  1.13s/it]Mem eval:  46%|████▌     | 6/13 [00:06<00:05,  1.18it/s]Mem eval:  54%|█████▍    | 7/13 [00:06<00:04,  1.48it/s]Mem eval:  62%|██████▏   | 8/13 [00:07<00:02,  1.83it/s]Mem eval:  69%|██████▉   | 9/13 [00:07<00:01,  2.15it/s]Mem eval:  77%|███████▋  | 10/13 [00:07<00:01,  2.41it/s]Mem eval:  85%|████████▍ | 11/13 [00:08<00:00,  2.59it/s]Mem eval:  92%|█████████▏| 12/13 [00:08<00:00,  2.73it/s]Mem eval: 100%|██████████| 13/13 [00:08<00:00,  3.14it/s]Mem eval: 100%|██████████| 13/13 [00:08<00:00,  1.50it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.06it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  2.98it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.83it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.89it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.91it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.95it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.09it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:03<00:01,  3.12it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.14it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.07it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:04<00:00,  3.00it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.35it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.07it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.46it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:18,  3.38it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.36it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.44it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.15it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.25it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:17,  3.22it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.21it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.22it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.15it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.21it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.24it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.12it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.93it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.85it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.94it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:15,  2.98it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.04it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.24it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:13,  3.22it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.19it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.25it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.26it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.37it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.46it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.30it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:09<00:10,  3.36it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.40it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.37it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.26it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.27it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.35it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.45it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.41it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.47it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.52it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.58it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.60it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.65it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.51it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.45it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.38it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.35it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.33it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.27it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.23it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.21it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.32it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.31it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.20it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.10it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.10it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.18it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.03it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.05it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.10it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:19<00:00,  3.12it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.45it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.27it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:10,  1.15it/s]gen:  15%|█▌        | 2/13 [00:01<00:09,  1.19it/s]gen:  23%|██▎       | 3/13 [00:02<00:09,  1.06it/s]gen:  31%|███       | 4/13 [00:03<00:08,  1.09it/s]gen:  38%|███▊      | 5/13 [00:04<00:06,  1.21it/s]gen:  46%|████▌     | 6/13 [00:05<00:06,  1.15it/s]gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.21it/s]gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.22it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.25it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.30it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.21it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.14it/s]gen: 100%|██████████| 13/13 [00:10<00:00,  1.23it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:08,  1.45it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.30it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:07,  1.28it/s]jb_gen:  31%|███       | 4/13 [00:03<00:06,  1.30it/s]jb_gen:  38%|███▊      | 5/13 [00:03<00:05,  1.40it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.38it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.34it/s]jb_gen:  62%|██████▏   | 8/13 [00:05<00:03,  1.42it/s]jb_gen:  69%|██████▉   | 9/13 [00:06<00:03,  1.32it/s]jb_gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.33it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.34it/s]jb_gen:  92%|█████████▏| 12/13 [00:08<00:00,  1.32it/s]jb_gen: 100%|██████████| 13/13 [00:09<00:00,  1.36it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.98it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.92it/s] 23%|██▎       | 3/13 [00:02<00:08,  1.19it/s] 31%|███       | 4/13 [00:02<00:05,  1.51it/s] 38%|███▊      | 5/13 [00:02<00:04,  1.85it/s] 46%|████▌     | 6/13 [00:03<00:03,  2.14it/s] 54%|█████▍    | 7/13 [00:03<00:02,  2.32it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.58it/s] 69%|██████▉   | 9/13 [00:04<00:01,  2.75it/s] 77%|███████▋  | 10/13 [00:04<00:01,  2.84it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.85it/s] 92%|█████████▏| 12/13 [00:05<00:00,  2.86it/s]100%|██████████| 13/13 [00:05<00:00,  3.22it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.89it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.88it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.84it/s] 31%|███       | 4/13 [00:01<00:03,  2.83it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.88it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.97it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.01it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.92it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.87it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.94it/s] 85%|████████▍ | 11/13 [00:03<00:00,  2.96it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.97it/s]100%|██████████| 13/13 [00:04<00:00,  3.22it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 101.6s
    uds: 0.1283
    em: 0.9069
    mia_loss: 0.9906

============================================================
[63/76] idknll_lr5e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr5e-05_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.26s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.20it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.40it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.50it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.59it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.69it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.70it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.75it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.59it/s]
{'loss': 0.5322, 'grad_norm': 11.125, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5252, 'train_samples_per_second': 53.155, 'train_steps_per_second': 1.595, 'train_loss': 0.5259168396393458, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.34it/s]Mem eval:  15%|█▌        | 2/13 [00:01<00:06,  1.76it/s]Mem eval:  23%|██▎       | 3/13 [00:06<00:26,  2.60s/it]Mem eval:  31%|███       | 4/13 [00:06<00:15,  1.72s/it]Mem eval:  38%|███▊      | 5/13 [00:06<00:09,  1.21s/it]Mem eval:  46%|████▌     | 6/13 [00:07<00:06,  1.12it/s]Mem eval:  54%|█████▍    | 7/13 [00:07<00:04,  1.41it/s]Mem eval:  62%|██████▏   | 8/13 [00:07<00:02,  1.76it/s]Mem eval:  69%|██████▉   | 9/13 [00:07<00:01,  2.09it/s]Mem eval:  77%|███████▋  | 10/13 [00:08<00:01,  2.36it/s]Mem eval:  85%|████████▍ | 11/13 [00:08<00:00,  2.56it/s]Mem eval:  92%|█████████▏| 12/13 [00:08<00:00,  2.71it/s]Mem eval: 100%|██████████| 13/13 [00:09<00:00,  3.13it/s]Mem eval: 100%|██████████| 13/13 [00:09<00:00,  1.44it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.09it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.01it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.85it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.90it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.92it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.96it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.10it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.15it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.16it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.07it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.01it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.36it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.09it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.47it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.39it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.37it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.44it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:17,  3.17it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.27it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.24it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.22it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.23it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.17it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.22it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.26it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.14it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.94it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.88it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.97it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.01it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.06it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.27it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.24it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.21it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.27it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.28it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.39it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.47it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.32it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:10,  3.38it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.40it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.28it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.28it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.36it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.46it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.43it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.49it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.54it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.59it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.62it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.66it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.52it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:13<00:05,  3.46it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.41it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.38it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.35it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.29it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.26it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.23it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.33it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.33it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.32it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.21it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.10it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.11it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.19it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.09it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.04it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.07it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.12it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.14it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.46it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.28it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:09,  1.26it/s]gen:  15%|█▌        | 2/13 [00:01<00:08,  1.23it/s]gen:  23%|██▎       | 3/13 [00:02<00:09,  1.10it/s]gen:  31%|███       | 4/13 [00:03<00:07,  1.18it/s]gen:  38%|███▊      | 5/13 [00:04<00:06,  1.26it/s]gen:  46%|████▌     | 6/13 [00:05<00:05,  1.18it/s]gen:  54%|█████▍    | 7/13 [00:06<00:05,  1.04it/s]gen:  62%|██████▏   | 8/13 [00:06<00:04,  1.17it/s]gen:  69%|██████▉   | 9/13 [00:07<00:03,  1.19it/s]gen:  77%|███████▋  | 10/13 [00:08<00:02,  1.22it/s]gen:  85%|████████▍ | 11/13 [00:09<00:01,  1.18it/s]gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.12it/s]gen: 100%|██████████| 13/13 [00:11<00:00,  1.14it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:08,  1.39it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.23it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.15it/s]jb_gen:  31%|███       | 4/13 [00:03<00:07,  1.14it/s]jb_gen:  38%|███▊      | 5/13 [00:04<00:06,  1.29it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.32it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.33it/s]jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.44it/s]jb_gen:  69%|██████▉   | 9/13 [00:06<00:02,  1.45it/s]jb_gen:  77%|███████▋  | 10/13 [00:09<00:03,  1.24s/it]jb_gen:  85%|████████▍ | 11/13 [00:09<00:02,  1.07s/it]jb_gen:  92%|█████████▏| 12/13 [00:10<00:00,  1.01it/s]jb_gen: 100%|██████████| 13/13 [00:11<00:00,  1.12it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.05it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.96it/s] 23%|██▎       | 3/13 [00:01<00:06,  1.58it/s] 31%|███       | 4/13 [00:02<00:04,  1.91it/s] 38%|███▊      | 5/13 [00:02<00:03,  2.20it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.45it/s] 54%|█████▍    | 7/13 [00:03<00:02,  2.56it/s] 62%|██████▏   | 8/13 [00:03<00:01,  2.77it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.95it/s] 85%|████████▍ | 11/13 [00:04<00:00,  2.93it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.92it/s]100%|██████████| 13/13 [00:04<00:00,  3.28it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.90it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.87it/s] 31%|███       | 4/13 [00:01<00:03,  2.85it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.99it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.04it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.96it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.90it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.98it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.02it/s] 92%|█████████▏| 12/13 [00:04<00:00,  3.01it/s]100%|██████████| 13/13 [00:04<00:00,  3.26it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 101.6s
    uds: 0.1399
    em: 0.9058
    mia_loss: 0.9905

============================================================
[64/76] idknll_lr5e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr5e-05_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:13,  1.27s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.19it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.40it/s] 33%|███▎      | 4/12 [00:02<00:05,  1.50it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.58it/s] 50%|█████     | 6/12 [00:04<00:03,  1.63it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.68it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.68it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.69it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.70it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.70it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.73it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.73it/s]100%|██████████| 12/12 [00:07<00:00,  1.59it/s]
{'loss': 0.5177, 'grad_norm': 11.0625, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.8}
{'train_runtime': 7.5581, 'train_samples_per_second': 52.924, 'train_steps_per_second': 1.588, 'train_loss': 0.5119970887899399, 'epoch': 0.96}
  Loading finetuned model...
  Computing metrics (after relearn)...
Mem eval:   0%|          | 0/13 [00:00<?, ?it/s]Mem eval:   8%|▊         | 1/13 [00:00<00:03,  3.33it/s]Mem eval:  15%|█▌        | 2/13 [00:01<00:06,  1.66it/s]Mem eval:  23%|██▎       | 3/13 [00:09<00:39,  3.95s/it]Mem eval:  31%|███       | 4/13 [00:09<00:23,  2.56s/it]Mem eval:  38%|███▊      | 5/13 [00:09<00:13,  1.75s/it]Mem eval:  46%|████▌     | 6/13 [00:10<00:08,  1.26s/it]Mem eval:  54%|█████▍    | 7/13 [00:10<00:05,  1.05it/s]Mem eval:  62%|██████▏   | 8/13 [00:10<00:03,  1.36it/s]Mem eval:  69%|██████▉   | 9/13 [00:10<00:02,  1.68it/s]Mem eval:  77%|███████▋  | 10/13 [00:11<00:01,  1.98it/s]Mem eval:  85%|████████▍ | 11/13 [00:11<00:00,  2.23it/s]Mem eval:  92%|█████████▏| 12/13 [00:11<00:00,  2.44it/s]Mem eval: 100%|██████████| 13/13 [00:12<00:00,  2.85it/s]Mem eval: 100%|██████████| 13/13 [00:12<00:00,  1.07it/s]
Mem eval (multi):   0%|          | 0/13 [00:00<?, ?it/s]Mem eval (multi):   8%|▊         | 1/13 [00:00<00:03,  3.08it/s]Mem eval (multi):  15%|█▌        | 2/13 [00:00<00:03,  3.00it/s]Mem eval (multi):  23%|██▎       | 3/13 [00:01<00:03,  2.84it/s]Mem eval (multi):  31%|███       | 4/13 [00:01<00:03,  2.85it/s]Mem eval (multi):  38%|███▊      | 5/13 [00:01<00:02,  2.91it/s]Mem eval (multi):  46%|████▌     | 6/13 [00:02<00:02,  2.93it/s]Mem eval (multi):  54%|█████▍    | 7/13 [00:02<00:02,  2.97it/s]Mem eval (multi):  62%|██████▏   | 8/13 [00:02<00:01,  3.11it/s]Mem eval (multi):  69%|██████▉   | 9/13 [00:02<00:01,  3.15it/s]Mem eval (multi):  77%|███████▋  | 10/13 [00:03<00:00,  3.16it/s]Mem eval (multi):  85%|████████▍ | 11/13 [00:03<00:00,  3.09it/s]Mem eval (multi):  92%|█████████▏| 12/13 [00:03<00:00,  3.02it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.37it/s]Mem eval (multi): 100%|██████████| 13/13 [00:04<00:00,  3.09it/s]
Mem eval (multi):   0%|          | 0/63 [00:00<?, ?it/s]Mem eval (multi):   2%|▏         | 1/63 [00:00<00:17,  3.47it/s]Mem eval (multi):   3%|▎         | 2/63 [00:00<00:17,  3.39it/s]Mem eval (multi):   5%|▍         | 3/63 [00:00<00:17,  3.37it/s]Mem eval (multi):   6%|▋         | 4/63 [00:01<00:17,  3.44it/s]Mem eval (multi):   8%|▊         | 5/63 [00:01<00:17,  3.32it/s]Mem eval (multi):  10%|▉         | 6/63 [00:01<00:18,  3.17it/s]Mem eval (multi):  11%|█         | 7/63 [00:02<00:17,  3.27it/s]Mem eval (multi):  13%|█▎        | 8/63 [00:02<00:16,  3.25it/s]Mem eval (multi):  14%|█▍        | 9/63 [00:02<00:16,  3.23it/s]Mem eval (multi):  16%|█▌        | 10/63 [00:03<00:16,  3.24it/s]Mem eval (multi):  17%|█▋        | 11/63 [00:03<00:16,  3.17it/s]Mem eval (multi):  19%|█▉        | 12/63 [00:03<00:15,  3.23it/s]Mem eval (multi):  21%|██        | 13/63 [00:03<00:15,  3.26it/s]Mem eval (multi):  22%|██▏       | 14/63 [00:04<00:15,  3.15it/s]Mem eval (multi):  24%|██▍       | 15/63 [00:04<00:16,  2.95it/s]Mem eval (multi):  25%|██▌       | 16/63 [00:05<00:16,  2.88it/s]Mem eval (multi):  27%|██▋       | 17/63 [00:05<00:15,  2.97it/s]Mem eval (multi):  29%|██▊       | 18/63 [00:05<00:14,  3.00it/s]Mem eval (multi):  30%|███       | 19/63 [00:06<00:14,  3.06it/s]Mem eval (multi):  32%|███▏      | 20/63 [00:06<00:13,  3.27it/s]Mem eval (multi):  33%|███▎      | 21/63 [00:06<00:12,  3.24it/s]Mem eval (multi):  35%|███▍      | 22/63 [00:06<00:12,  3.22it/s]Mem eval (multi):  37%|███▋      | 23/63 [00:07<00:12,  3.27it/s]Mem eval (multi):  38%|███▊      | 24/63 [00:07<00:11,  3.28it/s]Mem eval (multi):  40%|███▉      | 25/63 [00:07<00:11,  3.39it/s]Mem eval (multi):  41%|████▏     | 26/63 [00:08<00:10,  3.47it/s]Mem eval (multi):  43%|████▎     | 27/63 [00:08<00:10,  3.31it/s]Mem eval (multi):  44%|████▍     | 28/63 [00:08<00:10,  3.32it/s]Mem eval (multi):  46%|████▌     | 29/63 [00:08<00:10,  3.38it/s]Mem eval (multi):  48%|████▊     | 30/63 [00:09<00:09,  3.43it/s]Mem eval (multi):  49%|████▉     | 31/63 [00:09<00:09,  3.40it/s]Mem eval (multi):  51%|█████     | 32/63 [00:09<00:09,  3.28it/s]Mem eval (multi):  52%|█████▏    | 33/63 [00:10<00:09,  3.29it/s]Mem eval (multi):  54%|█████▍    | 34/63 [00:10<00:08,  3.36it/s]Mem eval (multi):  56%|█████▌    | 35/63 [00:10<00:08,  3.46it/s]Mem eval (multi):  57%|█████▋    | 36/63 [00:11<00:07,  3.42it/s]Mem eval (multi):  59%|█████▊    | 37/63 [00:11<00:07,  3.48it/s]Mem eval (multi):  60%|██████    | 38/63 [00:11<00:07,  3.54it/s]Mem eval (multi):  62%|██████▏   | 39/63 [00:11<00:06,  3.60it/s]Mem eval (multi):  63%|██████▎   | 40/63 [00:12<00:06,  3.62it/s]Mem eval (multi):  65%|██████▌   | 41/63 [00:12<00:06,  3.66it/s]Mem eval (multi):  67%|██████▋   | 42/63 [00:12<00:05,  3.51it/s]Mem eval (multi):  68%|██████▊   | 43/63 [00:12<00:05,  3.46it/s]Mem eval (multi):  70%|██████▉   | 44/63 [00:13<00:05,  3.42it/s]Mem eval (multi):  71%|███████▏  | 45/63 [00:13<00:05,  3.38it/s]Mem eval (multi):  73%|███████▎  | 46/63 [00:13<00:05,  3.36it/s]Mem eval (multi):  75%|███████▍  | 47/63 [00:14<00:04,  3.29it/s]Mem eval (multi):  76%|███████▌  | 48/63 [00:14<00:04,  3.26it/s]Mem eval (multi):  78%|███████▊  | 49/63 [00:14<00:04,  3.24it/s]Mem eval (multi):  79%|███████▉  | 50/63 [00:15<00:04,  3.23it/s]Mem eval (multi):  81%|████████  | 51/63 [00:15<00:03,  3.33it/s]Mem eval (multi):  83%|████████▎ | 52/63 [00:15<00:03,  3.33it/s]Mem eval (multi):  84%|████████▍ | 53/63 [00:16<00:03,  3.32it/s]Mem eval (multi):  86%|████████▌ | 54/63 [00:16<00:02,  3.21it/s]Mem eval (multi):  87%|████████▋ | 55/63 [00:16<00:02,  3.09it/s]Mem eval (multi):  89%|████████▉ | 56/63 [00:17<00:02,  3.10it/s]Mem eval (multi):  90%|█████████ | 57/63 [00:17<00:01,  3.19it/s]Mem eval (multi):  92%|█████████▏| 58/63 [00:17<00:01,  3.08it/s]Mem eval (multi):  94%|█████████▎| 59/63 [00:18<00:01,  3.04it/s]Mem eval (multi):  95%|█████████▌| 60/63 [00:18<00:00,  3.07it/s]Mem eval (multi):  97%|█████████▋| 61/63 [00:18<00:00,  3.12it/s]Mem eval (multi):  98%|█████████▊| 62/63 [00:18<00:00,  3.14it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.47it/s]Mem eval (multi): 100%|██████████| 63/63 [00:19<00:00,  3.28it/s]
gen:   0%|          | 0/13 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:   8%|▊         | 1/13 [00:00<00:08,  1.38it/s]gen:  15%|█▌        | 2/13 [00:01<00:08,  1.32it/s]gen:  23%|██▎       | 3/13 [00:02<00:08,  1.24it/s]gen:  31%|███       | 4/13 [00:03<00:07,  1.28it/s]gen:  38%|███▊      | 5/13 [00:03<00:05,  1.34it/s]gen:  46%|████▌     | 6/13 [00:04<00:05,  1.36it/s]gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.25it/s]gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.38it/s]gen:  69%|██████▉   | 9/13 [00:06<00:03,  1.33it/s]gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.25it/s]gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.23it/s]gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.18it/s]gen: 100%|██████████| 13/13 [00:10<00:00,  1.19it/s]                                                    jb_gen:   0%|          | 0/13 [00:00<?, ?it/s]jb_gen:   8%|▊         | 1/13 [00:00<00:08,  1.48it/s]jb_gen:  15%|█▌        | 2/13 [00:01<00:08,  1.30it/s]jb_gen:  23%|██▎       | 3/13 [00:02<00:08,  1.24it/s]jb_gen:  31%|███       | 4/13 [00:03<00:06,  1.29it/s]jb_gen:  38%|███▊      | 5/13 [00:03<00:05,  1.34it/s]jb_gen:  46%|████▌     | 6/13 [00:04<00:05,  1.34it/s]jb_gen:  54%|█████▍    | 7/13 [00:05<00:04,  1.24it/s]jb_gen:  62%|██████▏   | 8/13 [00:06<00:03,  1.37it/s]jb_gen:  69%|██████▉   | 9/13 [00:06<00:02,  1.42it/s]jb_gen:  77%|███████▋  | 10/13 [00:07<00:02,  1.44it/s]jb_gen:  85%|████████▍ | 11/13 [00:08<00:01,  1.25it/s]jb_gen:  92%|█████████▏| 12/13 [00:09<00:00,  1.30it/s]jb_gen: 100%|██████████| 13/13 [00:09<00:00,  1.35it/s]                                                         0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.98it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.91it/s] 23%|██▎       | 3/13 [00:03<00:14,  1.41s/it] 31%|███       | 4/13 [00:03<00:09,  1.03s/it] 38%|███▊      | 5/13 [00:04<00:06,  1.27it/s] 46%|████▌     | 6/13 [00:04<00:04,  1.58it/s] 54%|█████▍    | 7/13 [00:04<00:03,  1.83it/s] 62%|██████▏   | 8/13 [00:05<00:02,  2.13it/s] 69%|██████▉   | 9/13 [00:05<00:01,  2.36it/s] 77%|███████▋  | 10/13 [00:05<00:01,  2.52it/s] 85%|████████▍ | 11/13 [00:06<00:00,  2.61it/s] 92%|█████████▏| 12/13 [00:06<00:00,  2.68it/s]100%|██████████| 13/13 [00:06<00:00,  3.05it/s]                                                 0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:04,  2.83it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.84it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.82it/s] 31%|███       | 4/13 [00:01<00:03,  2.81it/s] 38%|███▊      | 5/13 [00:01<00:02,  2.86it/s] 46%|████▌     | 6/13 [00:02<00:02,  2.95it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.01it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.93it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.87it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.95it/s] 85%|████████▍ | 11/13 [00:03<00:00,  2.99it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.98it/s]100%|██████████| 13/13 [00:04<00:00,  3.22it/s]                                               WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  Done in 107.4s
    uds: 0.1362
    em: 0.9078
    mia_loss: 0.9908

============================================================
[65/76] idknll_lr1e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr1e-05_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading model...
  Finetuning on forget10...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:14,  1.33s/it] 17%|█▋        | 2/12 [00:01<00:08,  1.12it/s] 25%|██▌       | 3/12 [00:02<00:06,  1.34it/s] 33%|███▎      | 4/12 [00:03<00:05,  1.46it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.56it/s] 50%|█████     | 6/12 [00:04<00:03,  1.61it/s] 58%|█████▊    | 7/12 [00:04<00:02,  1.67it/s] 67%|██████▋   | 8/12 [00:05<00:02,  1.68it/s] 75%|███████▌  | 9/12 [00:05<00:01,  1.69it/s] 83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s]                                                83%|████████▎ | 10/12 [00:06<00:01,  1.71it/s] 92%|█████████▏| 11/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.74it/s]                                               100%|██████████| 12/12 [00:07<00:00,  1.74it/s]100%|██████████| 12/12 [00:07<00:00,  1.57it/s]
