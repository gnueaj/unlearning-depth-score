======================================================================
Robustness Meta-Evaluation: QUANT
======================================================================
GPU: 0
Models: 151 (1 retain + 150 unlearn)
Metrics: em, es, prob, paraprob, truth_ratio, rouge, para_rouge, jailbreak_rouge, mia_loss, mia_zlib, mia_min_k, mia_min_kpp, uds
Output: runs/meta_eval/robustness/quant
Clear cache: False

Loading tokenizer and full model...
UDS data: 367 valid examples
Loading S1 cache from runs/meta_eval/s1_cache_sdpa.json...
Resumed from runs/meta_eval/robustness/quant/results.json: 76 entries
Processing models [76:151] (75 models)

============================================================
[1/75] npo_lr2e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha1_epoch5
============================================================
  [Cache] Loaded 151 models from runs/method_eval/metrics_before.json
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.67it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.81it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.87it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.86it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.30it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.00it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.65it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.70it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.81it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.78it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.20it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.92it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.89it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.84it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.71it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.86it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  1.98it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.96it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.92it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.94it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.03it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.11it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.03it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.95it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.98it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.89it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.80it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.16it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.92it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.51s/it]gen:  29%|██▊       | 2/7 [00:03<00:08,  1.62s/it]gen:  43%|████▎     | 3/7 [00:04<00:05,  1.47s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.49s/it]gen:  71%|███████▏  | 5/7 [00:07<00:03,  1.57s/it]gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.60s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.65s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.80s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.89s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.76s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.66s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.63s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.68s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.80s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.52it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.63it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:03<00:00,  1.96it/s]                                               Done in 79.7s
    uds: 0.6520
    em: 0.5935
    mia_loss: 0.3887

============================================================
[2/75] npo_lr2e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.76it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.73it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.73it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.67it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.72s/it]gen:  29%|██▊       | 2/7 [00:03<00:08,  1.69s/it]gen:  43%|████▎     | 3/7 [00:04<00:05,  1.49s/it]gen:  57%|█████▋    | 4/7 [00:06<00:05,  1.78s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.65s/it]gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.62s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.50s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.85s/it]jb_gen:  29%|██▊       | 2/7 [00:07<00:20,  4.16s/it]jb_gen:  43%|████▎     | 3/7 [00:09<00:11,  2.94s/it]jb_gen:  57%|█████▋    | 4/7 [00:10<00:06,  2.29s/it]jb_gen:  71%|███████▏  | 5/7 [00:16<00:06,  3.50s/it]jb_gen:  86%|████████▌ | 6/7 [00:21<00:04,  4.25s/it]jb_gen: 100%|██████████| 7/7 [00:25<00:00,  3.94s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.48it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.59it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.63it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 93.9s
    uds: 0.6857
    em: 0.6079
    mia_loss: 0.4585

============================================================
[3/75] npo_lr2e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.68it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.06it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.79it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.83it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.96it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.74it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.78it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.16it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.58s/it]gen:  29%|██▊       | 2/7 [00:03<00:08,  1.73s/it]gen:  43%|████▎     | 3/7 [00:04<00:06,  1.57s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.57s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.65s/it]gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.65s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.57s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.71s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.32s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.91s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.72s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.78s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.71s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.53s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]100%|██████████| 7/7 [00:04<00:00,  2.00it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.59it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 81.5s
    uds: 0.7316
    em: 0.6348
    mia_loss: 0.6528

============================================================
[4/75] npo_lr5e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.62it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.89it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.77it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.80it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.71it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.78it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.82it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.87it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.90it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.91s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.03s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.80s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.72s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.73s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.78s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.76s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.61s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.94s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.81s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.66s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.70s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.65s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.51s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.56it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.63it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]100%|██████████| 7/7 [00:03<00:00,  1.97it/s]                                               Done in 81.9s
    uds: 0.7864
    em: 0.5245
    mia_loss: 0.1145

============================================================
[5/75] npo_lr5e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.77it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.80it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.68it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.84it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.95it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.87it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.93it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.67it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.78s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.59s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.15s/it]gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.90s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.79s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.73s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.62s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.66s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:10,  2.06s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.84s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.72s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.70s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.76s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.57s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.62it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:03<00:00,  2.02it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 82.5s
    uds: 0.7903
    em: 0.5372
    mia_loss: 0.1624

============================================================
[6/75] npo_lr5e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.55it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.72it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.81it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.87it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.90it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.01it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.91it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.79it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.21s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.10s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.92s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.75s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.69s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.67s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.60s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.72s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:10,  2.05s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.90s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.86s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.72s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.76s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.67s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.60it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 82.9s
    uds: 0.8375
    em: 0.5597
    mia_loss: 0.2517

============================================================
[7/75] npo_lr1e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr1e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.76it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.55it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.72it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.83it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.93it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.03it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.93it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.80it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.75it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.79it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.16it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.12s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.21s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.08s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.22s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.14s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.14s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.02s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.64s/it]jb_gen:  29%|██▊       | 2/7 [00:07<00:16,  3.26s/it]jb_gen:  43%|████▎     | 3/7 [00:08<00:09,  2.44s/it]jb_gen:  57%|█████▋    | 4/7 [00:09<00:05,  1.80s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.51s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.41s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.27s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.47it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.45it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.67it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 78.6s
    uds: 0.5273
    em: 0.6668
    mia_loss: 0.8790

============================================================
[8/75] npo_lr1e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr1e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.83it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.78it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.79it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.90it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.59it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.70it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:16,  1.71it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.70it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.74it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.72it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:09<00:09,  1.73it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.78it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:10<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.86it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:11<00:06,  1.98it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:12<00:05,  1.96it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.72it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.84it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.46s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.35s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.23s/it]gen:  57%|█████▋    | 4/7 [00:05<00:03,  1.33s/it]gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.29s/it]gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.28s/it]gen: 100%|██████████| 7/7 [00:08<00:00,  1.23s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.63s/it]jb_gen:  29%|██▊       | 2/7 [00:07<00:16,  3.28s/it]jb_gen:  43%|████▎     | 3/7 [00:08<00:09,  2.44s/it]jb_gen:  57%|█████▋    | 4/7 [00:09<00:05,  1.87s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.56s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.43s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.28s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.51it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.72it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.70it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 79.8s
    uds: 0.5323
    em: 0.6874
    mia_loss: 0.8929

============================================================
[9/75] npo_lr1e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr1e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.54it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.73it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.65it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.78it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.84it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.88it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.92it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.83it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.79it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.74it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.09s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.92s/it]gen:  43%|████▎     | 3/7 [00:05<00:06,  1.74s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.55s/it]gen:  71%|███████▏  | 5/7 [00:08<00:02,  1.47s/it]gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.50s/it]gen: 100%|██████████| 7/7 [00:10<00:00,  1.41s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:08,  1.41s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:07,  1.59s/it]jb_gen:  43%|████▎     | 3/7 [00:04<00:05,  1.42s/it]jb_gen:  57%|█████▋    | 4/7 [00:05<00:03,  1.33s/it]jb_gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.30s/it]jb_gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.37s/it]jb_gen: 100%|██████████| 7/7 [00:09<00:00,  1.31s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.52it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.69it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 78.5s
    uds: 0.4720
    em: 0.7373
    mia_loss: 0.9190

============================================================
[10/75] npo_lr2e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.76it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:16,  1.78it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.83it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.65it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.74it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.67it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.89it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.80it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.87it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.82s/it]gen:  29%|██▊       | 2/7 [00:03<00:08,  1.80s/it]gen:  43%|████▎     | 3/7 [00:05<00:06,  1.68s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.58s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.67s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.69s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.68s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.77s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.96s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.68s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.54s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.60s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.69s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  2.16s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.52it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.55it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.52it/s]100%|██████████| 7/7 [00:04<00:00,  1.89it/s]                                               Done in 83.1s
    uds: 0.6462
    em: 0.5999
    mia_loss: 0.3825

============================================================
[11/75] npo_lr2e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.64it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.68it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:10,  1.74it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.83it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.79it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.84it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:10<00:07,  1.78it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.90it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.01it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.74it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.78it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.16it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.87s/it]gen:  29%|██▊       | 2/7 [00:03<00:08,  1.79s/it]gen:  43%|████▎     | 3/7 [00:05<00:06,  1.66s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.56s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.85s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.76s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.53s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:12,  2.16s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.91s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.68s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.50s/it]jb_gen:  71%|███████▏  | 5/7 [00:12<00:05,  2.99s/it]jb_gen:  86%|████████▌ | 6/7 [00:17<00:03,  3.92s/it]jb_gen: 100%|██████████| 7/7 [00:19<00:00,  3.14s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  2.00it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.67it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 89.2s
    uds: 0.6881
    em: 0.6088
    mia_loss: 0.4625

============================================================
[12/75] npo_lr2e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.47it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.74it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.65it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.66it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.83it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.93it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.69it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.70it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.66it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.66s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.80s/it]gen:  43%|████▎     | 3/7 [00:05<00:06,  1.67s/it]gen:  57%|█████▋    | 4/7 [00:06<00:05,  1.74s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.66s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.69s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.59s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:15,  2.54s/it]jb_gen:  29%|██▊       | 2/7 [00:05<00:13,  2.66s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.13s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.07s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.90s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.82s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.65s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.97it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.68it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 83.3s
    uds: 0.7239
    em: 0.6371
    mia_loss: 0.6532

============================================================
[13/75] npo_lr5e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.70it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.78it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.69it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.89it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.87it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.92it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.81it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.87it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.83it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.70it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.82s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.84s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.75s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.77s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.76s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.77s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.63s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.67s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.08s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.85s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.71s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.71s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.77s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.66s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.66it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.66it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.86it/s]                                               Done in 82.5s
    uds: 0.7804
    em: 0.5238
    mia_loss: 0.1169

============================================================
[14/75] npo_lr5e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.55it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.70it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.55it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.85it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.87it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.81it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.65it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.71it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.78it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.70it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.65it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.72it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.73s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.10s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.91s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.84s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.76s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.75s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.54s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.98s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.98s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.70s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.71s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:04,  2.15s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.91s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.73s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 83.1s
    uds: 0.7981
    em: 0.5367
    mia_loss: 0.1584

============================================================
[15/75] npo_lr5e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr5e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.76it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.72it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.62it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.70it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.84it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.71it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.86it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.83it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.83it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.78it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.84it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.92it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.94it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.87it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.81it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.73it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.78it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.24s/it]gen:  29%|██▊       | 2/7 [00:04<00:09,  1.98s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.77s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.73s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.67s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.77s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.59s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.55s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.64s/it]jb_gen:  43%|████▎     | 3/7 [00:04<00:06,  1.54s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.60s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.65s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.76s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.62s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.63it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.54it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.85it/s]                                               Done in 81.8s
    uds: 0.8342
    em: 0.5554
    mia_loss: 0.2469

============================================================
[16/75] rmu_lr1e5_l5_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer5_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.83it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.87it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.71it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.88it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.99s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.16s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.11s/it]gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.96s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.86s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.06s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.81s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.95s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.14s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.96s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.84s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.92s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.89s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.86s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.48it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.50it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.85it/s]                                               Done in 85.3s
    uds: 0.2364
    em: 0.7998
    mia_loss: 0.9672

============================================================
[17/75] rmu_lr1e5_l10_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer10_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.62it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.76it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.72it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.71it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.85it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.82it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.79it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.84it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.95it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.88it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.78it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.85it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.81it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.71it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.65it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.84it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.78s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.15s/it]gen:  43%|████▎     | 3/7 [00:08<00:13,  3.29s/it]gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.63s/it]gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.32s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.24s/it]gen: 100%|██████████| 7/7 [00:16<00:00,  2.09s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.70s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:10,  2.00s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.99s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.88s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.92s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.91s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.74s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.50it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.52it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               Done in 87.5s
    uds: 0.2051
    em: 0.8568
    mia_loss: 0.9873

============================================================
[18/75] rmu_lr1e5_l15_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer15_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.70it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.77it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.04it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.83it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.87it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.87it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.83it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.83it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.99it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.88it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.77it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.71it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.05s/it]gen:  29%|██▊       | 2/7 [00:05<00:13,  2.73s/it]gen:  43%|████▎     | 3/7 [00:08<00:12,  3.13s/it]gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.52s/it]gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.26s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.19s/it]gen: 100%|██████████| 7/7 [00:16<00:00,  2.05s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.90s/it]jb_gen:  29%|██▊       | 2/7 [00:06<00:16,  3.27s/it]jb_gen:  43%|████▎     | 3/7 [00:08<00:10,  2.69s/it]jb_gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.29s/it]jb_gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.17s/it]jb_gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.07s/it]jb_gen: 100%|██████████| 7/7 [00:15<00:00,  1.92s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.53it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.50it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 89.8s
    uds: 0.1568
    em: 0.8782
    mia_loss: 0.9898

============================================================
[19/75] rmu_lr2e5_l5_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer5_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.84it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.78it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.49it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.76it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.87it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.68it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.78it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.85it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.85it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.74it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.78it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.58s/it]gen:  29%|██▊       | 2/7 [00:08<00:21,  4.22s/it]gen:  43%|████▎     | 3/7 [00:14<00:19,  4.84s/it]gen:  57%|█████▋    | 4/7 [00:19<00:15,  5.13s/it]gen:  71%|███████▏  | 5/7 [00:25<00:10,  5.30s/it]gen:  86%|████████▌ | 6/7 [00:31<00:05,  5.42s/it]gen: 100%|██████████| 7/7 [00:33<00:00,  4.23s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:34,  5.67s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.75s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.70s/it]jb_gen:  57%|█████▋    | 4/7 [00:20<00:13,  4.64s/it]jb_gen:  71%|███████▏  | 5/7 [00:25<00:10,  5.01s/it]jb_gen:  86%|████████▌ | 6/7 [00:31<00:05,  5.28s/it]jb_gen: 100%|██████████| 7/7 [00:34<00:00,  4.57s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.41it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.86it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.49it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.52it/s]100%|██████████| 7/7 [00:04<00:00,  1.87it/s]                                               Done in 126.3s
    uds: 0.7494
    em: 0.3947
    mia_loss: 0.5382

============================================================
[20/75] rmu_lr2e5_l10_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer10_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.80it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.44it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.62it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.81it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.69it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.71it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.82it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.80it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.89it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.79it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.87it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.75it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.78it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.60s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.69s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.63s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.61s/it]gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.61s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.65s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.45s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:34,  5.71s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.76s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.72s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:17,  5.69s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.67s/it]jb_gen:  86%|████████▌ | 6/7 [00:34<00:05,  5.70s/it]jb_gen: 100%|██████████| 7/7 [00:39<00:00,  5.48s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.50it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.89it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 137.4s
    uds: 0.6272
    em: 0.5884
    mia_loss: 0.8099

============================================================
[21/75] rmu_lr2e5_l15_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer15_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.71it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.44it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.55it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.65it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.75it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:16,  1.75it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:16,  1.74it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.80it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.85it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.96it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:12<00:05,  1.88it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.82it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.85it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.78it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.84it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.02s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.43s/it]gen:  43%|████▎     | 3/7 [00:10<00:15,  3.87s/it]gen:  57%|█████▋    | 4/7 [00:12<00:09,  3.07s/it]gen:  71%|███████▏  | 5/7 [00:14<00:05,  2.67s/it]gen:  86%|████████▌ | 6/7 [00:16<00:02,  2.47s/it]gen: 100%|██████████| 7/7 [00:18<00:00,  2.26s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:12,  2.14s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.14s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.02s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.88s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.83s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.94s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.78s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.52it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.59it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.54it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.50it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 90.3s
    uds: 0.1664
    em: 0.8480
    mia_loss: 0.9862

============================================================
[22/75] rmu_lr5e5_l5_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer5_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.81it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.60it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.72it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.73it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.67it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.70it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.72it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.85it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.79it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.61s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.68s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.64s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.61s/it]gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.63s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.65s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.48s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:34,  5.68s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.78s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.72s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:17,  5.69s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.69s/it]jb_gen:  86%|████████▌ | 6/7 [00:34<00:05,  5.71s/it]jb_gen: 100%|██████████| 7/7 [00:39<00:00,  5.50s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.64it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.51it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.49it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.50it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.51it/s]100%|██████████| 7/7 [00:04<00:00,  1.87it/s]                                               Done in 138.4s
    uds: 0.9751
    em: 0.0410
    mia_loss: 0.0058

============================================================
[23/75] rmu_lr5e5_l10_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer10_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.70it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.47it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.76it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:16,  1.73it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.71it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.87it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.85it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.81it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.95it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.72it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.59s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.67s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.62s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.60s/it]gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.60s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.63s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.43s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:34,  5.76s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.79s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.73s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:17,  5.69s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.68s/it]jb_gen:  86%|████████▌ | 6/7 [00:34<00:05,  5.71s/it]jb_gen: 100%|██████████| 7/7 [00:39<00:00,  5.48s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.42it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 137.0s
    uds: 0.8945
    em: 0.1023
    mia_loss: 0.0527

============================================================
[24/75] rmu_lr5e5_l15_s10_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer15_scoeff10_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.43it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.55it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.65it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:16,  1.79it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.83it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.72it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.70it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.84it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.94it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.96it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.83it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.72it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:14,  2.33s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.40s/it]gen:  43%|████▎     | 3/7 [00:10<00:15,  3.85s/it]gen:  57%|█████▋    | 4/7 [00:13<00:10,  3.38s/it]gen:  71%|███████▏  | 5/7 [00:16<00:06,  3.49s/it]gen:  86%|████████▌ | 6/7 [00:19<00:03,  3.16s/it]gen: 100%|██████████| 7/7 [00:21<00:00,  2.79s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.65s/it]jb_gen:  29%|██▊       | 2/7 [00:08<00:18,  3.72s/it]jb_gen:  43%|████▎     | 3/7 [00:10<00:11,  2.98s/it]jb_gen:  57%|█████▋    | 4/7 [00:11<00:07,  2.51s/it]jb_gen:  71%|███████▏  | 5/7 [00:17<00:07,  3.65s/it]jb_gen:  86%|████████▌ | 6/7 [00:23<00:04,  4.36s/it]jb_gen: 100%|██████████| 7/7 [00:25<00:00,  3.69s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.51it/s]100%|██████████| 7/7 [00:04<00:00,  1.87it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.70it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.56it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 105.6s
    uds: 0.1923
    em: 0.8050
    mia_loss: 0.9744

============================================================
[25/75] rmu_lr1e5_l5_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer5_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.68it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.53it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:04<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 7/7 [00:04<00:00,  1.74it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.82it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.86it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.80it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.67it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.75it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.71it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.85it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.82it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.89it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.99it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.88it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.68it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.94s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.37s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.19s/it]gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.98s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.82s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.03s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.78s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.64s/it]jb_gen:  29%|██▊       | 2/7 [00:08<00:20,  4.01s/it]jb_gen:  43%|████▎     | 3/7 [00:10<00:12,  3.23s/it]jb_gen:  57%|█████▋    | 4/7 [00:12<00:08,  2.72s/it]jb_gen:  71%|███████▏  | 5/7 [00:14<00:04,  2.36s/it]jb_gen:  86%|████████▌ | 6/7 [00:16<00:02,  2.22s/it]jb_gen: 100%|██████████| 7/7 [00:17<00:00,  1.86s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.65it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.51it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.89it/s]                                               Done in 89.7s
    uds: 0.2484
    em: 0.7857
    mia_loss: 0.9590

============================================================
[26/75] rmu_lr1e5_l10_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer10_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.60it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.54it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.70it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.04it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:16,  1.78it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.83it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.70it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.71it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.88it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.84it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.96it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.85it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.81it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.67it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.80s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.16s/it]gen:  43%|████▎     | 3/7 [00:09<00:14,  3.66s/it]gen:  57%|█████▋    | 4/7 [00:11<00:08,  2.86s/it]gen:  71%|███████▏  | 5/7 [00:13<00:05,  2.51s/it]gen:  86%|████████▌ | 6/7 [00:15<00:02,  2.30s/it]gen: 100%|██████████| 7/7 [00:16<00:00,  2.11s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:13,  2.28s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.26s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.13s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.95s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.97s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.97s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.75s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.65it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               Done in 88.5s
    uds: 0.2120
    em: 0.8526
    mia_loss: 0.9865

============================================================
[27/75] rmu_lr1e5_l15_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr1e-05_layer15_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.93it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.70it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.70it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.86it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.81it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.90it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.01it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.87it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.72it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.72it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.10s/it]gen:  29%|██▊       | 2/7 [00:05<00:13,  2.76s/it]gen:  43%|████▎     | 3/7 [00:08<00:12,  3.04s/it]gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.46s/it]gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.24s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.18s/it]gen: 100%|██████████| 7/7 [00:16<00:00,  2.06s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.89s/it]jb_gen:  29%|██▊       | 2/7 [00:06<00:16,  3.26s/it]jb_gen:  43%|████▎     | 3/7 [00:08<00:10,  2.69s/it]jb_gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.27s/it]jb_gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.11s/it]jb_gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.04s/it]jb_gen: 100%|██████████| 7/7 [00:15<00:00,  1.97s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 89.5s
    uds: 0.1568
    em: 0.8768
    mia_loss: 0.9897

============================================================
[28/75] rmu_lr2e5_l5_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer5_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.65it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.70it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.52it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.02it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.76it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.75it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.88it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.82it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.80it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.87it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.03it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.81it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.60s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.68s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.64s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.61s/it]gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.61s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.64s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.43s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.65s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.75s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.70s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:17,  5.68s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.66s/it]jb_gen:  86%|████████▌ | 6/7 [00:34<00:05,  5.69s/it]jb_gen: 100%|██████████| 7/7 [00:38<00:00,  5.10s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.40it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.45it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.45it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.52it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 135.2s
    uds: 0.7973
    em: 0.3496
    mia_loss: 0.5098

============================================================
[29/75] rmu_lr2e5_l10_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer10_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.84it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.76it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.76it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.81it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.72it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.63it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.68it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:10,  1.79it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.84it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.77it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:10<00:07,  1.83it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.95it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.87it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.87it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.80it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.77it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.83it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.62s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.72s/it]gen:  43%|████▎     | 3/7 [00:17<00:22,  5.66s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.62s/it]gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.62s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.65s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.46s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.66s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.76s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.71s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:17,  5.69s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.69s/it]jb_gen:  86%|████████▌ | 6/7 [00:34<00:05,  5.71s/it]jb_gen: 100%|██████████| 7/7 [00:39<00:00,  5.50s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.52it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.60it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.87it/s]                                               Done in 138.6s
    uds: 0.7372
    em: 0.4804
    mia_loss: 0.6877

============================================================
[30/75] rmu_lr2e5_l15_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr2e-05_layer15_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.66it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.68it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.72it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.71it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.10s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.46s/it]gen:  43%|████▎     | 3/7 [00:10<00:15,  3.89s/it]gen:  57%|█████▋    | 4/7 [00:12<00:09,  3.25s/it]gen:  71%|███████▏  | 5/7 [00:14<00:05,  2.82s/it]gen:  86%|████████▌ | 6/7 [00:16<00:02,  2.59s/it]gen: 100%|██████████| 7/7 [00:18<00:00,  2.25s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:34,  5.67s/it]jb_gen:  29%|██▊       | 2/7 [00:07<00:18,  3.65s/it]jb_gen:  43%|████▎     | 3/7 [00:09<00:11,  2.84s/it]jb_gen:  57%|█████▋    | 4/7 [00:11<00:07,  2.34s/it]jb_gen:  71%|███████▏  | 5/7 [00:13<00:04,  2.12s/it]jb_gen:  86%|████████▌ | 6/7 [00:15<00:02,  2.13s/it]jb_gen: 100%|██████████| 7/7 [00:16<00:00,  1.91s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.48it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.48it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.68it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 93.5s
    uds: 0.1682
    em: 0.8457
    mia_loss: 0.9857

============================================================
[31/75] rmu_lr5e5_l5_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer5_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.59it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.86it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.81it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.65it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.85it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.79it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.83it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.95it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.60s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.68s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.65s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.62s/it]gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.61s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.63s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.44s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:34,  5.69s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.76s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.70s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:17,  5.70s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.68s/it]jb_gen:  86%|████████▌ | 6/7 [00:34<00:05,  5.70s/it]jb_gen: 100%|██████████| 7/7 [00:39<00:00,  5.48s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.50it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.52it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.61it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.87it/s]                                               Done in 137.5s
    uds: 0.9780
    em: 0.0293
    mia_loss: 0.0043

============================================================
[32/75] rmu_lr5e5_l10_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer10_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.47it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.72it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.65it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.83it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.85it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.69it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.88it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:09,  1.78it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.83it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.95it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.94it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.86it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.79it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.68it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.60s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.68s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.64s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.62s/it]gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.62s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.65s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.47s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:34,  5.68s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.77s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.72s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:17,  5.68s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.68s/it]jb_gen:  86%|████████▌ | 6/7 [00:34<00:05,  5.70s/it]jb_gen: 100%|██████████| 7/7 [00:39<00:00,  5.51s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.46it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.48it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.51it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.70it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 136.8s
    uds: 0.9015
    em: 0.0765
    mia_loss: 0.0124

============================================================
[33/75] rmu_lr5e5_l15_s10_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_RMU_lr5e-05_layer15_scoeff10_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.69it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.52it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.00it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.75it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.77it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.74it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.73it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.66it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.89it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.86it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.80it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:10<00:07,  1.80it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.93it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.03it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.90it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.69it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:16<00:01,  1.62it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.66it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.84it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.60s/it]gen:  29%|██▊       | 2/7 [00:08<00:18,  3.77s/it]gen:  43%|████▎     | 3/7 [00:13<00:18,  4.59s/it]gen:  57%|█████▋    | 4/7 [00:16<00:11,  3.95s/it]gen:  71%|███████▏  | 5/7 [00:18<00:06,  3.31s/it]gen:  86%|████████▌ | 6/7 [00:21<00:03,  3.04s/it]gen: 100%|██████████| 7/7 [00:23<00:00,  2.71s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:34,  5.67s/it]jb_gen:  29%|██▊       | 2/7 [00:08<00:19,  3.94s/it]jb_gen:  43%|████▎     | 3/7 [00:10<00:12,  3.15s/it]jb_gen:  57%|█████▋    | 4/7 [00:12<00:07,  2.50s/it]jb_gen:  71%|███████▏  | 5/7 [00:17<00:07,  3.65s/it]jb_gen:  86%|████████▌ | 6/7 [00:23<00:04,  4.36s/it]jb_gen: 100%|██████████| 7/7 [00:25<00:00,  3.69s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.47it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.69it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.67it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.51it/s]100%|██████████| 7/7 [00:04<00:00,  1.85it/s]                                               Done in 108.0s
    uds: 0.1948
    em: 0.8000
    mia_loss: 0.9710

============================================================
[34/75] simnpo_lr1e5_b35_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b3.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.62it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.89it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.71it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.59it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.65it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.81it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.83it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.73it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.28s/it]gen:  29%|██▊       | 2/7 [00:05<00:13,  2.62s/it]gen:  43%|████▎     | 3/7 [00:08<00:11,  2.90s/it]gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.48s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.20s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.18s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  1.92s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.98s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:12,  2.52s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.09s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.01s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.91s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.93s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.85s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  2.00it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.68it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.62it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.63it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 87.3s
    uds: 0.1827
    em: 0.8524
    mia_loss: 0.9861

============================================================
[35/75] simnpo_lr1e5_b35_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b3.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.84it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.65it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.49it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.81it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.84it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.92it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.68it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.99s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.20s/it]gen:  43%|████▎     | 3/7 [00:07<00:10,  2.72s/it]gen:  57%|█████▋    | 4/7 [00:09<00:07,  2.44s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.27s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.14s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  1.94s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.72s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:12,  2.52s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:09,  2.27s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.05s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.00s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.01s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.85s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.67it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 87.0s
    uds: 0.2187
    em: 0.8209
    mia_loss: 0.9778

============================================================
[36/75] simnpo_lr1e5_b45_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b4.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.65it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.78it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.77it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.06it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.61it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.70it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.83it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.25s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.51s/it]gen:  43%|████▎     | 3/7 [00:08<00:11,  2.83s/it]gen:  57%|█████▋    | 4/7 [00:09<00:07,  2.44s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.25s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.23s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  1.97s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.72s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.39s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:07,  1.95s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.88s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.88s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.90s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.87s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.49it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.68it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.62it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 87.0s
    uds: 0.1834
    em: 0.8518
    mia_loss: 0.9859

============================================================
[37/75] simnpo_lr1e5_b45_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b4.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.65it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.65it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.02it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.84it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:10,  1.76it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.80it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.80it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.75it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.83it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.93it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:06,  1.92it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.93it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.88it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.88it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.67it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.87s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.41s/it]gen:  43%|████▎     | 3/7 [00:07<00:10,  2.52s/it]gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.30s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.26s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.38s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  2.06s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:14,  2.34s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.30s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:07,  1.94s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.85s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.87s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.98s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.83s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.52it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.49it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.63it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.52it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.89it/s]                                               Done in 87.3s
    uds: 0.2215
    em: 0.8195
    mia_loss: 0.9770

============================================================
[38/75] simnpo_lr2e5_b35_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b3.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.50it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.77it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.04it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.72it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.68it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.88it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.82it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.89it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.78it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:10<00:07,  1.85it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.84it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.69s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.41s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.10s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.17s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.02s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.01s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.83s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.59s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.82s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:09,  2.48s/it]jb_gen:  57%|█████▋    | 4/7 [00:10<00:09,  3.08s/it]jb_gen:  71%|███████▏  | 5/7 [00:12<00:05,  2.74s/it]jb_gen:  86%|████████▌ | 6/7 [00:15<00:02,  2.61s/it]jb_gen: 100%|██████████| 7/7 [00:16<00:00,  2.18s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.97it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.70it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.56it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 88.8s
    uds: 0.4106
    em: 0.7418
    mia_loss: 0.8816

============================================================
[39/75] simnpo_lr2e5_b35_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b3.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.99it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.77it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.87it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.72it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.61it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.80it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:10,  1.79it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.77it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:09,  1.78it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.71it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:10<00:07,  1.80it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.92it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:12<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.93it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.84it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.77s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.87s/it]gen:  43%|████▎     | 3/7 [00:09<00:14,  3.57s/it]gen:  57%|█████▋    | 4/7 [00:11<00:08,  2.88s/it]gen:  71%|███████▏  | 5/7 [00:13<00:05,  2.74s/it]gen:  86%|████████▌ | 6/7 [00:16<00:02,  2.71s/it]gen: 100%|██████████| 7/7 [00:18<00:00,  2.40s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:15,  2.63s/it]jb_gen:  29%|██▊       | 2/7 [00:08<00:22,  4.50s/it]jb_gen:  43%|████▎     | 3/7 [00:10<00:14,  3.59s/it]jb_gen:  57%|█████▋    | 4/7 [00:12<00:08,  2.95s/it]jb_gen:  71%|███████▏  | 5/7 [00:15<00:05,  2.65s/it]jb_gen:  86%|████████▌ | 6/7 [00:19<00:03,  3.24s/it]jb_gen: 100%|██████████| 7/7 [00:20<00:00,  2.60s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.46it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.51it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.70it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.64it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.51it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.89it/s]                                               Done in 97.4s
    uds: 0.5196
    em: 0.7073
    mia_loss: 0.7735

============================================================
[40/75] simnpo_lr2e5_b45_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b4.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.69it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.77it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.79it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.67it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.82it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.94it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.95it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.88it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.73it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.78it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.90s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.40s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.11s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.09s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.03s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.09s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.88s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.67s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.88s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.74s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.22s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.20s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.22s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.91s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.70it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.67it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.63it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 85.9s
    uds: 0.4003
    em: 0.7465
    mia_loss: 0.8901

============================================================
[41/75] simnpo_lr2e5_b45_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b4.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.84it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.70it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.80it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.75it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.83it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.94it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.03it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.77it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.68it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.84s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.14s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.98s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.89s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.05s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.17s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.96s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.65s/it]jb_gen:  29%|██▊       | 2/7 [00:08<00:20,  4.04s/it]jb_gen:  43%|████▎     | 3/7 [00:10<00:12,  3.09s/it]jb_gen:  57%|█████▋    | 4/7 [00:12<00:07,  2.56s/it]jb_gen:  71%|███████▏  | 5/7 [00:14<00:04,  2.33s/it]jb_gen:  86%|████████▌ | 6/7 [00:16<00:02,  2.39s/it]jb_gen: 100%|██████████| 7/7 [00:18<00:00,  2.09s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.43it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.45it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.52it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.64it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.56it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 90.4s
    uds: 0.5126
    em: 0.7137
    mia_loss: 0.8023

============================================================
[42/75] simnpo_lr5e5_b35_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b3.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.60it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.53it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.62it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.72it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.71it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.88it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.88it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.83it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.65it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.72it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.97s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.13s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.94s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.96s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.09s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.02s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.87s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.86s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.79s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.74s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.92s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.89s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.94s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.92s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.60it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.47it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.46it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.85it/s]                                               Done in 85.2s
    uds: 0.7395
    em: 0.6322
    mia_loss: 0.5560

============================================================
[43/75] simnpo_lr5e5_b35_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b3.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.85it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.87it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.81it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.62it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:13,  1.67it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.79it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:10,  1.78it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.85it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:09,  1.78it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.83it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.71it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.78it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.05s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.49s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.08s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.02s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.06s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.17s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.98s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.71s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.79s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.69s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:05,  1.69s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.78s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.85s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.76s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.44it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.97it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.62it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.51it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 84.9s
    uds: 0.8166
    em: 0.6074
    mia_loss: 0.3412

============================================================
[44/75] simnpo_lr5e5_b45_a1_d1_g0125_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b4.5_a1_d1_g0.125_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.47it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.70it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.52it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.77it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.61it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.71it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.67it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.83it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.81it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.82it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.80it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:10<00:07,  1.84it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.88it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.83it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.79it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.11s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.91s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.83s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.77s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.74s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.71s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.61s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.59s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:10,  2.07s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.09s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.15s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.17s/it]jb_gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.27s/it]jb_gen: 100%|██████████| 7/7 [00:15<00:00,  2.22s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.65it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.62it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               Done in 85.4s
    uds: 0.7222
    em: 0.6444
    mia_loss: 0.6088

============================================================
[45/75] simnpo_lr5e5_b45_a1_d1_g025_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b4.5_a1_d1_g0.25_ep5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.60it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.74it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.54it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.00it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.75it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.65it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.71it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.78it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:09,  1.77it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.83it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.91it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.02it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.93it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.83it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.67it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.87s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.23s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.02s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.89s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.23s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.03s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.87s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:03<00:19,  3.25s/it]jb_gen:  29%|██▊       | 2/7 [00:05<00:13,  2.67s/it]jb_gen:  43%|████▎     | 3/7 [00:07<00:08,  2.17s/it]jb_gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.08s/it]jb_gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.11s/it]jb_gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.09s/it]jb_gen: 100%|██████████| 7/7 [00:14<00:00,  1.98s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.48it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.50it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.86it/s]                                               Done in 87.3s
    uds: 0.8058
    em: 0.6153
    mia_loss: 0.4115

============================================================
[46/75] simnpo_lr1e5_b35_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b3.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.72it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.81it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.78it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.81it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.80it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.78it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.85it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.95it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.02it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.80it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.77it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.76it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.81it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.25s/it]gen:  29%|██▊       | 2/7 [00:05<00:12,  2.56s/it]gen:  43%|████▎     | 3/7 [00:08<00:11,  2.87s/it]gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.44s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.18s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.08s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  1.87s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.84s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:12,  2.41s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.00s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.90s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.84s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.97s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.87s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.64it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.65it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.89it/s]                                               Done in 86.7s
    uds: 0.1846
    em: 0.8510
    mia_loss: 0.9859

============================================================
[47/75] simnpo_lr1e5_b35_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b3.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.60it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.62it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.71it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.89it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.92it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.95it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.87it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.80it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.89s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.30s/it]gen:  43%|████▎     | 3/7 [00:07<00:11,  2.77s/it]gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.61s/it]gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.43s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.25s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  2.00s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:14,  2.39s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:12,  2.50s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.20s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.01s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.97s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.04s/it]jb_gen: 100%|██████████| 7/7 [00:14<00:00,  1.91s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.41it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.63it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 88.0s
    uds: 0.2214
    em: 0.8179
    mia_loss: 0.9772

============================================================
[48/75] simnpo_lr1e5_b45_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b4.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.92it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.87it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.67it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.30s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.52s/it]gen:  43%|████▎     | 3/7 [00:08<00:11,  2.76s/it]gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.29s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.07s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.08s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.87s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.89s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:12,  2.47s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.11s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.98s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.89s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.91s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.84s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.50it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.72it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 86.5s
    uds: 0.1855
    em: 0.8509
    mia_loss: 0.9856

============================================================
[49/75] simnpo_lr1e5_b45_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr1e-05_b4.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.70it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.98it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.64it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.84it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.95it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.88it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.79it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.94s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.35s/it]gen:  43%|████▎     | 3/7 [00:07<00:09,  2.48s/it]gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.26s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.02s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.18s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.94s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:14,  2.38s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.33s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.08s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.96s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.93s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.01s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.86s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.42it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.97it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.62it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.52it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 86.6s
    uds: 0.2269
    em: 0.8179
    mia_loss: 0.9763

============================================================
[50/75] simnpo_lr2e5_b35_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b3.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.74it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.74it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.59it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:16,  1.80it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.84it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.70it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.70it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.87it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.89it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.84it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.83it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.95it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.86it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.75it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:03<00:18,  3.07s/it]gen:  29%|██▊       | 2/7 [00:05<00:14,  2.88s/it]gen:  43%|████▎     | 3/7 [00:07<00:09,  2.40s/it]gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.27s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.06s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.05s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.83s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.88s/it]jb_gen:  29%|██▊       | 2/7 [00:07<00:20,  4.18s/it]jb_gen:  43%|████▎     | 3/7 [00:09<00:12,  3.16s/it]jb_gen:  57%|█████▋    | 4/7 [00:11<00:08,  2.69s/it]jb_gen:  71%|███████▏  | 5/7 [00:13<00:04,  2.48s/it]jb_gen:  86%|████████▌ | 6/7 [00:15<00:02,  2.33s/it]jb_gen: 100%|██████████| 7/7 [00:17<00:00,  1.99s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.50it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.49it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 90.1s
    uds: 0.4476
    em: 0.7242
    mia_loss: 0.8462

============================================================
[51/75] simnpo_lr2e5_b35_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b3.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.69it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.87it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.79it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.70it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.24s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.27s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.09s/it]gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.97s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.08s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.07s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.89s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:13,  2.33s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.12s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:07,  1.99s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.05s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.98s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.02s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.89s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.62it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 86.3s
    uds: 0.5488
    em: 0.6994
    mia_loss: 0.7429

============================================================
[52/75] simnpo_lr2e5_b45_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b4.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:15,  1.59it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.68it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.84it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.82it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.82it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.80it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:14,  2.43s/it]gen:  29%|██▊       | 2/7 [00:05<00:12,  2.59s/it]gen:  43%|████▎     | 3/7 [00:07<00:09,  2.34s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.12s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.16s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.05s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.93s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.77s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.86s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.96s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.84s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.77s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.92s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.74s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.52it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.49it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.70it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.51it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 85.9s
    uds: 0.4385
    em: 0.7305
    mia_loss: 0.8604

============================================================
[53/75] simnpo_lr2e5_b45_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr2e-05_b4.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.72it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.79it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.87it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.80it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.87it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.92it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.82it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.77s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.45s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.17s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.05s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.03s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.02s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.85s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.73s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.88s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.85s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.98s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:04,  2.01s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:02,  2.04s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.83s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.51it/s]100%|██████████| 7/7 [00:04<00:00,  1.85it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 85.6s
    uds: 0.5349
    em: 0.7085
    mia_loss: 0.7815

============================================================
[54/75] simnpo_lr5e5_b35_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b3.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.58it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.71it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.65it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.98it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.82it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.71it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.86it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.82it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.68it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.66it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.75s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.84s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.88s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.87s/it]gen:  71%|███████▏  | 5/7 [00:09<00:04,  2.01s/it]gen:  86%|████████▌ | 6/7 [00:11<00:02,  2.06s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.84s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.59s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.09s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.88s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.94s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.88s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.98s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.91s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.49it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.87it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.56it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.50it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.48it/s]100%|██████████| 7/7 [00:04<00:00,  1.83it/s]                                               Done in 85.0s
    uds: 0.7387
    em: 0.6364
    mia_loss: 0.5355

============================================================
[55/75] simnpo_lr5e5_b35_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b3.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.81it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.71it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:09,  1.77it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.83it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.90it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.01it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.90it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.82it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.88it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.83it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.71it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.72it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.66it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.95s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.95s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.86s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.99s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.94s/it]gen:  86%|████████▌ | 6/7 [00:11<00:02,  2.03s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.86s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:16,  2.72s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.35s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.14s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.02s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.00s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.98s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.84s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.52it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.69it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 85.8s
    uds: 0.8239
    em: 0.6059
    mia_loss: 0.3139

============================================================
[56/75] simnpo_lr5e5_b45_a1_d1_g0125_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b4.5_a1_d1_g0.125_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.70it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.74it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.67it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.83it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.70it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.71it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.72it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.86it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.81it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.96it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.90it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.83it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.72it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.66it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.65s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.86s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.87s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.82s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.82s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.90s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.72s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.66s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.91s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.74s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.99s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.95s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:02,  2.00s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.83s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.97it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.57it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 83.9s
    uds: 0.7122
    em: 0.6479
    mia_loss: 0.5973

============================================================
[57/75] simnpo_lr5e5_b45_a1_d1_g025_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_SimNPO_lr5e-05_b4.5_a1_d1_g0.25_ep10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.68it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.72it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.59it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.53it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.04it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.75it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.80it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.80it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.70it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.70it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:10,  1.80it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.88it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.78it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.84it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.92it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.02it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.90it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:12<00:05,  1.93it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.88it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.83it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.08s/it]gen:  29%|██▊       | 2/7 [00:05<00:12,  2.59s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.10s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.04s/it]gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.96s/it]gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.92s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.85s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.92s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.91s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.78s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.90s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.82s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.97s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.90s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.48it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.67it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.62it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.49it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 85.4s
    uds: 0.8068
    em: 0.6173
    mia_loss: 0.3884

============================================================
[58/75] undial_lr1e5_b10_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.53it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.72it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.65it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.74it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.73it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.87it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:10,  1.79it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.81it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.80it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.78it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:10<00:07,  1.84it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.03it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.91s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.42s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.23s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.05s/it]gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.89s/it]gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.92s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.85s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:14,  2.37s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.30s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:07,  1.94s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.97s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.89s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.92s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.72s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.54it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               Done in 85.4s
    uds: 0.2201
    em: 0.8570
    mia_loss: 0.9866

============================================================
[59/75] undial_lr1e5_b10_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.74it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.54it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.01it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.76it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.04it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.72it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.83it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.76it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.83it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.94it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.02it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.88it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.01s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.03s/it]gen:  43%|████▎     | 3/7 [00:07<00:10,  2.63s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.16s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.28s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.20s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.99s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.74s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.07s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.90s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.94s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.98s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.84s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.78s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.62it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.62it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.53it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 86.2s
    uds: 0.2059
    em: 0.8564
    mia_loss: 0.9873

============================================================
[60/75] undial_lr1e5_b10_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.81it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.49it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.04it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:15,  1.59it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.63it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.81it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.84it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.81it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.87it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.95it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.77it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.70it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.33s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.14s/it]gen:  43%|████▎     | 3/7 [00:06<00:09,  2.33s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.17s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.06s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.01s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.85s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.69s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.88s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.80s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.84s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.97s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:02,  2.01s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.85s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.70it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 85.3s
    uds: 0.1842
    em: 0.8686
    mia_loss: 0.9892

============================================================
[61/75] undial_lr1e4_b10_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.68it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.71it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.89it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.80it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.90it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.02it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.96it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.96it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.87it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.80it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.75it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.78it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.79s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.94s/it]gen:  43%|████▎     | 3/7 [00:09<00:14,  3.64s/it]gen:  57%|█████▋    | 4/7 [00:12<00:09,  3.27s/it]gen:  71%|███████▏  | 5/7 [00:14<00:05,  2.87s/it]gen:  86%|████████▌ | 6/7 [00:16<00:02,  2.63s/it]gen: 100%|██████████| 7/7 [00:18<00:00,  2.41s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:12,  2.10s/it]jb_gen:  29%|██▊       | 2/7 [00:05<00:14,  2.86s/it]jb_gen:  43%|████▎     | 3/7 [00:07<00:09,  2.39s/it]jb_gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.12s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.04s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.02s/it]jb_gen: 100%|██████████| 7/7 [00:14<00:00,  2.04s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.73it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 91.4s
    uds: 0.6067
    em: 0.3872
    mia_loss: 0.5523

============================================================
[62/75] undial_lr1e4_b10_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.76it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.19it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.89it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.72it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.46it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.74it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.73it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.62it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.85it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.82it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.82it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:10<00:07,  1.82it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.94it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.04it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.59s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  2.00s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.89s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.99s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.18s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.13s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.99s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.67s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.99s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.07s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.04s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.06s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.15s/it]jb_gen: 100%|██████████| 7/7 [00:14<00:00,  2.14s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:04<00:00,  2.00it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.69it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               Done in 86.9s
    uds: 0.6312
    em: 0.4691
    mia_loss: 0.6441

============================================================
[63/75] undial_lr1e4_b10_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.70it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.74it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.65it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.66it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.74it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.70it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.85it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.82it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.83it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.85it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.70it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.70it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.63s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.11s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.95s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.81s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.90s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.95s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.83s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:12,  2.16s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.19s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.06s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.90s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.89s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.79s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.77s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:04<00:00,  2.01it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.67it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.63it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               Done in 84.3s
    uds: 0.6238
    em: 0.5498
    mia_loss: 0.7278

============================================================
[64/75] undial_lr3e4_b10_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.70it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.65it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.80it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.99it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.70it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.70it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.64s/it]gen:  29%|██▊       | 2/7 [00:08<00:19,  3.92s/it]gen:  43%|████▎     | 3/7 [00:13<00:18,  4.68s/it]gen:  57%|█████▋    | 4/7 [00:19<00:15,  5.04s/it]gen:  71%|███████▏  | 5/7 [00:21<00:07,  3.91s/it]gen:  86%|████████▌ | 6/7 [00:27<00:04,  4.52s/it]gen: 100%|██████████| 7/7 [00:32<00:00,  4.68s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.66s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.76s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.71s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:17,  5.67s/it]jb_gen:  71%|███████▏  | 5/7 [00:24<00:08,  4.41s/it]jb_gen:  86%|████████▌ | 6/7 [00:26<00:03,  3.53s/it]jb_gen: 100%|██████████| 7/7 [00:31<00:00,  4.03s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.66it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.52it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.48it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               Done in 122.1s
    uds: 0.7944
    em: 0.3840
    mia_loss: 0.6347

============================================================
[65/75] undial_lr3e4_b10_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.55it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:04<00:00,  1.92it/s]Mem eval (multi): 100%|██████████| 7/7 [00:04<00:00,  1.74it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.03it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.83it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.86it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.87it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.70it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.87it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.85it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.84it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.79it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.51s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.93s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.81s/it]gen:  57%|█████▋    | 4/7 [00:06<00:05,  1.71s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.80s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.75s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.80s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.62s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.26s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.80s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.79s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.70s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.71s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.66s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.49it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.51it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 83.4s
    uds: 0.8026
    em: 0.4486
    mia_loss: 0.6922

============================================================
[66/75] undial_lr3e4_b10_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:16,  1.78it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.84it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:15,  1.60it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.67it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.75it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.71it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.83it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.87it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.85it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.79it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.73it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.72it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.69s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.88s/it]gen:  43%|████▎     | 3/7 [00:09<00:14,  3.56s/it]gen:  57%|█████▋    | 4/7 [00:11<00:08,  2.89s/it]gen:  71%|███████▏  | 5/7 [00:16<00:07,  3.86s/it]gen:  86%|████████▌ | 6/7 [00:22<00:04,  4.48s/it]gen: 100%|██████████| 7/7 [00:23<00:00,  3.47s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.69s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.90s/it]jb_gen:  43%|████▎     | 3/7 [00:09<00:14,  3.62s/it]jb_gen:  57%|█████▋    | 4/7 [00:15<00:13,  4.41s/it]jb_gen:  71%|███████▏  | 5/7 [00:20<00:09,  4.85s/it]jb_gen:  86%|████████▌ | 6/7 [00:22<00:03,  3.74s/it]jb_gen: 100%|██████████| 7/7 [00:23<00:00,  2.88s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.48it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.97it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.61it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.89it/s]                                               Done in 105.2s
    uds: 0.8681
    em: 0.4723
    mia_loss: 0.6489

============================================================
[67/75] undial_lr1e5_b10_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.04it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.74it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.72it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.89it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.80it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.79it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.84it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.83it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.95it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.04it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.84it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.81it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.65it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.72it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.11s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.50s/it]gen:  43%|████▎     | 3/7 [00:06<00:09,  2.27s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.09s/it]gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.93s/it]gen:  86%|████████▌ | 6/7 [00:12<00:01,  2.00s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.89s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.76s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.10s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.96s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.99s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.92s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.94s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.74s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.73it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 85.5s
    uds: 0.2212
    em: 0.8564
    mia_loss: 0.9864

============================================================
[68/75] undial_lr1e5_b10_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.58it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.79it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.66it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.75it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.84it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.95it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.87it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.92it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.09it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.99it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.96it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.89it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.89it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.01s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.02s/it]gen:  43%|████▎     | 3/7 [00:06<00:07,  2.00s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.85s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.77s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.87s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.77s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.72s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.06s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.89s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.93s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.83s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.93s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.75s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.42it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.49it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.53it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 83.8s
    uds: 0.2106
    em: 0.8552
    mia_loss: 0.9871

============================================================
[69/75] undial_lr1e5_b10_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr1e-05_beta10_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.67it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.70it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.90it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.82it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.85it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.71it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.82it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.83it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.95it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.65it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.72it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:14,  2.43s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.37s/it]gen:  43%|████▎     | 3/7 [00:07<00:10,  2.61s/it]gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.32s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.09s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.03s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.85s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.75s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.07s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.89s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.89s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.91s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.97s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.72s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.40it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.43it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.48it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 85.6s
    uds: 0.1849
    em: 0.8687
    mia_loss: 0.9892

============================================================
[70/75] undial_lr1e4_b10_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.68it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.55it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.03it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.84it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.95it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.87it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.85it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.81it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.74it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:15,  2.54s/it]gen:  29%|██▊       | 2/7 [00:05<00:12,  2.58s/it]gen:  43%|████▎     | 3/7 [00:07<00:10,  2.63s/it]gen:  57%|█████▋    | 4/7 [00:09<00:07,  2.42s/it]gen:  71%|███████▏  | 5/7 [00:14<00:06,  3.19s/it]gen:  86%|████████▌ | 6/7 [00:20<00:04,  4.03s/it]gen: 100%|██████████| 7/7 [00:22<00:00,  3.38s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:03<00:18,  3.09s/it]jb_gen:  29%|██▊       | 2/7 [00:05<00:12,  2.49s/it]jb_gen:  43%|████▎     | 3/7 [00:07<00:10,  2.53s/it]jb_gen:  57%|█████▋    | 4/7 [00:13<00:11,  3.75s/it]jb_gen:  71%|███████▏  | 5/7 [00:15<00:06,  3.14s/it]jb_gen:  86%|████████▌ | 6/7 [00:17<00:02,  2.75s/it]jb_gen: 100%|██████████| 7/7 [00:19<00:00,  2.61s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.47it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.50it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.51it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.53it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 100.2s
    uds: 0.6295
    em: 0.3184
    mia_loss: 0.4692

============================================================
[71/75] undial_lr1e4_b10_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.74it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.70it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.70it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.75it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.88it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.79it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.90it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.02it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.87it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.80it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.78it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.77it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.80it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.96s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.93s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.20s/it]gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.99s/it]gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.98s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.00s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  2.08s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.87s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.09s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.92s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:06,  2.02s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.05s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.04s/it]jb_gen: 100%|██████████| 7/7 [00:14<00:00,  2.02s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.52it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.62it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 86.6s
    uds: 0.6477
    em: 0.4108
    mia_loss: 0.5990

============================================================
[72/75] undial_lr1e4_b10_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0001_beta10_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.72it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.70it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.81it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.70it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.81it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:10,  1.79it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.87it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.80it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.83it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.95it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.87it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.80it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.14s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.09s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.94s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.85s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.77s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.74s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.67s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.62s/it]jb_gen:  29%|██▊       | 2/7 [00:07<00:20,  4.07s/it]jb_gen:  43%|████▎     | 3/7 [00:09<00:11,  2.98s/it]jb_gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.41s/it]jb_gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.11s/it]jb_gen:  86%|████████▌ | 6/7 [00:13<00:01,  1.94s/it]jb_gen: 100%|██████████| 7/7 [00:15<00:00,  1.75s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.56it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.89it/s]                                               Done in 85.7s
    uds: 0.5967
    em: 0.5321
    mia_loss: 0.7576

============================================================
[73/75] undial_lr3e4_b10_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.62it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.69it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.70it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.06it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.85it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:15,  1.73it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.72it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.60it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.71it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.87it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.83it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:10<00:07,  1.84it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.90it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.69it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.70it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.77s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.30s/it]gen:  43%|████▎     | 3/7 [00:07<00:11,  2.84s/it]gen:  57%|█████▋    | 4/7 [00:13<00:11,  3.90s/it]gen:  71%|███████▏  | 5/7 [00:15<00:06,  3.23s/it]gen:  86%|████████▌ | 6/7 [00:18<00:02,  3.00s/it]gen: 100%|██████████| 7/7 [00:20<00:00,  2.79s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.78s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.30s/it]jb_gen:  43%|████▎     | 3/7 [00:10<00:15,  3.81s/it]jb_gen:  57%|█████▋    | 4/7 [00:15<00:13,  4.52s/it]jb_gen:  71%|███████▏  | 5/7 [00:18<00:07,  3.92s/it]jb_gen:  86%|████████▌ | 6/7 [00:20<00:03,  3.32s/it]jb_gen: 100%|██████████| 7/7 [00:22<00:00,  2.78s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.48it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.70it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.53it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.89it/s]                                               Done in 101.4s
    uds: 0.7711
    em: 0.2880
    mia_loss: 0.4734

============================================================
[74/75] undial_lr3e4_b10_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.81it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.76it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.06it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.95it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.87it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:14,  2.42s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.20s/it]gen:  43%|████▎     | 3/7 [00:07<00:10,  2.66s/it]gen:  57%|█████▋    | 4/7 [00:10<00:08,  2.85s/it]gen:  71%|███████▏  | 5/7 [00:13<00:05,  2.65s/it]gen:  86%|████████▌ | 6/7 [00:15<00:02,  2.49s/it]gen: 100%|██████████| 7/7 [00:16<00:00,  2.17s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:12,  2.08s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.15s/it]jb_gen:  43%|████▎     | 3/7 [00:07<00:09,  2.50s/it]jb_gen:  57%|█████▋    | 4/7 [00:09<00:07,  2.38s/it]jb_gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.38s/it]jb_gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.22s/it]jb_gen: 100%|██████████| 7/7 [00:15<00:00,  1.95s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.55it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.52it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.49it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 89.9s
    uds: 0.7466
    em: 0.3831
    mia_loss: 0.5792

============================================================
[75/75] undial_lr3e4_b10_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_UNDIAL_lr0.0003_beta10_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.49it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.06it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.07it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.92it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.69it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.74it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.81it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.71it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.85it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.82it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.92it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.03it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.96it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.85it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.79it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.67it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.86s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.07s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.11s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.13s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.13s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.05s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.80s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.59s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.18s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.23s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.07s/it]jb_gen:  71%|███████▏  | 5/7 [00:13<00:06,  3.33s/it]jb_gen:  86%|████████▌ | 6/7 [00:15<00:02,  2.86s/it]jb_gen: 100%|██████████| 7/7 [00:17<00:00,  2.41s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]100%|██████████| 7/7 [00:03<00:00,  2.04it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.68it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.66it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               Done in 88.8s
    uds: 0.7902
    em: 0.4768
    mia_loss: 0.6267

============================================================
Done! Results saved to runs/meta_eval/robustness/quant/results.json
============================================================
