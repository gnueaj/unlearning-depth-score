Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
======================================================================
Robustness Meta-Evaluation: QUANT
======================================================================
GPU: 0
Models: 151 (1 retain + 150 unlearn)
Metrics: em, es, prob, paraprob, truth_ratio, rouge, para_rouge, jailbreak_rouge, mia_loss, mia_zlib, mia_min_k, mia_min_kpp, uds
Output: runs/meta_eval/robustness/quant
Clear cache: False

Loading tokenizer and full model...
UDS data: 367 valid examples
Loading S1 cache from runs/meta_eval/s1_cache_sdpa.json...
Resumed from runs/meta_eval/robustness/quant/results.json: 13 entries
Processing models [0:76] (76 models)

============================================================
[1/76] retain
  open-unlearning/tofu_Llama-3.2-1B-Instruct_retain90
============================================================
  Already computed, skipping

============================================================
[2/76] altpo_lr1e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[3/76] altpo_lr1e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[4/76] altpo_lr1e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[5/76] altpo_lr2e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[6/76] altpo_lr2e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[7/76] altpo_lr2e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[8/76] altpo_lr5e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha1_epoch5
============================================================
  Already computed, skipping

============================================================
[9/76] altpo_lr5e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha2_epoch5
============================================================
  Already computed, skipping

============================================================
[10/76] altpo_lr5e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha5_epoch5
============================================================
  Already computed, skipping

============================================================
[11/76] altpo_lr1e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha1_epoch10
============================================================
  Already computed, skipping

============================================================
[12/76] altpo_lr1e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha2_epoch10
============================================================
  Already computed, skipping

============================================================
[13/76] altpo_lr1e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr1e-05_beta0.1_alpha5_epoch10
============================================================
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.68it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.80it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.83it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.89it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.89it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.33it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.66it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.71it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.76it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.82it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.79it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.93it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.92it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.92it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.90it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.85it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:13,  1.72it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.72it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:11,  1.82it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.88it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  1.96it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.88it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.93it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.04it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.01it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.97it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.90it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:15<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.91it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.16s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.05s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.95s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.89s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.85s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.93s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.82s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.64s/it]jb_gen:  29%|██▊       | 2/7 [00:07<00:20,  4.08s/it]jb_gen:  43%|████▎     | 3/7 [00:09<00:12,  3.00s/it]jb_gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.44s/it]jb_gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.18s/it]jb_gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.06s/it]jb_gen: 100%|██████████| 7/7 [00:15<00:00,  1.79s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.68it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.63it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:03<00:00,  1.99it/s]                                               Done in 85.1s
    uds: 0.2998
    em: 0.8383
    mia_loss: 0.9816

============================================================
[14/76] altpo_lr2e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha1_epoch10
============================================================
  [Cache] Loaded 151 models from runs/method_eval/metrics_before.json
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.66it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.73it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.90it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.07it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.88it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.82it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.67it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.85it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.89it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.84it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.01it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.95it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.96s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.99s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.86s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.75s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.90s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.98s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.90s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.73s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.87s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.80s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.63s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.60s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.63s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.57s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.52it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:03<00:00,  2.03it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.64it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]100%|██████████| 7/7 [00:03<00:00,  2.00it/s]                                               Done in 82.3s
    uds: 0.6189
    em: 0.7052
    mia_loss: 0.8162

============================================================
[15/76] altpo_lr2e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.69it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.77it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.20it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.90it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.07it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.91it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.92it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.73it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.71it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.93it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.02it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.09it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.05it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.03it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.02it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.89it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.21s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.32s/it]gen:  43%|████▎     | 3/7 [00:06<00:07,  1.96s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.91s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.89s/it]gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.04s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.92s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.88s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.90s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.84s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.81s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.86s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.89s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.76s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.64it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 84.2s
    uds: 0.5934
    em: 0.7190
    mia_loss: 0.8573

============================================================
[16/76] altpo_lr2e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr2e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.60it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.70it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.06it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.87it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.87it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.92it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.09it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.04it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.03it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.01it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.87it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.74it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.89it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.74s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.93s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.82s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.80s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.83s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.87s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.76s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.85s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.20s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.91s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.85s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.72s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.85s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.76s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.50it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.72it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.65it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:03<00:00,  1.95it/s]                                               Done in 83.2s
    uds: 0.5150
    em: 0.7436
    mia_loss: 0.9111

============================================================
[17/76] altpo_lr5e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.65it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.46it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.65it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:16,  1.81it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.86it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.81it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.68it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.74it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.84it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.87it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.10it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.04it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.00it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.96it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.79it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.89it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:03<00:22,  3.76s/it]gen:  29%|██▊       | 2/7 [00:06<00:14,  2.89s/it]gen:  43%|████▎     | 3/7 [00:08<00:11,  2.75s/it]gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.35s/it]gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.27s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.28s/it]gen: 100%|██████████| 7/7 [00:18<00:00,  2.72s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:12,  2.12s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.10s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.94s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.96s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.14s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.24s/it]jb_gen: 100%|██████████| 7/7 [00:14<00:00,  2.21s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.72it/s] 29%|██▊       | 2/7 [00:01<00:02,  1.68it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.63it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 91.5s
    uds: 0.8674
    em: 0.5722
    mia_loss: 0.2778

============================================================
[18/76] altpo_lr5e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.66it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.78it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.79it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.20it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.90it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.99it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.76it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.92it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.77it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.80it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.61it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.71it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.95it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.94it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.92it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.02it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.10it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.05it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.85it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.73it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.72it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.01s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.53s/it]gen:  43%|████▎     | 3/7 [00:06<00:09,  2.26s/it]gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.25s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.10s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.12s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.99s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:12,  2.02s/it]jb_gen:  29%|██▊       | 2/7 [00:06<00:17,  3.46s/it]jb_gen:  43%|████▎     | 3/7 [00:08<00:11,  2.95s/it]jb_gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.58s/it]jb_gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.38s/it]jb_gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.24s/it]jb_gen: 100%|██████████| 7/7 [00:16<00:00,  2.17s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:02<00:07,  1.42s/it] 43%|████▎     | 3/7 [00:03<00:04,  1.02s/it] 57%|█████▋    | 4/7 [00:03<00:02,  1.17it/s] 71%|███████▏  | 5/7 [00:04<00:01,  1.31it/s] 86%|████████▌ | 6/7 [00:04<00:00,  1.42it/s]100%|██████████| 7/7 [00:05<00:00,  1.80it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.64it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]100%|██████████| 7/7 [00:03<00:00,  2.00it/s]                                               Done in 90.7s
    uds: 0.8298
    em: 0.5952
    mia_loss: 0.3658

============================================================
[19/76] altpo_lr5e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_AltPO_lr5e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.76it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.19it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.89it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.76it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.70it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.88it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.85it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.96it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.96it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.88it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.12s/it]gen:  29%|██▊       | 2/7 [00:05<00:13,  2.68s/it]gen:  43%|████▎     | 3/7 [00:07<00:10,  2.57s/it]gen:  57%|█████▋    | 4/7 [00:13<00:11,  3.74s/it]gen:  71%|███████▏  | 5/7 [00:14<00:06,  3.05s/it]gen:  86%|████████▌ | 6/7 [00:17<00:02,  2.70s/it]gen: 100%|██████████| 7/7 [00:19<00:00,  2.49s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:13,  2.30s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.27s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.05s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.95s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.80s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.84s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.88s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.53it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.49it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.64it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 90.6s
    uds: 0.7928
    em: 0.6254
    mia_loss: 0.5182

============================================================
[20/76] graddiff_lr1e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.68it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.93it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.76it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.04it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.81it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.65it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.92it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.03it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.94it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.96it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.75it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.79it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.68s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.06s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.88s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.72s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.76s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.85s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.69s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:13,  2.17s/it]jb_gen:  29%|██▊       | 2/7 [00:05<00:14,  2.87s/it]jb_gen:  43%|████▎     | 3/7 [00:10<00:15,  3.78s/it]jb_gen:  57%|█████▋    | 4/7 [00:12<00:08,  2.97s/it]jb_gen:  71%|███████▏  | 5/7 [00:14<00:05,  2.70s/it]jb_gen:  86%|████████▌ | 6/7 [00:17<00:02,  2.80s/it]jb_gen: 100%|██████████| 7/7 [00:18<00:00,  2.35s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.97it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.69it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.65it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.62it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               Done in 89.7s
    uds: 0.3551
    em: 0.7173
    mia_loss: 0.9022

============================================================
[21/76] graddiff_lr1e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.76it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.20it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.67it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.85it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.85it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.99it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.75s/it]gen:  29%|██▊       | 2/7 [00:05<00:13,  2.67s/it]gen:  43%|████▎     | 3/7 [00:07<00:09,  2.37s/it]gen:  57%|█████▋    | 4/7 [00:09<00:07,  2.48s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.29s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.31s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  2.07s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:12,  2.03s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.24s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.03s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.18s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.01s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.99s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.88s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.46it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.52it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.50it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               Done in 87.7s
    uds: 0.2480
    em: 0.7924
    mia_loss: 0.9598

============================================================
[22/76] graddiff_lr1e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.68it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.70it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.74it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.69it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.60it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.77it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.81it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.72it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.71it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.87it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.87it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.82it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.04it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.01it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.87it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.31s/it]gen:  29%|██▊       | 2/7 [00:05<00:13,  2.62s/it]gen:  43%|████▎     | 3/7 [00:08<00:11,  2.88s/it]gen:  57%|█████▋    | 4/7 [00:09<00:07,  2.39s/it]gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.16s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.11s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  1.86s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.97s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.92s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.73s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.71s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.66s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.75s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.78s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.97it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               Done in 85.5s
    uds: 0.1791
    em: 0.8566
    mia_loss: 0.9862

============================================================
[23/76] graddiff_lr2e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.68it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.84it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.92it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.10it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.05it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.00it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.83it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.81it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.73it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.71it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:15,  2.64s/it]gen:  29%|██▊       | 2/7 [00:08<00:22,  4.45s/it]gen:  43%|████▎     | 3/7 [00:10<00:13,  3.39s/it]gen:  57%|█████▋    | 4/7 [00:16<00:12,  4.24s/it]gen:  71%|███████▏  | 5/7 [00:18<00:07,  3.71s/it]gen:  86%|████████▌ | 6/7 [00:24<00:04,  4.37s/it]gen: 100%|██████████| 7/7 [00:25<00:00,  3.35s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:04<00:25,  4.33s/it]jb_gen:  29%|██▊       | 2/7 [00:10<00:25,  5.19s/it]jb_gen:  43%|████▎     | 3/7 [00:12<00:16,  4.06s/it]jb_gen:  57%|█████▋    | 4/7 [00:15<00:10,  3.55s/it]jb_gen:  71%|███████▏  | 5/7 [00:21<00:08,  4.30s/it]jb_gen:  86%|████████▌ | 6/7 [00:24<00:03,  3.95s/it]jb_gen: 100%|██████████| 7/7 [00:26<00:00,  3.18s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.66it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.66it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               Done in 110.3s
    uds: 0.8155
    em: 0.5080
    mia_loss: 0.2858

============================================================
[24/76] graddiff_lr2e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.71it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.55it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.65it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.74it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.86it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.84it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.79it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.02it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.88it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.72it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.58s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.66s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.61s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.59s/it]gen:  71%|███████▏  | 5/7 [00:27<00:11,  5.58s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.61s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.40s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:34,  5.67s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.75s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.69s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.66s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.65s/it]jb_gen:  86%|████████▌ | 6/7 [00:34<00:05,  5.68s/it]jb_gen: 100%|██████████| 7/7 [00:39<00:00,  5.45s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.47it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.66it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.52it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.49it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.87it/s]                                               Done in 135.8s
    uds: 0.8670
    em: 0.0572
    mia_loss: 0.0176

============================================================
[25/76] graddiff_lr2e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.66it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.69it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.59it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.06it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.78it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.89it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.88it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.80it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.87it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.04it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.95it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.87it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.59s/it]gen:  29%|██▊       | 2/7 [00:09<00:23,  4.73s/it]gen:  43%|████▎     | 3/7 [00:12<00:15,  3.99s/it]gen:  57%|█████▋    | 4/7 [00:14<00:09,  3.12s/it]gen:  71%|███████▏  | 5/7 [00:17<00:06,  3.09s/it]gen:  86%|████████▌ | 6/7 [00:21<00:03,  3.34s/it]gen: 100%|██████████| 7/7 [00:23<00:00,  2.98s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.64s/it]jb_gen:  29%|██▊       | 2/7 [00:07<00:17,  3.57s/it]jb_gen:  43%|████▎     | 3/7 [00:12<00:15,  3.94s/it]jb_gen:  57%|█████▋    | 4/7 [00:14<00:10,  3.49s/it]jb_gen:  71%|███████▏  | 5/7 [00:17<00:06,  3.31s/it]jb_gen:  86%|████████▌ | 6/7 [00:20<00:03,  3.04s/it]jb_gen: 100%|██████████| 7/7 [00:21<00:00,  2.54s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.46it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.60it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.55it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.62it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 107.3s
    uds: 0.5443
    em: 0.6578
    mia_loss: 0.5788

============================================================
[26/76] graddiff_lr5e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.68it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.60it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.87it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.66it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.75it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.80it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.84it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.78it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.70it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.72it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.62s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.67s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.61s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.59s/it]gen:  71%|███████▏  | 5/7 [00:27<00:11,  5.58s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.61s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.43s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.59s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.70s/it]jb_gen:  43%|████▎     | 3/7 [00:16<00:22,  5.66s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.64s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.64s/it]jb_gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.68s/it]jb_gen: 100%|██████████| 7/7 [00:39<00:00,  5.48s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.73it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.53it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.62it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.72it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.62it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 141.3s
    uds: 0.9681
    em: 0.0160
    mia_loss: 0.0006

============================================================
[27/76] graddiff_lr5e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.70it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.72it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:06<00:00,  1.25s/it]Mem eval (multi): 100%|██████████| 7/7 [00:06<00:00,  1.12it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.07it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.92it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.92it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.90it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.86it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.64it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.65s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.72s/it]gen:  43%|████▎     | 3/7 [00:17<00:22,  5.66s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.64s/it]gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.65s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.67s/it]gen: 100%|██████████| 7/7 [00:39<00:00,  5.47s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:34,  5.70s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.78s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.73s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:17,  5.71s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.71s/it]jb_gen:  86%|████████▌ | 6/7 [00:34<00:05,  5.84s/it]jb_gen: 100%|██████████| 7/7 [00:39<00:00,  5.60s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.51it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.31it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.40it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.43it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:04<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.65it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.87it/s]                                               Done in 143.2s
    uds: 0.9677
    em: 0.0232
    mia_loss: 0.0161

============================================================
[28/76] graddiff_lr5e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.69it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.80it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.81it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.93it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.85it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.71it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.87it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.83it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.92it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.82it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.88it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.83it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.62s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.68s/it]gen:  43%|████▎     | 3/7 [00:17<00:23,  5.91s/it]gen:  57%|█████▋    | 4/7 [00:26<00:21,  7.07s/it]gen:  71%|███████▏  | 5/7 [00:34<00:15,  7.54s/it]gen:  86%|████████▌ | 6/7 [00:41<00:07,  7.27s/it]gen: 100%|██████████| 7/7 [00:46<00:00,  6.54s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:34,  5.67s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:29,  5.90s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:23,  5.80s/it]jb_gen:  57%|█████▋    | 4/7 [00:23<00:17,  5.74s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.71s/it]jb_gen:  86%|████████▌ | 6/7 [00:34<00:05,  5.72s/it]jb_gen: 100%|██████████| 7/7 [00:39<00:00,  5.48s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.65it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.50it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.52it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.46it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.83it/s]                                               Done in 154.0s
    uds: 0.9634
    em: 0.0282
    mia_loss: 0.0012

============================================================
[29/76] graddiff_lr1e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.50it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]Mem eval (multi): 100%|██████████| 7/7 [00:04<00:00,  2.01it/s]Mem eval (multi): 100%|██████████| 7/7 [00:04<00:00,  1.75it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.75it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.69it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.81it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.89it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.79it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.81it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.90it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.01it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.92it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.93it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.72it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.72it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.73s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.94s/it]gen:  43%|████▎     | 3/7 [00:05<00:08,  2.02s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.83s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.81s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.89s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.84s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.98s/it]jb_gen:  29%|██▊       | 2/7 [00:06<00:17,  3.45s/it]jb_gen:  43%|████▎     | 3/7 [00:08<00:11,  2.90s/it]jb_gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.64s/it]jb_gen:  71%|███████▏  | 5/7 [00:16<00:07,  3.72s/it]jb_gen:  86%|████████▌ | 6/7 [00:18<00:03,  3.22s/it]jb_gen: 100%|██████████| 7/7 [00:20<00:00,  2.82s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.53it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.73it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.62it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 92.7s
    uds: 0.3624
    em: 0.7125
    mia_loss: 0.8959

============================================================
[30/76] graddiff_lr1e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.66it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.60it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.84it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.73it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.65it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.74it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.68it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.83it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.09it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.04it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.00it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.97it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.89it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.79it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.66s/it]gen:  29%|██▊       | 2/7 [00:05<00:13,  2.76s/it]gen:  43%|████▎     | 3/7 [00:06<00:09,  2.27s/it]gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.95s/it]gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.95s/it]gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.91s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.80s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:04<00:24,  4.05s/it]jb_gen:  29%|██▊       | 2/7 [00:06<00:14,  2.97s/it]jb_gen:  43%|████▎     | 3/7 [00:08<00:10,  2.55s/it]jb_gen:  57%|█████▋    | 4/7 [00:10<00:06,  2.23s/it]jb_gen:  71%|███████▏  | 5/7 [00:11<00:04,  2.03s/it]jb_gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.12s/it]jb_gen: 100%|██████████| 7/7 [00:15<00:00,  1.96s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.42it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.54it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               Done in 87.6s
    uds: 0.2565
    em: 0.7865
    mia_loss: 0.9559

============================================================
[31/76] graddiff_lr1e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr1e-05_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.65it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.70it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.77it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.91it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.71it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.76it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.72it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.60it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.75it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.88it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.82it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.94it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.07s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.45s/it]gen:  43%|████▎     | 3/7 [00:08<00:12,  3.18s/it]gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.64s/it]gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.30s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.24s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  1.99s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.96s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:12,  2.48s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.03s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.88s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.76s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.90s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.75s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 87.1s
    uds: 0.1818
    em: 0.8557
    mia_loss: 0.9858

============================================================
[32/76] graddiff_lr2e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.83it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.67it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.75it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.84it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.96it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.90it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.95it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.93it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.03it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.10it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.04it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.03it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.01it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.87it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.90it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.54s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.63s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.58s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.56s/it]gen:  71%|███████▏  | 5/7 [00:27<00:11,  5.56s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.58s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.38s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.63s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.72s/it]jb_gen:  43%|████▎     | 3/7 [00:17<00:22,  5.66s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.65s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.64s/it]jb_gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.66s/it]jb_gen: 100%|██████████| 7/7 [00:38<00:00,  5.44s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.50it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.50it/s]100%|██████████| 7/7 [00:04<00:00,  1.87it/s]                                               Done in 134.8s
    uds: 0.8253
    em: 0.1419
    mia_loss: 0.0258

============================================================
[33/76] graddiff_lr2e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.62it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.75it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.59it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.76it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.80it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.84it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.95it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.94it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.88it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.00it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.97it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.77it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.76it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.80it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.18it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.90it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.58s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.64s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.59s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.55s/it]gen:  71%|███████▏  | 5/7 [00:27<00:11,  5.55s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.58s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.38s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.62s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.71s/it]jb_gen:  43%|████▎     | 3/7 [00:16<00:22,  5.65s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.62s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.62s/it]jb_gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.64s/it]jb_gen: 100%|██████████| 7/7 [00:38<00:00,  5.42s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.48it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.51it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.63it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.51it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 134.4s
    uds: 0.9291
    em: 0.0135
    mia_loss: 0.0003

============================================================
[34/76] graddiff_lr2e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr2e-05_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.65it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.75it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.76it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.78it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.93it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.06it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.07it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.92it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.87it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.83it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.65it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.71it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.84it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.96it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.89it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.88it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.94it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.03it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.11it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.06it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.96it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.88it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.79it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:15<00:01,  1.78it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.90it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.54s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.63s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.57s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.55s/it]gen:  71%|███████▏  | 5/7 [00:27<00:11,  5.55s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.58s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.37s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.60s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.69s/it]jb_gen:  43%|████▎     | 3/7 [00:16<00:22,  5.64s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.62s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.61s/it]jb_gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.64s/it]jb_gen: 100%|██████████| 7/7 [00:38<00:00,  5.41s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.73it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.51it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]100%|██████████| 7/7 [00:03<00:00,  2.05it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 134.1s
    uds: 0.8405
    em: 0.0501
    mia_loss: 0.0243

============================================================
[35/76] graddiff_lr5e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.66it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.71it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.73it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.78it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.80it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.19it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.92it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.92it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.88it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.83it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.71it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.75it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.81it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:05<00:11,  1.83it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.87it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  1.95it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:07<00:08,  1.94it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.92it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.02it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.11it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.04it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.96it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.98it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.89it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.79it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.77it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.79it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.18it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.92it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.53s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.61s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.56s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.54s/it]gen:  71%|███████▏  | 5/7 [00:27<00:11,  5.54s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.57s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.36s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.55s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.67s/it]jb_gen:  43%|████▎     | 3/7 [00:16<00:22,  5.64s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.63s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.63s/it]jb_gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.67s/it]jb_gen: 100%|██████████| 7/7 [00:38<00:00,  5.44s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.79it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]100%|██████████| 7/7 [00:03<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.63it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:03<00:00,  2.00it/s]                                               Done in 139.5s
    uds: 0.9705
    em: 0.0061
    mia_loss: 0.0000

============================================================
[36/76] graddiff_lr5e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.66it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.69it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.74it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.81it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.81it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.24it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.94it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.89it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.84it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.65it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.71it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.94it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.89it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.87it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.04it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.03it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.01it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.98it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.90it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.83it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.80it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:15<00:01,  1.78it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.81it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.20it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.91it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.53s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.62s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.56s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.53s/it]gen:  71%|███████▏  | 5/7 [00:27<00:11,  5.53s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.56s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.36s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.61s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.70s/it]jb_gen:  43%|████▎     | 3/7 [00:16<00:22,  5.64s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.61s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.61s/it]jb_gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.63s/it]jb_gen: 100%|██████████| 7/7 [00:38<00:00,  5.41s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:04<00:00,  2.00it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.61it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               Done in 133.8s
    uds: 0.9726
    em: 0.0039
    mia_loss: 0.0173

============================================================
[37/76] graddiff_lr5e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_GradDiff_lr5e-05_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.64it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.70it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.64it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.07it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.85it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.68it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.82it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.94it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.87it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.95it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.04it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.12it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.07it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.05it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.01it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.97it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.89it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.83it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.80it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:15<00:01,  1.78it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.82it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.20it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.92it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:05<00:33,  5.53s/it]gen:  29%|██▊       | 2/7 [00:11<00:28,  5.62s/it]gen:  43%|████▎     | 3/7 [00:16<00:22,  5.56s/it]gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.54s/it]gen:  71%|███████▏  | 5/7 [00:27<00:11,  5.53s/it]gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.56s/it]gen: 100%|██████████| 7/7 [00:38<00:00,  5.36s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.55s/it]jb_gen:  29%|██▊       | 2/7 [00:11<00:28,  5.67s/it]jb_gen:  43%|████▎     | 3/7 [00:16<00:22,  5.65s/it]jb_gen:  57%|█████▋    | 4/7 [00:22<00:16,  5.63s/it]jb_gen:  71%|███████▏  | 5/7 [00:28<00:11,  5.63s/it]jb_gen:  86%|████████▌ | 6/7 [00:33<00:05,  5.66s/it]jb_gen: 100%|██████████| 7/7 [00:38<00:00,  5.44s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]100%|██████████| 7/7 [00:03<00:00,  2.02it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.58it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 138.6s
    uds: 0.9637
    em: 0.0297
    mia_loss: 0.0036

============================================================
[38/76] idkdpo_lr1e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.66it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.80it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.78it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.94it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.58it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.07it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.69it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.71it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.86it/s]Mem eval (multi):  41%|████      | 13/32 [00:06<00:09,  1.98it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.89it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.88it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.00it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.88it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.75it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.80it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.18it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.90it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.59s/it]gen:  29%|██▊       | 2/7 [00:02<00:07,  1.45s/it]gen:  43%|████▎     | 3/7 [00:04<00:05,  1.48s/it]gen:  57%|█████▋    | 4/7 [00:05<00:04,  1.50s/it]gen:  71%|███████▏  | 5/7 [00:07<00:02,  1.37s/it]gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.43s/it]gen: 100%|██████████| 7/7 [00:10<00:00,  1.48s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.81s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.73s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.70s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.61s/it]jb_gen:  71%|███████▏  | 5/7 [00:07<00:03,  1.52s/it]jb_gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.69s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.64s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]100%|██████████| 7/7 [00:03<00:00,  2.03it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.68it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]100%|██████████| 7/7 [00:03<00:00,  1.99it/s]                                               Done in 78.9s
    uds: 0.2861
    em: 0.7912
    mia_loss: 0.9707

============================================================
[39/76] idkdpo_lr1e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.93it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.66it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.78it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.75it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.79it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.93it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.92it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.81it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.86it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.96it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.89it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.88it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.79it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.75it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.79it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.17it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.89it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.60s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.82s/it]gen:  43%|████▎     | 3/7 [00:09<00:14,  3.52s/it]gen:  57%|█████▋    | 4/7 [00:10<00:08,  2.74s/it]gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.38s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.13s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  1.90s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.74s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.68s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.87s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:05,  1.71s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.67s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.71s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.65s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.53it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]100%|██████████| 7/7 [00:03<00:00,  2.01it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.54it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               Done in 84.5s
    uds: 0.2514
    em: 0.8152
    mia_loss: 0.9786

============================================================
[40/76] idkdpo_lr1e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.67it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.79it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.77it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.78it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.22it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.94it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.79it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.87it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.83it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.70it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.75it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.82it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.72it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:10,  1.77it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.87it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.80it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.87it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.96it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.84it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.78it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.87s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.05s/it]gen:  43%|████▎     | 3/7 [00:09<00:14,  3.64s/it]gen:  57%|█████▋    | 4/7 [00:11<00:08,  2.80s/it]gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.47s/it]gen:  86%|████████▌ | 6/7 [00:15<00:02,  2.38s/it]gen: 100%|██████████| 7/7 [00:16<00:00,  2.06s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.91s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.19s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.88s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.70s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.74s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.80s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.74s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]100%|██████████| 7/7 [00:03<00:00,  2.03it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.67it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.66it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]100%|██████████| 7/7 [00:03<00:00,  1.99it/s]                                               Done in 86.7s
    uds: 0.2131
    em: 0.8335
    mia_loss: 0.9833

============================================================
[41/76] idkdpo_lr2e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.70it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.65it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.72it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.54it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.70it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.77it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.72it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.09it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.96it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.89it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.96s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.16s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.76s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.61s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.59s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.70s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.64s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.92s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.09s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.00s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.77s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.72s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.72s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.63s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.63it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:03<00:00,  1.99it/s]                                               Done in 81.9s
    uds: 0.5541
    em: 0.6948
    mia_loss: 0.8587

============================================================
[42/76] idkdpo_lr2e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.76it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.52it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.62it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.78it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.85it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.84it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.82it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.89it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.83it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.95it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.85it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.73it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.87s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.06s/it]gen:  43%|████▎     | 3/7 [00:09<00:14,  3.65s/it]gen:  57%|█████▋    | 4/7 [00:12<00:09,  3.19s/it]gen:  71%|███████▏  | 5/7 [00:13<00:05,  2.61s/it]gen:  86%|████████▌ | 6/7 [00:15<00:02,  2.33s/it]gen: 100%|██████████| 7/7 [00:16<00:00,  2.02s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:03<00:18,  3.08s/it]jb_gen:  29%|██▊       | 2/7 [00:05<00:12,  2.40s/it]jb_gen:  43%|████▎     | 3/7 [00:07<00:09,  2.27s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.98s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.90s/it]jb_gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.13s/it]jb_gen: 100%|██████████| 7/7 [00:14<00:00,  1.88s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.51it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:03<00:00,  1.97it/s]                                               Done in 89.1s
    uds: 0.4646
    em: 0.7264
    mia_loss: 0.9138

============================================================
[43/76] idkdpo_lr2e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.58it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.78it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.74it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.66it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.85it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.77it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.74it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.65it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.65it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.74it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.70it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.83it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.82it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.95it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.74it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.22s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.11s/it]gen:  43%|████▎     | 3/7 [00:09<00:13,  3.38s/it]gen:  57%|█████▋    | 4/7 [00:11<00:08,  2.97s/it]gen:  71%|███████▏  | 5/7 [00:13<00:04,  2.50s/it]gen:  86%|████████▌ | 6/7 [00:15<00:02,  2.45s/it]gen: 100%|██████████| 7/7 [00:17<00:00,  2.26s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.75s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.78s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.74s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:05,  1.72s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.72s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.88s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.73s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.48it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.65it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 88.0s
    uds: 0.3530
    em: 0.7705
    mia_loss: 0.9555

============================================================
[44/76] idkdpo_lr5e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.53it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.79it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.71it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:09,  1.77it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.82it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.90it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.01it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.91it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:12,  2.02s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.99s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.81s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.67s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.80s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.89s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.70s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.94s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.94s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.94s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.84s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.74s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.81s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.62s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:04<00:00,  2.00it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.65it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.62it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 82.8s
    uds: 0.7216
    em: 0.6187
    mia_loss: 0.5510

============================================================
[45/76] idkdpo_lr5e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.81it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.71it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.06it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.07it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.65it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.74it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.85it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.85it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.87it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.88it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.85it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.56s/it]gen:  29%|██▊       | 2/7 [00:03<00:08,  1.61s/it]gen:  43%|████▎     | 3/7 [00:04<00:06,  1.65s/it]gen:  57%|█████▋    | 4/7 [00:06<00:05,  1.71s/it]gen:  71%|███████▏  | 5/7 [00:09<00:04,  2.03s/it]gen:  86%|████████▌ | 6/7 [00:11<00:02,  2.16s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.95s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.63s/it]jb_gen:  29%|██▊       | 2/7 [00:07<00:18,  3.65s/it]jb_gen:  43%|████▎     | 3/7 [00:09<00:10,  2.62s/it]jb_gen:  57%|█████▋    | 4/7 [00:10<00:06,  2.13s/it]jb_gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.16s/it]jb_gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.02s/it]jb_gen: 100%|██████████| 7/7 [00:15<00:00,  1.77s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.55it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.49it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               Done in 87.2s
    uds: 0.6618
    em: 0.6496
    mia_loss: 0.6902

============================================================
[46/76] idkdpo_lr5e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.77it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.00it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.77it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.87it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.87it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.62it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.87it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.79it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.95it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.88it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.82it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.72it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.73it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.78it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.70s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.24s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.06s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.06s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.93s/it]gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.99s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.77s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.69s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.81s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.85s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.77s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.77s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.76s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.67s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.97it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.51it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 83.6s
    uds: 0.5757
    em: 0.6838
    mia_loss: 0.8161

============================================================
[47/76] idkdpo_lr1e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.92it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.68it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.72it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.09it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.04it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.99it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.61s/it]gen:  29%|██▊       | 2/7 [00:03<00:07,  1.56s/it]gen:  43%|████▎     | 3/7 [00:04<00:05,  1.35s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.53s/it]gen:  71%|███████▏  | 5/7 [00:07<00:02,  1.40s/it]gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.50s/it]gen: 100%|██████████| 7/7 [00:10<00:00,  1.46s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.71s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.69s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.68s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.58s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.57s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.75s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.69s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.73it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.62it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.52it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 79.7s
    uds: 0.2879
    em: 0.7909
    mia_loss: 0.9701

============================================================
[48/76] idkdpo_lr1e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.59it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.65it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.72it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.71it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.87it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.87it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.94it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.96it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.67it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.61s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.83s/it]gen:  43%|████▎     | 3/7 [00:09<00:14,  3.53s/it]gen:  57%|█████▋    | 4/7 [00:10<00:08,  2.73s/it]gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.38s/it]gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.13s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  1.81s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.64s/it]jb_gen:  29%|██▊       | 2/7 [00:08<00:19,  3.86s/it]jb_gen:  43%|████▎     | 3/7 [00:09<00:11,  2.79s/it]jb_gen:  57%|█████▋    | 4/7 [00:11<00:06,  2.31s/it]jb_gen:  71%|███████▏  | 5/7 [00:13<00:04,  2.11s/it]jb_gen:  86%|████████▌ | 6/7 [00:15<00:02,  2.05s/it]jb_gen: 100%|██████████| 7/7 [00:16<00:00,  1.89s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.59it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 90.0s
    uds: 0.2539
    em: 0.8131
    mia_loss: 0.9779

============================================================
[49/76] idkdpo_lr1e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.49it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.77it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.00it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.63it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.76it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.83s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.95s/it]gen:  43%|████▎     | 3/7 [00:08<00:13,  3.35s/it]gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.60s/it]gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.34s/it]gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.12s/it]gen: 100%|██████████| 7/7 [00:15<00:00,  1.89s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.84s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.12s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.84s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.67s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.71s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.79s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.73s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.41it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.47it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.97it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.67it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.56it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.51it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.54it/s]100%|██████████| 7/7 [00:04<00:00,  1.88it/s]                                               Done in 86.0s
    uds: 0.2147
    em: 0.8327
    mia_loss: 0.9831

============================================================
[50/76] idkdpo_lr2e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.64it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.65it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.67it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.60it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.70it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.82it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.85it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.85it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.73it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.65it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.70it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.88it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.92it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:09,  1.74it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.80it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.89it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.01it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.92it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.77it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.84it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.78s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.08s/it]gen:  43%|████▎     | 3/7 [00:05<00:06,  1.69s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.61s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.60s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.70s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.61s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.97s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:10,  2.15s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.80s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.69s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.76s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.73s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.62s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.83it/s]                                               Done in 82.2s
    uds: 0.5550
    em: 0.6938
    mia_loss: 0.8509

============================================================
[51/76] idkdpo_lr2e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.52it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.87it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.74it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.88it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.83it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.80it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:16,  2.72s/it]gen:  29%|██▊       | 2/7 [00:04<00:11,  2.30s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.06s/it]gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.15s/it]gen:  71%|███████▏  | 5/7 [00:10<00:04,  2.02s/it]gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.96s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.78s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.71s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:12,  2.45s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:09,  2.33s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.13s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.96s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:02,  2.17s/it]jb_gen: 100%|██████████| 7/7 [00:14<00:00,  1.97s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.42it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.72it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 87.0s
    uds: 0.4665
    em: 0.7258
    mia_loss: 0.9086

============================================================
[52/76] idkdpo_lr2e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr2e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.74it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.55it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.77it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.89it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.83it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.80it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.94it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.81it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.67it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.71it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:02<00:13,  2.33s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.07s/it]gen:  43%|████▎     | 3/7 [00:09<00:14,  3.66s/it]gen:  57%|█████▋    | 4/7 [00:11<00:08,  2.90s/it]gen:  71%|███████▏  | 5/7 [00:13<00:05,  2.58s/it]gen:  86%|████████▌ | 6/7 [00:15<00:02,  2.39s/it]gen: 100%|██████████| 7/7 [00:17<00:00,  2.23s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.70s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.30s/it]jb_gen:  43%|████▎     | 3/7 [00:06<00:08,  2.09s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.86s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.84s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:02,  2.00s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.78s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.67it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               Done in 89.6s
    uds: 0.3626
    em: 0.7710
    mia_loss: 0.9527

============================================================
[53/76] idkdpo_lr5e5_b01_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.73it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.76it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.04it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.80it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:15,  1.59it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.63it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.69it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.84it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.78it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.84it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.91it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.94it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.84it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.73it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.78it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.76s/it]gen:  29%|██▊       | 2/7 [00:03<00:08,  1.65s/it]gen:  43%|████▎     | 3/7 [00:04<00:06,  1.53s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.45s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.63s/it]gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.63s/it]gen: 100%|██████████| 7/7 [00:10<00:00,  1.54s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.72s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.78s/it]jb_gen:  43%|████▎     | 3/7 [00:09<00:14,  3.53s/it]jb_gen:  57%|█████▋    | 4/7 [00:10<00:07,  2.63s/it]jb_gen:  71%|███████▏  | 5/7 [00:12<00:04,  2.32s/it]jb_gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.18s/it]jb_gen: 100%|██████████| 7/7 [00:15<00:00,  1.98s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:04,  1.19it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.41it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.43it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.48it/s] 86%|████████▌ | 6/7 [00:04<00:00,  1.52it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.66it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.56it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 85.5s
    uds: 0.7268
    em: 0.6175
    mia_loss: 0.5339

============================================================
[54/76] idkdpo_lr5e5_b01_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.68it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.77it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.70it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.85it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.81it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.89it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.85it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.88it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.81it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.71it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.67it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.86s/it]gen:  29%|██▊       | 2/7 [00:03<00:08,  1.76s/it]gen:  43%|████▎     | 3/7 [00:05<00:06,  1.69s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.63s/it]gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.77s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.97s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.83s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.91s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.88s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.71s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.75s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.75s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.77s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.66s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.49it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.52it/s]100%|██████████| 7/7 [00:04<00:00,  1.87it/s]                                               Done in 83.2s
    uds: 0.6705
    em: 0.6472
    mia_loss: 0.6653

============================================================
[55/76] idkdpo_lr5e5_b01_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr5e-05_beta0.1_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.48it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.68it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.91it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.82it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.69it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.70it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.88s/it]gen:  29%|██▊       | 2/7 [00:04<00:10,  2.16s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.92s/it]gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.75s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.77s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.80s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.64s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.77s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.86s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.62s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.57s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.77s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.89s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.69s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:04,  1.25it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.44it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.45it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:04<00:00,  1.51it/s]100%|██████████| 7/7 [00:04<00:00,  1.89it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.73it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.62it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.62it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               Done in 82.9s
    uds: 0.5822
    em: 0.6850
    mia_loss: 0.7998

============================================================
[56/76] idknll_lr1e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr1e-05_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.92it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.59it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.10it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.83it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.78it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.69it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.90it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:10,  1.77it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.86it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:09,  1.76it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.82it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.87it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.88it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.96it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.68it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:07,  1.33s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.37s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.16s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.18s/it]gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.18s/it]gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.44s/it]gen: 100%|██████████| 7/7 [00:08<00:00,  1.07s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.60s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:07,  1.59s/it]jb_gen:  43%|████▎     | 3/7 [00:04<00:06,  1.54s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.49s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.65s/it]jb_gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.66s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.60s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.49it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 77.7s
    uds: 0.1926
    em: 0.8426
    mia_loss: 0.9874

============================================================
[57/76] idknll_lr1e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr1e-05_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.94it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.69it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.77it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.92it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.80it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.62it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.71it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.80it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.99it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.90it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.90it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.95it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.87it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.80it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.77it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.75it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.57s/it]gen:  29%|██▊       | 2/7 [00:05<00:15,  3.00s/it]gen:  43%|████▎     | 3/7 [00:06<00:08,  2.15s/it]gen:  57%|█████▋    | 4/7 [00:08<00:05,  1.99s/it]gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.69s/it]gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.72s/it]gen: 100%|██████████| 7/7 [00:12<00:00,  1.63s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.73s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.75s/it]jb_gen:  43%|████▎     | 3/7 [00:04<00:06,  1.63s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.55s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.60s/it]jb_gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.67s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.57s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.54it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.52it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               Done in 82.0s
    uds: 0.1842
    em: 0.8487
    mia_loss: 0.9883

============================================================
[58/76] idknll_lr1e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr1e-05_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.64it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.71it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.80it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.68it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.73it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.79it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.76it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.87it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.92it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.09it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.04it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.00it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.78it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.85s/it]gen:  29%|██▊       | 2/7 [00:04<00:12,  2.60s/it]gen:  43%|████▎     | 3/7 [00:07<00:11,  2.79s/it]gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.26s/it]gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.98s/it]gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.94s/it]gen: 100%|██████████| 7/7 [00:14<00:00,  1.78s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.85s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.92s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.75s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.62s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.68s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.78s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.73s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.49it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]100%|██████████| 7/7 [00:04<00:00,  2.01it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.75it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.61it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.96it/s]                                               Done in 84.1s
    uds: 0.1801
    em: 0.8550
    mia_loss: 0.9887

============================================================
[59/76] idknll_lr2e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr2e-05_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.68it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.77it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.01it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.61it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.84it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.96it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.89it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.89it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.99it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.97it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.89it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.79it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.89it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.02s/it]gen:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]gen:  43%|████▎     | 3/7 [00:01<00:02,  1.88it/s]gen:  57%|█████▋    | 4/7 [00:02<00:01,  2.14it/s]gen:  71%|███████▏  | 5/7 [00:03<00:01,  1.38it/s]gen:  86%|████████▌ | 6/7 [00:04<00:00,  1.27it/s]gen: 100%|██████████| 7/7 [00:04<00:00,  1.61it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.93s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.69s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.77s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.60s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.69s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.74s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.60s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.62it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:04<00:00,  2.01it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.63it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.58it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.65it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 73.6s
    uds: 0.2299
    em: 0.8255
    mia_loss: 0.9842

============================================================
[60/76] idknll_lr2e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr2e-05_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval:  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.81it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.69it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:04<00:13,  1.75it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.81it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.72it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.80it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.92it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.80it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.09it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.97it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.96it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.89it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.89it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:07,  1.18s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.39s/it]gen:  43%|████▎     | 3/7 [00:03<00:05,  1.30s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.18s/it]gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.19s/it]gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.33s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.02it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.88s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.84s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.77s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.63s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.69s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.73s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.60s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.52it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]100%|██████████| 7/7 [00:04<00:00,  2.01it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.73it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]100%|██████████| 7/7 [00:03<00:00,  1.97it/s]                                               Done in 77.6s
    uds: 0.2169
    em: 0.8305
    mia_loss: 0.9854

============================================================
[61/76] idknll_lr2e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr2e-05_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.66it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.73it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.70it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.06it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.86it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.71it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.95it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.89it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.82it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.98it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.03it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.99it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.97it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.77it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.41s/it]gen:  29%|██▊       | 2/7 [00:03<00:07,  1.53s/it]gen:  43%|████▎     | 3/7 [00:04<00:06,  1.53s/it]gen:  57%|█████▋    | 4/7 [00:05<00:04,  1.45s/it]gen:  71%|███████▏  | 5/7 [00:07<00:02,  1.37s/it]gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.53s/it]gen: 100%|██████████| 7/7 [00:10<00:00,  1.46s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.73s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.69s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.93s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.78s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.63s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.67s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.51s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.50it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.52it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               Done in 79.6s
    uds: 0.2106
    em: 0.8342
    mia_loss: 0.9863

============================================================
[62/76] idknll_lr5e5_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr5e-05_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.87it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.62it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.76it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.76it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.74it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.13it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.89it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.58it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.70it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.03it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.06it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.84it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.75it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.79it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.85it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.82it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.85it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.01it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.94it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.78it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.68it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.35it/s]gen:  29%|██▊       | 2/7 [00:01<00:02,  1.77it/s]gen:  43%|████▎     | 3/7 [00:01<00:01,  2.05it/s]gen:  57%|█████▋    | 4/7 [00:01<00:01,  2.22it/s]gen:  71%|███████▏  | 5/7 [00:02<00:00,  2.17it/s]gen:  86%|████████▌ | 6/7 [00:02<00:00,  2.24it/s]gen: 100%|██████████| 7/7 [00:03<00:00,  2.51it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.56s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.62s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.72s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.64s/it]jb_gen:  71%|███████▏  | 5/7 [00:07<00:03,  1.51s/it]jb_gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.56s/it]jb_gen: 100%|██████████| 7/7 [00:10<00:00,  1.45s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.40it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.46it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.61it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.55it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.64it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 71.6s
    uds: 0.3617
    em: 0.7625
    mia_loss: 0.9563

============================================================
[63/76] idknll_lr5e5_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr5e-05_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.70it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.77it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.90it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.74it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.83it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.67it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.88it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.82it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.94it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.96it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.92it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.79it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.67s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.36s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.17s/it]gen:  57%|█████▋    | 4/7 [00:04<00:02,  1.16it/s]gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.11it/s]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.06s/it]gen: 100%|██████████| 7/7 [00:06<00:00,  1.24it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.84s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.78s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.71s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.59s/it]jb_gen:  71%|███████▏  | 5/7 [00:07<00:03,  1.50s/it]jb_gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.46s/it]jb_gen: 100%|██████████| 7/7 [00:10<00:00,  1.47s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.47it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.66it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.62it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.64it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]100%|██████████| 7/7 [00:03<00:00,  1.99it/s]                                               Done in 75.6s
    uds: 0.3826
    em: 0.7653
    mia_loss: 0.9563

============================================================
[64/76] idknll_lr5e5_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr5e-05_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.69it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.64it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.76it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.60it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.75it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.72it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.81it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.78it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.87it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.84it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.92it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.01it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.85it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.74it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.68it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.36s/it]gen:  29%|██▊       | 2/7 [00:03<00:07,  1.56s/it]gen:  43%|████▎     | 3/7 [00:04<00:05,  1.37s/it]gen:  57%|█████▋    | 4/7 [00:05<00:03,  1.24s/it]gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.30s/it]gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.38s/it]gen: 100%|██████████| 7/7 [00:09<00:00,  1.32s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.88s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.79s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.72s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:05,  1.72s/it]jb_gen:  71%|███████▏  | 5/7 [00:12<00:06,  3.14s/it]jb_gen:  86%|████████▌ | 6/7 [00:14<00:02,  2.64s/it]jb_gen: 100%|██████████| 7/7 [00:15<00:00,  2.26s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.73it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.47it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.52it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.62it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.57it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.60it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.53it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 82.9s
    uds: 0.3535
    em: 0.7710
    mia_loss: 0.9615

============================================================
[65/76] idknll_lr1e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr1e-05_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.88it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.56it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.69it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.76it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.76it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.19it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.89it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.88it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.83it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.77it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.93it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.87it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.01it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.10it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.99it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.81it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.34s/it]gen:  29%|██▊       | 2/7 [00:03<00:07,  1.56s/it]gen:  43%|████▎     | 3/7 [00:04<00:05,  1.40s/it]gen:  57%|█████▋    | 4/7 [00:05<00:03,  1.31s/it]gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.19s/it]gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.33s/it]gen: 100%|██████████| 7/7 [00:08<00:00,  1.00it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.64s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.72s/it]jb_gen:  43%|████▎     | 3/7 [00:04<00:06,  1.62s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.55s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.69s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.80s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.60s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  2.00it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.61it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.55it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.58it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 77.9s
    uds: 0.1911
    em: 0.8422
    mia_loss: 0.9874

============================================================
[66/76] idknll_lr1e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr1e-05_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.92it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.76it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.78it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.21it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.91it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.60it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.71it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.69it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.70it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.84it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:15,  1.71it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.72it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:15,  1.59it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.67it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:13,  1.68it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.73it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.81it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.86it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.83it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.84it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.82it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.86it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.07it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.02it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.00it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.80it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.87it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.82it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.66it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.09it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.47s/it]gen:  29%|██▊       | 2/7 [00:03<00:10,  2.02s/it]gen:  43%|████▎     | 3/7 [00:05<00:07,  1.83s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.64s/it]gen:  71%|███████▏  | 5/7 [00:08<00:02,  1.50s/it]gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.64s/it]gen: 100%|██████████| 7/7 [00:11<00:00,  1.64s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.70s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:08,  1.74s/it]jb_gen:  43%|████▎     | 3/7 [00:04<00:06,  1.63s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.55s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.66s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.91s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.74s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.41it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.90it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.60it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               Done in 81.9s
    uds: 0.1839
    em: 0.8495
    mia_loss: 0.9883

============================================================
[67/76] idknll_lr1e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr1e-05_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.18it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.73it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.51it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval (multi): 100%|██████████| 7/7 [00:04<00:00,  1.87it/s]Mem eval (multi): 100%|██████████| 7/7 [00:04<00:00,  1.74it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.67it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.78it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.87it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.92it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.10it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.04it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.00it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.86it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.67it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.74it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.88it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:11,  1.87s/it]gen:  29%|██▊       | 2/7 [00:05<00:14,  2.86s/it]gen:  43%|████▎     | 3/7 [00:07<00:10,  2.58s/it]gen:  57%|█████▋    | 4/7 [00:09<00:06,  2.13s/it]gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.84s/it]gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.84s/it]gen: 100%|██████████| 7/7 [00:13<00:00,  1.71s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.79s/it]jb_gen:  29%|██▊       | 2/7 [00:04<00:11,  2.21s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.97s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.74s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.73s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.77s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.72s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.54it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:04<00:00,  2.00it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.70it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.62it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.63it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.61it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:03<00:00,  1.96it/s]                                               Done in 84.3s
    uds: 0.1789
    em: 0.8568
    mia_loss: 0.9888

============================================================
[68/76] idknll_lr2e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr2e-05_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.93it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.68it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.71it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.78it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.89it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.85it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.87it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.75it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:15,  1.60it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.67it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.75it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.70it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.89it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:09,  1.73it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.79it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.89it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.92it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:13<00:04,  1.90it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.85it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:14<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.79it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.45it/s]gen:  29%|██▊       | 2/7 [00:01<00:02,  1.89it/s]gen:  43%|████▎     | 3/7 [00:02<00:03,  1.25it/s]gen:  57%|█████▋    | 4/7 [00:03<00:02,  1.24it/s]gen:  71%|███████▏  | 5/7 [00:04<00:01,  1.05it/s]gen:  86%|████████▌ | 6/7 [00:05<00:01,  1.12s/it]gen: 100%|██████████| 7/7 [00:05<00:00,  1.19it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:12,  2.15s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.88s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.80s/it]jb_gen:  57%|█████▋    | 4/7 [00:07<00:05,  1.74s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.89s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:02,  2.05s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.82s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.48it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.56it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.61it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.64it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.59it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.54it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 77.1s
    uds: 0.2279
    em: 0.8265
    mia_loss: 0.9838

============================================================
[69/76] idknll_lr2e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr2e-05_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.92it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.64it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.70it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.66it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.71it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.11it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.75it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.57it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.66it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.80it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.87it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.90it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.01it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.87it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.88it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.85it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:06,  1.07s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.37s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.21s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.12s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.15s/it]gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.29s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.04it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:02<00:12,  2.13s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.94s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.90s/it]jb_gen:  57%|█████▋    | 4/7 [00:08<00:06,  2.03s/it]jb_gen:  71%|███████▏  | 5/7 [00:09<00:03,  1.90s/it]jb_gen:  86%|████████▌ | 6/7 [00:11<00:01,  1.88s/it]jb_gen: 100%|██████████| 7/7 [00:12<00:00,  1.70s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.30it/s] 43%|████▎     | 3/7 [00:02<00:02,  1.43it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.48it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.68it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.62it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.64it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 78.5s
    uds: 0.2152
    em: 0.8325
    mia_loss: 0.9849

============================================================
[70/76] idknll_lr2e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr2e-05_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.66it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.08it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.67it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.63it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:15,  1.60it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.64it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.73it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.95it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.86it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.83it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.79it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.85it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.03it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.92it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.94it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.81it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.71it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.41s/it]gen:  29%|██▊       | 2/7 [00:03<00:08,  1.73s/it]gen:  43%|████▎     | 3/7 [00:04<00:06,  1.67s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.54s/it]gen:  71%|███████▏  | 5/7 [00:07<00:02,  1.40s/it]gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.55s/it]gen: 100%|██████████| 7/7 [00:10<00:00,  1.56s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:11,  1.85s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.83s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:07,  1.83s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:05,  1.69s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.75s/it]jb_gen:  86%|████████▌ | 6/7 [00:10<00:01,  1.77s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.58s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.61it/s]100%|██████████| 7/7 [00:04<00:00,  1.99it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.59it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.60it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.64it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.51it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 81.0s
    uds: 0.2085
    em: 0.8370
    mia_loss: 0.9859

============================================================
[71/76] idknll_lr5e5_a1_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr5e-05_alpha1_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.86it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.59it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.71it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.12it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.85it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.63it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.90it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.83it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.79it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.94it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.88it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.94it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.88it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.92it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.08it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.04it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  2.00it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.89it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.89it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.86it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:14<00:02,  1.78it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.74it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.79it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  2.13it/s]Mem eval (multi): 100%|██████████| 32/32 [00:16<00:00,  1.89it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.44it/s]gen:  29%|██▊       | 2/7 [00:01<00:02,  1.86it/s]gen:  43%|████▎     | 3/7 [00:01<00:01,  2.17it/s]gen:  57%|█████▋    | 4/7 [00:01<00:01,  2.34it/s]gen:  71%|███████▏  | 5/7 [00:02<00:01,  1.66it/s]gen:  86%|████████▌ | 6/7 [00:03<00:00,  1.35it/s]gen: 100%|██████████| 7/7 [00:04<00:00,  1.70it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:09,  1.59s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:07,  1.57s/it]jb_gen:  43%|████▎     | 3/7 [00:04<00:05,  1.43s/it]jb_gen:  57%|█████▋    | 4/7 [00:05<00:04,  1.38s/it]jb_gen:  71%|███████▏  | 5/7 [00:07<00:02,  1.37s/it]jb_gen:  86%|████████▌ | 6/7 [00:08<00:01,  1.48s/it]jb_gen: 100%|██████████| 7/7 [00:09<00:00,  1.35s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.45it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.50it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.53it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.59it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  2.00it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.67it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.62it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.65it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.62it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:03<00:00,  1.97it/s]                                               Done in 71.4s
    uds: 0.3584
    em: 0.7647
    mia_loss: 0.9567

============================================================
[72/76] idknll_lr5e5_a2_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr5e-05_alpha2_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:02,  1.67it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.68it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.69it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.74it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.17it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.89it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.62it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.02it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.80it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.90it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.88it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.80it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.76it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.62it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.69it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.74it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.87it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.85it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  2.00it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.95it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.84it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.90it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.84it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.73it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.73it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.12it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:04,  1.33it/s]gen:  29%|██▊       | 2/7 [00:01<00:03,  1.65it/s]gen:  43%|████▎     | 3/7 [00:01<00:02,  1.99it/s]gen:  57%|█████▋    | 4/7 [00:02<00:01,  2.22it/s]gen:  71%|███████▏  | 5/7 [00:02<00:01,  1.62it/s]gen:  86%|████████▌ | 6/7 [00:03<00:00,  1.30it/s]gen: 100%|██████████| 7/7 [00:04<00:00,  1.58it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.76s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:09,  1.86s/it]jb_gen:  43%|████▎     | 3/7 [00:05<00:06,  1.70s/it]jb_gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.60s/it]jb_gen:  71%|███████▏  | 5/7 [00:08<00:03,  1.59s/it]jb_gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.65s/it]jb_gen: 100%|██████████| 7/7 [00:11<00:00,  1.56s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.43it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:02,  1.48it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.97it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.57it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.92it/s]                                               Done in 75.3s
    uds: 0.3624
    em: 0.7679
    mia_loss: 0.9596

============================================================
[73/76] idknll_lr5e5_a5_ep10
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkNLL_lr5e-05_alpha5_epoch10
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.90it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.57it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.64it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.70it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.70it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.75it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.15it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.74it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.61it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.66it/s]Mem eval (multi): 100%|██████████| 7/7 [00:04<00:00,  1.52it/s]Mem eval (multi): 100%|██████████| 7/7 [00:04<00:00,  1.58it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.03it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.05it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.85it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.83it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.86it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:13,  1.86it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.86it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:09,  1.86it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.84it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.87it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.80it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.93it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.04it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:04,  2.00it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.95it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.87it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.75it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.75it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.70it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.76it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.14it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.87it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:00<00:05,  1.07it/s]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.25s/it]gen:  43%|████▎     | 3/7 [00:03<00:04,  1.11s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.10s/it]gen:  71%|███████▏  | 5/7 [00:05<00:02,  1.03s/it]gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.15s/it]gen: 100%|██████████| 7/7 [00:07<00:00,  1.15it/s]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:10,  1.72s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:07,  1.58s/it]jb_gen:  43%|████▎     | 3/7 [00:04<00:06,  1.54s/it]jb_gen:  57%|█████▋    | 4/7 [00:05<00:04,  1.44s/it]jb_gen:  71%|███████▏  | 5/7 [00:07<00:03,  1.53s/it]jb_gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.53s/it]jb_gen: 100%|██████████| 7/7 [00:10<00:00,  1.42s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.46it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.63it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:04<00:00,  2.01it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.56it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.63it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.56it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 75.9s
    uds: 0.3296
    em: 0.7775
    mia_loss: 0.9643

============================================================
[74/76] npo_lr1e5_b01_a1_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr1e-05_beta0.1_alpha1_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.91it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.59it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.62it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.68it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.69it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.63it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.60it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.67it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.67it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.05it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.81it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.03it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.91it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.82it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.83it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.64it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.70it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.78it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.69it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.91it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.85it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.84it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:07,  1.88it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.83it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.96it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.03it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.88it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.91it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.84it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.86it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.91it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.80it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.77it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.68it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.69it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:17<00:00,  1.69it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.85it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:09,  1.63s/it]gen:  29%|██▊       | 2/7 [00:03<00:07,  1.54s/it]gen:  43%|████▎     | 3/7 [00:04<00:05,  1.34s/it]gen:  57%|█████▋    | 4/7 [00:05<00:03,  1.33s/it]gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.24s/it]gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.22s/it]gen: 100%|██████████| 7/7 [00:08<00:00,  1.07s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:06,  1.03s/it]jb_gen:  29%|██▊       | 2/7 [00:02<00:06,  1.23s/it]jb_gen:  43%|████▎     | 3/7 [00:03<00:04,  1.17s/it]jb_gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.09s/it]jb_gen:  71%|███████▏  | 5/7 [00:05<00:01,  1.00it/s]jb_gen:  86%|████████▌ | 6/7 [00:06<00:01,  1.08s/it]jb_gen: 100%|██████████| 7/7 [00:07<00:00,  1.04s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.74it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.55it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.51it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.59it/s]100%|██████████| 7/7 [00:04<00:00,  1.98it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.63it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.50it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.56it/s]100%|██████████| 7/7 [00:04<00:00,  1.93it/s]                                               Done in 74.3s
    uds: 0.5232
    em: 0.6742
    mia_loss: 0.8880

============================================================
[75/76] npo_lr1e5_b01_a2_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr1e-05_beta0.1_alpha2_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.85it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.53it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.68it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.63it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.73it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.64it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.82it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.77it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.55it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.56it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.64it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.65it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.07it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.79it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.04it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.88it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:15,  1.81it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:14,  1.84it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.84it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:13,  1.80it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.63it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:13,  1.69it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:12,  1.69it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:10,  1.88it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.84it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.90it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:09,  1.77it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.82it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.89it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.94it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.05it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  2.01it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.95it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.96it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.86it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.87it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.78it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.76it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.70it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.77it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.15it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:08,  1.37s/it]gen:  29%|██▊       | 2/7 [00:02<00:06,  1.39s/it]gen:  43%|████▎     | 3/7 [00:03<00:05,  1.27s/it]gen:  57%|█████▋    | 4/7 [00:04<00:03,  1.20s/it]gen:  71%|███████▏  | 5/7 [00:06<00:02,  1.21s/it]gen:  86%|████████▌ | 6/7 [00:07<00:01,  1.18s/it]gen: 100%|██████████| 7/7 [00:08<00:00,  1.18s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:05<00:33,  5.66s/it]jb_gen:  29%|██▊       | 2/7 [00:07<00:16,  3.28s/it]jb_gen:  43%|████▎     | 3/7 [00:08<00:09,  2.48s/it]jb_gen:  57%|█████▋    | 4/7 [00:09<00:05,  1.89s/it]jb_gen:  71%|███████▏  | 5/7 [00:10<00:03,  1.56s/it]jb_gen:  86%|████████▌ | 6/7 [00:12<00:01,  1.48s/it]jb_gen: 100%|██████████| 7/7 [00:13<00:00,  1.31s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.44it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.51it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.50it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.60it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.57it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.71it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.52it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.59it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.55it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.55it/s]100%|██████████| 7/7 [00:04<00:00,  1.91it/s]                                               Done in 79.8s
    uds: 0.5242
    em: 0.6930
    mia_loss: 0.8957

============================================================
[76/76] npo_lr1e5_b01_a5_ep5
  open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr1e-05_beta0.1_alpha5_epoch5
============================================================
  Using pre-computed metrics (before)
  Loading quantized model...
  Computing metrics (after quant)...
Mem eval:   0%|          | 0/7 [00:00<?, ?it/s]Mem eval:  14%|█▍        | 1/7 [00:00<00:03,  1.89it/s]Mem eval:  29%|██▊       | 2/7 [00:01<00:03,  1.50it/s]Mem eval:  43%|████▎     | 3/7 [00:01<00:02,  1.68it/s]Mem eval:  57%|█████▋    | 4/7 [00:02<00:01,  1.65it/s]Mem eval:  71%|███████▏  | 5/7 [00:02<00:01,  1.72it/s]Mem eval:  86%|████████▌ | 6/7 [00:03<00:00,  1.73it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  2.16it/s]Mem eval: 100%|██████████| 7/7 [00:03<00:00,  1.86it/s]
Mem eval (multi):   0%|          | 0/7 [00:00<?, ?it/s]Mem eval (multi):  14%|█▍        | 1/7 [00:00<00:03,  1.78it/s]Mem eval (multi):  29%|██▊       | 2/7 [00:01<00:03,  1.54it/s]Mem eval (multi):  43%|████▎     | 3/7 [00:01<00:02,  1.61it/s]Mem eval (multi):  57%|█████▋    | 4/7 [00:02<00:01,  1.58it/s]Mem eval (multi):  71%|███████▏  | 5/7 [00:03<00:01,  1.67it/s]Mem eval (multi):  86%|████████▌ | 6/7 [00:03<00:00,  1.62it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  2.04it/s]Mem eval (multi): 100%|██████████| 7/7 [00:03<00:00,  1.78it/s]
Mem eval (multi):   0%|          | 0/32 [00:00<?, ?it/s]Mem eval (multi):   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]Mem eval (multi):   6%|▋         | 2/32 [00:00<00:14,  2.06it/s]Mem eval (multi):   9%|▉         | 3/32 [00:01<00:15,  1.89it/s]Mem eval (multi):  12%|█▎        | 4/32 [00:02<00:14,  1.89it/s]Mem eval (multi):  16%|█▌        | 5/32 [00:02<00:15,  1.79it/s]Mem eval (multi):  19%|█▉        | 6/32 [00:03<00:14,  1.81it/s]Mem eval (multi):  22%|██▏       | 7/32 [00:03<00:14,  1.77it/s]Mem eval (multi):  25%|██▌       | 8/32 [00:04<00:14,  1.66it/s]Mem eval (multi):  28%|██▊       | 9/32 [00:05<00:14,  1.63it/s]Mem eval (multi):  31%|███▏      | 10/32 [00:05<00:12,  1.72it/s]Mem eval (multi):  34%|███▍      | 11/32 [00:06<00:11,  1.77it/s]Mem eval (multi):  38%|███▊      | 12/32 [00:06<00:10,  1.83it/s]Mem eval (multi):  41%|████      | 13/32 [00:07<00:09,  1.95it/s]Mem eval (multi):  44%|████▍     | 14/32 [00:07<00:09,  1.82it/s]Mem eval (multi):  47%|████▋     | 15/32 [00:08<00:08,  1.91it/s]Mem eval (multi):  50%|█████     | 16/32 [00:08<00:08,  1.86it/s]Mem eval (multi):  53%|█████▎    | 17/32 [00:09<00:08,  1.79it/s]Mem eval (multi):  56%|█████▋    | 18/32 [00:09<00:07,  1.86it/s]Mem eval (multi):  59%|█████▉    | 19/32 [00:10<00:06,  1.97it/s]Mem eval (multi):  62%|██████▎   | 20/32 [00:10<00:05,  2.06it/s]Mem eval (multi):  66%|██████▌   | 21/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]Mem eval (multi):  72%|███████▏  | 23/32 [00:12<00:04,  1.98it/s]Mem eval (multi):  75%|███████▌  | 24/32 [00:12<00:04,  1.93it/s]Mem eval (multi):  78%|███████▊  | 25/32 [00:13<00:03,  1.93it/s]Mem eval (multi):  81%|████████▏ | 26/32 [00:13<00:03,  1.96it/s]Mem eval (multi):  84%|████████▍ | 27/32 [00:14<00:02,  1.77it/s]Mem eval (multi):  88%|████████▊ | 28/32 [00:15<00:02,  1.74it/s]Mem eval (multi):  91%|█████████ | 29/32 [00:15<00:01,  1.69it/s]Mem eval (multi):  94%|█████████▍| 30/32 [00:16<00:01,  1.71it/s]Mem eval (multi):  97%|█████████▋| 31/32 [00:16<00:00,  1.73it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  2.11it/s]Mem eval (multi): 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
gen:   0%|          | 0/7 [00:00<?, ?it/s]/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/jaeung/.pyenv/versions/3.12.1/lib/python3.12/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
gen:  14%|█▍        | 1/7 [00:01<00:10,  1.83s/it]gen:  29%|██▊       | 2/7 [00:03<00:09,  1.82s/it]gen:  43%|████▎     | 3/7 [00:05<00:06,  1.69s/it]gen:  57%|█████▋    | 4/7 [00:06<00:04,  1.58s/it]gen:  71%|███████▏  | 5/7 [00:07<00:02,  1.49s/it]gen:  86%|████████▌ | 6/7 [00:09<00:01,  1.46s/it]gen: 100%|██████████| 7/7 [00:10<00:00,  1.41s/it]                                                  jb_gen:   0%|          | 0/7 [00:00<?, ?it/s]jb_gen:  14%|█▍        | 1/7 [00:01<00:08,  1.46s/it]jb_gen:  29%|██▊       | 2/7 [00:03<00:07,  1.57s/it]jb_gen:  43%|████▎     | 3/7 [00:04<00:06,  1.54s/it]jb_gen:  57%|█████▋    | 4/7 [00:05<00:04,  1.41s/it]jb_gen:  71%|███████▏  | 5/7 [00:11<00:05,  2.93s/it]jb_gen:  86%|████████▌ | 6/7 [00:13<00:02,  2.47s/it]jb_gen: 100%|██████████| 7/7 [00:14<00:00,  2.01s/it]                                                       0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.42it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.53it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.54it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.58it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.60it/s]100%|██████████| 7/7 [00:04<00:00,  1.95it/s]                                               0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 29%|██▊       | 2/7 [00:01<00:03,  1.61it/s] 43%|████▎     | 3/7 [00:01<00:02,  1.57it/s] 57%|█████▋    | 4/7 [00:02<00:01,  1.55it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.56it/s] 86%|████████▌ | 6/7 [00:03<00:00,  1.58it/s]100%|██████████| 7/7 [00:04<00:00,  1.94it/s]                                               Done in 83.0s
    uds: 0.4651
    em: 0.7423
    mia_loss: 0.9199

============================================================
Done! Results saved to runs/meta_eval/robustness/quant/results.json
============================================================
