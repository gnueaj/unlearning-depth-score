Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
================================================================================
S1/S2 Experiment with Teacher Forcing (Side-by-Side)
================================================================================
Mode: layer
Metric: logprob
Delta threshold: 0.05
EM scope: entity
Entity source: gt
Reference scope: continuation
Patch scope: span
Unlearn model: npo_lr2e5_b01_a2_ep5

Loading models...
Loading unlearn model: open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_NPO_lr2e-05_beta0.1_alpha2_epoch5
Layers: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
Loaded 367 examples

========================================
Running S1/S2 (layer, teacher forcing)
========================================
S1/S2 layer:   0%|          | 0/367 [00:00<?, ?it/s]S1/S2 layer:   0%|          | 1/367 [00:01<11:59,  1.97s/it]S1/S2 layer:   1%|          | 2/367 [00:03<11:06,  1.83s/it]S1/S2 layer:   1%|          | 3/367 [00:05<10:34,  1.74s/it]S1/S2 layer:   1%|          | 4/367 [00:07<10:38,  1.76s/it]S1/S2 layer:   1%|▏         | 5/367 [00:09<12:09,  2.02s/it]S1/S2 layer:   2%|▏         | 6/367 [00:11<12:14,  2.03s/it]S1/S2 layer:   2%|▏         | 7/367 [00:13<11:37,  1.94s/it]S1/S2 layer:   2%|▏         | 8/367 [00:15<11:19,  1.89s/it]S1/S2 layer:   2%|▏         | 9/367 [00:17<11:12,  1.88s/it]S1/S2 layer:   3%|▎         | 10/367 [00:19<11:56,  2.01s/it]S1/S2 layer:   3%|▎         | 11/367 [00:21<13:01,  2.19s/it]S1/S2 layer:   3%|▎         | 12/367 [00:24<13:39,  2.31s/it]S1/S2 layer:   4%|▎         | 13/367 [00:27<13:58,  2.37s/it]S1/S2 layer:   4%|▍         | 14/367 [00:29<13:15,  2.25s/it]S1/S2 layer:   4%|▍         | 15/367 [00:31<13:46,  2.35s/it]S1/S2 layer:   4%|▍         | 16/367 [00:33<13:42,  2.34s/it]S1/S2 layer:   5%|▍         | 17/367 [00:35<12:16,  2.10s/it]S1/S2 layer:   5%|▍         | 18/367 [00:37<12:27,  2.14s/it]S1/S2 layer:   5%|▌         | 19/367 [00:40<13:09,  2.27s/it]S1/S2 layer:   5%|▌         | 20/367 [00:41<12:02,  2.08s/it]S1/S2 layer:   6%|▌         | 21/367 [00:43<10:58,  1.90s/it]S1/S2 layer:   6%|▌         | 22/367 [00:45<11:32,  2.01s/it]S1/S2 layer:   6%|▋         | 23/367 [00:48<12:12,  2.13s/it]S1/S2 layer:   7%|▋         | 24/367 [00:50<12:16,  2.15s/it]S1/S2 layer:   7%|▋         | 25/367 [00:52<12:24,  2.18s/it]S1/S2 layer:   7%|▋         | 26/367 [00:55<13:04,  2.30s/it]S1/S2 layer:   7%|▋         | 27/367 [00:57<12:30,  2.21s/it]S1/S2 layer:   8%|▊         | 28/367 [00:59<12:52,  2.28s/it]S1/S2 layer:   8%|▊         | 29/367 [01:02<13:19,  2.36s/it]S1/S2 layer:   8%|▊         | 30/367 [01:04<12:45,  2.27s/it]S1/S2 layer:   8%|▊         | 31/367 [01:06<13:12,  2.36s/it]S1/S2 layer:   9%|▊         | 32/367 [01:08<12:35,  2.26s/it]S1/S2 layer:   9%|▉         | 33/367 [01:11<13:13,  2.37s/it]S1/S2 layer:   9%|▉         | 34/367 [01:13<13:16,  2.39s/it]S1/S2 layer:  10%|▉         | 35/367 [01:16<13:20,  2.41s/it]S1/S2 layer:  10%|▉         | 36/367 [01:18<12:58,  2.35s/it]S1/S2 layer:  10%|█         | 37/367 [01:21<13:18,  2.42s/it]S1/S2 layer:  10%|█         | 38/367 [01:22<12:22,  2.26s/it]S1/S2 layer:  11%|█         | 39/367 [01:25<12:24,  2.27s/it]S1/S2 layer:  11%|█         | 40/367 [01:26<11:28,  2.11s/it]S1/S2 layer:  11%|█         | 41/367 [01:29<11:21,  2.09s/it]S1/S2 layer:  11%|█▏        | 42/367 [01:31<11:10,  2.06s/it]S1/S2 layer:  12%|█▏        | 43/367 [01:33<11:07,  2.06s/it]S1/S2 layer:  12%|█▏        | 44/367 [01:35<11:54,  2.21s/it]S1/S2 layer:  12%|█▏        | 45/367 [01:37<12:03,  2.25s/it]S1/S2 layer:  13%|█▎        | 46/367 [01:40<12:30,  2.34s/it]S1/S2 layer:  13%|█▎        | 47/367 [01:43<12:57,  2.43s/it]S1/S2 layer:  13%|█▎        | 48/367 [01:45<13:07,  2.47s/it]S1/S2 layer:  13%|█▎        | 49/367 [01:48<13:01,  2.46s/it]S1/S2 layer:  14%|█▎        | 50/367 [01:50<13:13,  2.50s/it]S1/S2 layer:  14%|█▍        | 51/367 [01:53<13:04,  2.48s/it]S1/S2 layer:  14%|█▍        | 52/367 [01:55<13:17,  2.53s/it]S1/S2 layer:  14%|█▍        | 53/367 [01:58<13:16,  2.54s/it]S1/S2 layer:  15%|█▍        | 54/367 [02:01<13:22,  2.56s/it]S1/S2 layer:  15%|█▍        | 55/367 [02:03<12:43,  2.45s/it]S1/S2 layer:  15%|█▌        | 56/367 [02:05<12:24,  2.39s/it]S1/S2 layer:  16%|█▌        | 57/367 [02:07<11:53,  2.30s/it]S1/S2 layer:  16%|█▌        | 58/367 [02:09<12:00,  2.33s/it]S1/S2 layer:  16%|█▌        | 59/367 [02:12<11:37,  2.26s/it]S1/S2 layer:  16%|█▋        | 60/367 [02:14<12:05,  2.36s/it]S1/S2 layer:  17%|█▋        | 61/367 [02:17<12:26,  2.44s/it]S1/S2 layer:  17%|█▋        | 62/367 [02:19<12:07,  2.39s/it]S1/S2 layer:  17%|█▋        | 63/367 [02:22<12:25,  2.45s/it]S1/S2 layer:  17%|█▋        | 64/367 [02:23<11:13,  2.22s/it]S1/S2 layer:  18%|█▊        | 65/367 [02:26<11:35,  2.30s/it]S1/S2 layer:  18%|█▊        | 66/367 [02:28<11:34,  2.31s/it]S1/S2 layer:  18%|█▊        | 67/367 [02:31<11:56,  2.39s/it]S1/S2 layer:  19%|█▊        | 68/367 [02:33<12:11,  2.45s/it]S1/S2 layer:  19%|█▉        | 69/367 [02:36<12:30,  2.52s/it]S1/S2 layer:  19%|█▉        | 70/367 [02:38<12:01,  2.43s/it]S1/S2 layer:  19%|█▉        | 71/367 [02:41<11:52,  2.41s/it]S1/S2 layer:  20%|█▉        | 72/367 [02:43<11:48,  2.40s/it]S1/S2 layer:  20%|█▉        | 73/367 [02:45<10:49,  2.21s/it]S1/S2 layer:  20%|██        | 74/367 [02:47<10:38,  2.18s/it]S1/S2 layer:  20%|██        | 75/367 [02:49<11:05,  2.28s/it]S1/S2 layer:  21%|██        | 76/367 [02:51<10:29,  2.16s/it]S1/S2 layer:  21%|██        | 77/367 [02:53<10:30,  2.17s/it]S1/S2 layer:  21%|██▏       | 78/367 [02:56<11:15,  2.34s/it]S1/S2 layer:  22%|██▏       | 79/367 [02:58<11:14,  2.34s/it]S1/S2 layer:  22%|██▏       | 80/367 [03:01<11:41,  2.44s/it]S1/S2 layer:  22%|██▏       | 81/367 [03:04<11:35,  2.43s/it]S1/S2 layer:  22%|██▏       | 82/367 [03:06<11:22,  2.39s/it]S1/S2 layer:  23%|██▎       | 83/367 [03:08<11:03,  2.34s/it]S1/S2 layer:  23%|██▎       | 84/367 [03:11<12:02,  2.55s/it]S1/S2 layer:  23%|██▎       | 85/367 [03:13<11:43,  2.49s/it]S1/S2 layer:  23%|██▎       | 86/367 [03:16<11:41,  2.50s/it]S1/S2 layer:  24%|██▎       | 87/367 [03:19<11:50,  2.54s/it]S1/S2 layer:  24%|██▍       | 88/367 [03:21<11:42,  2.52s/it]S1/S2 layer:  24%|██▍       | 89/367 [03:24<11:48,  2.55s/it]S1/S2 layer:  25%|██▍       | 90/367 [03:26<11:55,  2.58s/it]S1/S2 layer:  25%|██▍       | 91/367 [03:29<11:51,  2.58s/it]S1/S2 layer:  25%|██▌       | 92/367 [03:31<11:03,  2.41s/it]S1/S2 layer:  25%|██▌       | 93/367 [03:34<11:17,  2.47s/it]S1/S2 layer:  26%|██▌       | 94/367 [03:36<11:15,  2.48s/it]S1/S2 layer:  26%|██▌       | 95/367 [03:39<11:15,  2.48s/it]S1/S2 layer:  26%|██▌       | 96/367 [03:41<11:24,  2.53s/it]S1/S2 layer:  26%|██▋       | 97/367 [03:44<11:21,  2.52s/it]S1/S2 layer:  27%|██▋       | 98/367 [03:46<10:28,  2.34s/it]S1/S2 layer:  27%|██▋       | 99/367 [03:48<10:43,  2.40s/it]S1/S2 layer:  27%|██▋       | 100/367 [03:51<10:42,  2.41s/it]S1/S2 layer:  28%|██▊       | 101/367 [03:53<10:58,  2.48s/it]S1/S2 layer:  28%|██▊       | 102/367 [03:56<11:02,  2.50s/it]S1/S2 layer:  28%|██▊       | 103/367 [03:58<11:04,  2.52s/it]S1/S2 layer:  28%|██▊       | 104/367 [04:01<11:05,  2.53s/it]S1/S2 layer:  29%|██▊       | 105/367 [04:03<11:00,  2.52s/it]S1/S2 layer:  29%|██▉       | 106/367 [04:06<10:37,  2.44s/it]S1/S2 layer:  29%|██▉       | 107/367 [04:08<10:47,  2.49s/it]S1/S2 layer:  29%|██▉       | 108/367 [04:11<10:55,  2.53s/it]S1/S2 layer:  30%|██▉       | 109/367 [04:13<10:38,  2.48s/it]S1/S2 layer:  30%|██▉       | 110/367 [04:15<09:31,  2.22s/it]S1/S2 layer:  30%|███       | 111/367 [04:17<08:57,  2.10s/it]S1/S2 layer:  31%|███       | 112/367 [04:19<08:50,  2.08s/it]S1/S2 layer:  31%|███       | 113/367 [04:21<09:27,  2.23s/it]S1/S2 layer:  31%|███       | 114/367 [04:24<09:53,  2.34s/it]S1/S2 layer:  31%|███▏      | 115/367 [04:26<09:49,  2.34s/it]S1/S2 layer:  32%|███▏      | 116/367 [04:28<09:39,  2.31s/it]S1/S2 layer:  32%|███▏      | 117/367 [04:31<09:18,  2.23s/it]S1/S2 layer:  32%|███▏      | 118/367 [04:33<09:50,  2.37s/it]S1/S2 layer:  32%|███▏      | 119/367 [04:35<09:27,  2.29s/it]S1/S2 layer:  33%|███▎      | 120/367 [04:38<09:32,  2.32s/it]S1/S2 layer:  33%|███▎      | 121/367 [04:40<09:38,  2.35s/it]S1/S2 layer:  33%|███▎      | 122/367 [04:43<09:54,  2.42s/it]S1/S2 layer:  34%|███▎      | 123/367 [04:45<10:05,  2.48s/it]S1/S2 layer:  34%|███▍      | 124/367 [04:48<09:49,  2.43s/it]S1/S2 layer:  34%|███▍      | 125/367 [04:50<09:17,  2.31s/it]S1/S2 layer:  34%|███▍      | 126/367 [04:52<09:36,  2.39s/it]S1/S2 layer:  35%|███▍      | 127/367 [04:55<09:44,  2.43s/it]S1/S2 layer:  35%|███▍      | 128/367 [04:57<09:46,  2.46s/it]S1/S2 layer:  35%|███▌      | 129/367 [04:59<08:54,  2.24s/it]S1/S2 layer:  35%|███▌      | 130/367 [05:01<08:03,  2.04s/it]S1/S2 layer:  36%|███▌      | 131/367 [05:02<07:45,  1.97s/it]S1/S2 layer:  36%|███▌      | 132/367 [05:04<07:19,  1.87s/it]S1/S2 layer:  36%|███▌      | 133/367 [05:06<07:54,  2.03s/it]S1/S2 layer:  37%|███▋      | 134/367 [05:09<08:32,  2.20s/it]S1/S2 layer:  37%|███▋      | 135/367 [05:11<08:29,  2.19s/it]S1/S2 layer:  37%|███▋      | 136/367 [05:14<08:55,  2.32s/it]S1/S2 layer:  37%|███▋      | 137/367 [05:16<08:57,  2.34s/it]S1/S2 layer:  38%|███▊      | 138/367 [05:18<08:41,  2.28s/it]S1/S2 layer:  38%|███▊      | 139/367 [05:21<08:29,  2.24s/it]S1/S2 layer:  38%|███▊      | 140/367 [05:23<08:55,  2.36s/it]S1/S2 layer:  38%|███▊      | 141/367 [05:25<08:14,  2.19s/it]S1/S2 layer:  39%|███▊      | 142/367 [05:27<08:24,  2.24s/it]S1/S2 layer:  39%|███▉      | 143/367 [05:29<08:15,  2.21s/it]S1/S2 layer:  39%|███▉      | 144/367 [05:32<08:24,  2.26s/it]S1/S2 layer:  40%|███▉      | 145/367 [05:34<08:11,  2.21s/it]S1/S2 layer:  40%|███▉      | 146/367 [05:36<08:02,  2.18s/it]S1/S2 layer:  40%|████      | 147/367 [05:38<07:35,  2.07s/it]S1/S2 layer:  40%|████      | 148/367 [05:39<06:58,  1.91s/it]S1/S2 layer:  41%|████      | 149/367 [05:41<06:44,  1.86s/it]S1/S2 layer:  41%|████      | 150/367 [05:43<07:00,  1.94s/it]S1/S2 layer:  41%|████      | 151/367 [05:46<07:30,  2.09s/it]S1/S2 layer:  41%|████▏     | 152/367 [05:48<08:07,  2.27s/it]S1/S2 layer:  42%|████▏     | 153/367 [05:51<08:17,  2.33s/it]S1/S2 layer:  42%|████▏     | 154/367 [05:53<08:12,  2.31s/it]S1/S2 layer:  42%|████▏     | 155/367 [05:56<08:19,  2.36s/it]S1/S2 layer:  43%|████▎     | 156/367 [05:58<07:59,  2.27s/it]S1/S2 layer:  43%|████▎     | 157/367 [06:00<08:06,  2.32s/it]S1/S2 layer:  43%|████▎     | 158/367 [06:02<08:09,  2.34s/it]S1/S2 layer:  43%|████▎     | 159/367 [06:05<08:08,  2.35s/it]S1/S2 layer:  44%|████▎     | 160/367 [06:07<08:01,  2.32s/it]S1/S2 layer:  44%|████▍     | 161/367 [06:09<07:15,  2.11s/it]S1/S2 layer:  44%|████▍     | 162/367 [06:11<07:09,  2.09s/it]S1/S2 layer:  44%|████▍     | 163/367 [06:12<06:36,  1.94s/it]S1/S2 layer:  45%|████▍     | 164/367 [06:14<06:27,  1.91s/it]S1/S2 layer:  45%|████▍     | 165/367 [06:16<06:25,  1.91s/it]S1/S2 layer:  45%|████▌     | 166/367 [06:19<07:00,  2.09s/it]S1/S2 layer:  46%|████▌     | 167/367 [06:21<06:46,  2.03s/it]S1/S2 layer:  46%|████▌     | 168/367 [06:23<07:03,  2.13s/it]S1/S2 layer:  46%|████▌     | 169/367 [06:25<07:06,  2.15s/it]S1/S2 layer:  46%|████▋     | 170/367 [06:27<07:18,  2.23s/it]S1/S2 layer:  47%|████▋     | 171/367 [06:30<07:32,  2.31s/it]S1/S2 layer:  47%|████▋     | 172/367 [06:33<07:43,  2.38s/it]S1/S2 layer:  47%|████▋     | 173/367 [06:35<07:56,  2.46s/it]S1/S2 layer:  47%|████▋     | 174/367 [06:38<08:04,  2.51s/it]S1/S2 layer:  48%|████▊     | 175/367 [06:40<08:10,  2.55s/it]S1/S2 layer:  48%|████▊     | 176/367 [06:42<07:37,  2.40s/it]S1/S2 layer:  48%|████▊     | 177/367 [06:45<07:52,  2.49s/it]S1/S2 layer:  49%|████▊     | 178/367 [06:48<08:36,  2.73s/it]S1/S2 layer:  49%|████▉     | 179/367 [06:52<09:07,  2.91s/it]S1/S2 layer:  49%|████▉     | 180/367 [06:55<09:35,  3.08s/it]S1/S2 layer:  49%|████▉     | 181/367 [06:58<08:53,  2.87s/it]S1/S2 layer:  50%|████▉     | 182/367 [07:00<08:33,  2.78s/it]S1/S2 layer:  50%|████▉     | 183/367 [07:03<08:45,  2.86s/it]S1/S2 layer:  50%|█████     | 184/367 [07:06<09:00,  2.95s/it]S1/S2 layer:  50%|█████     | 185/367 [07:08<07:58,  2.63s/it]S1/S2 layer:  51%|█████     | 186/367 [07:11<07:54,  2.62s/it]S1/S2 layer:  51%|█████     | 187/367 [07:13<06:59,  2.33s/it]S1/S2 layer:  51%|█████     | 188/367 [07:14<06:11,  2.08s/it]S1/S2 layer:  51%|█████▏    | 189/367 [07:16<05:51,  1.97s/it]S1/S2 layer:  52%|█████▏    | 190/367 [07:18<05:37,  1.90s/it]S1/S2 layer:  52%|█████▏    | 191/367 [07:19<05:13,  1.78s/it]S1/S2 layer:  52%|█████▏    | 192/367 [07:21<05:11,  1.78s/it]S1/S2 layer:  52%|█████▏    | 192/367 [07:22<06:43,  2.31s/it]
Traceback (most recent call last):
  File "/home/jaeung/activation-patching-unlearning/exp_s1_teacher_forcing.py", line 1135, in main
    results, gk_count, categories, avg_udr, skipped_indices = run_s1_s2_side_by_side(
  File "/home/jaeung/activation-patching-unlearning/exp_s1_teacher_forcing.py", line 951, in run_s1_s2_side_by_side
    log_file.flush()
OSError: [Errno 28] No space left on device

During handling of the above exception, another exception occurred:

OSError: [Errno 28] No space left on device

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jaeung/activation-patching-unlearning/exp_s1_teacher_forcing.py", line 1205, in <module>
    main()
  File "/home/jaeung/activation-patching-unlearning/exp_s1_teacher_forcing.py", line 1173, in main
    print(summary_msg)
OSError: [Errno 28] No space left on device
