Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
================================================================================
S1/S2 Experiment with Teacher Forcing (Side-by-Side)
================================================================================
Mode: layer
Metric: logprob
Delta threshold: 0.05
EM scope: entity
Entity source: gt
Reference scope: continuation
Patch scope: span
Unlearn model: idkdpo_lr1e5_b01_a2_ep5

Loading models...
Loading unlearn model: open-unlearning/unlearn_tofu_Llama-3.2-1B-Instruct_forget10_IdkDPO_lr1e-05_beta0.1_alpha2_epoch5
Layers: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
Loaded 367 examples

========================================
Running S1/S2 (layer, teacher forcing)
========================================
S1/S2 layer:   0%|          | 0/367 [00:00<?, ?it/s]S1/S2 layer:   0%|          | 1/367 [00:02<12:44,  2.09s/it]S1/S2 layer:   1%|          | 2/367 [00:03<11:23,  1.87s/it]S1/S2 layer:   1%|          | 3/367 [00:05<10:32,  1.74s/it]S1/S2 layer:   1%|          | 4/367 [00:07<10:41,  1.77s/it]S1/S2 layer:   1%|▏         | 5/367 [00:09<12:30,  2.07s/it]S1/S2 layer:   2%|▏         | 6/367 [00:11<12:25,  2.07s/it]S1/S2 layer:   2%|▏         | 7/367 [00:13<11:47,  1.97s/it]S1/S2 layer:   2%|▏         | 8/367 [00:15<11:41,  1.95s/it]S1/S2 layer:   2%|▏         | 9/367 [00:17<12:16,  2.06s/it]S1/S2 layer:   3%|▎         | 10/367 [00:20<12:43,  2.14s/it]S1/S2 layer:   3%|▎         | 11/367 [00:22<12:57,  2.18s/it]S1/S2 layer:   3%|▎         | 12/367 [00:25<13:40,  2.31s/it]S1/S2 layer:   4%|▎         | 13/367 [00:27<14:13,  2.41s/it]S1/S2 layer:   4%|▍         | 14/367 [00:29<13:33,  2.30s/it]S1/S2 layer:   4%|▍         | 15/367 [00:32<14:00,  2.39s/it]S1/S2 layer:   4%|▍         | 16/367 [00:34<13:47,  2.36s/it]S1/S2 layer:   5%|▍         | 17/367 [00:36<12:15,  2.10s/it]S1/S2 layer:   5%|▍         | 18/367 [00:38<12:26,  2.14s/it]S1/S2 layer:   5%|▌         | 19/367 [00:40<13:06,  2.26s/it]S1/S2 layer:   5%|▌         | 20/367 [00:42<12:09,  2.10s/it]S1/S2 layer:   6%|▌         | 21/367 [00:44<11:04,  1.92s/it]S1/S2 layer:   6%|▌         | 22/367 [00:46<11:34,  2.01s/it]S1/S2 layer:   6%|▋         | 23/367 [00:48<12:35,  2.20s/it]S1/S2 layer:   7%|▋         | 24/367 [00:50<12:10,  2.13s/it]S1/S2 layer:   7%|▋         | 25/367 [00:53<12:24,  2.18s/it]S1/S2 layer:   7%|▋         | 26/367 [00:55<13:10,  2.32s/it]S1/S2 layer:   7%|▋         | 27/367 [00:58<12:48,  2.26s/it]S1/S2 layer:   8%|▊         | 28/367 [01:00<13:20,  2.36s/it]S1/S2 layer:   8%|▊         | 29/367 [01:03<13:33,  2.41s/it]S1/S2 layer:   8%|▊         | 30/367 [01:05<13:14,  2.36s/it]S1/S2 layer:   8%|▊         | 31/367 [01:07<13:34,  2.42s/it]S1/S2 layer:   9%|▊         | 32/367 [01:10<13:26,  2.41s/it]S1/S2 layer:   9%|▉         | 33/367 [01:12<13:47,  2.48s/it]S1/S2 layer:   9%|▉         | 34/367 [01:15<13:50,  2.49s/it]S1/S2 layer:  10%|▉         | 35/367 [01:17<13:32,  2.45s/it]S1/S2 layer:  10%|▉         | 36/367 [01:20<13:23,  2.43s/it]S1/S2 layer:  10%|█         | 37/367 [01:22<13:35,  2.47s/it]S1/S2 layer:  10%|█         | 38/367 [01:24<12:22,  2.26s/it]S1/S2 layer:  11%|█         | 39/367 [01:26<12:12,  2.23s/it]S1/S2 layer:  11%|█         | 40/367 [01:28<11:34,  2.12s/it]S1/S2 layer:  11%|█         | 41/367 [01:30<11:23,  2.10s/it]S1/S2 layer:  11%|█▏        | 42/367 [01:32<11:12,  2.07s/it]S1/S2 layer:  12%|█▏        | 43/367 [01:34<10:56,  2.03s/it]S1/S2 layer:  12%|█▏        | 44/367 [01:37<11:53,  2.21s/it]S1/S2 layer:  12%|█▏        | 45/367 [01:39<11:58,  2.23s/it]S1/S2 layer:  13%|█▎        | 46/367 [01:42<12:34,  2.35s/it]S1/S2 layer:  13%|█▎        | 47/367 [01:44<13:03,  2.45s/it]S1/S2 layer:  13%|█▎        | 48/367 [01:47<13:05,  2.46s/it]S1/S2 layer:  13%|█▎        | 49/367 [01:49<13:18,  2.51s/it]S1/S2 layer:  14%|█▎        | 50/367 [01:52<13:18,  2.52s/it]S1/S2 layer:  14%|█▍        | 51/367 [01:54<13:11,  2.50s/it]S1/S2 layer:  14%|█▍        | 52/367 [01:57<13:23,  2.55s/it]S1/S2 layer:  14%|█▍        | 53/367 [02:00<13:21,  2.55s/it]S1/S2 layer:  15%|█▍        | 54/367 [02:02<13:25,  2.57s/it]S1/S2 layer:  15%|█▍        | 55/367 [02:05<13:04,  2.51s/it]S1/S2 layer:  15%|█▌        | 56/367 [02:07<13:11,  2.54s/it]S1/S2 layer:  16%|█▌        | 57/367 [02:09<11:40,  2.26s/it]S1/S2 layer:  16%|█▌        | 58/367 [02:11<11:38,  2.26s/it]S1/S2 layer:  16%|█▌        | 59/367 [02:13<10:53,  2.12s/it]S1/S2 layer:  16%|█▋        | 60/367 [02:16<11:48,  2.31s/it]S1/S2 layer:  17%|█▋        | 61/367 [02:18<12:14,  2.40s/it]S1/S2 layer:  17%|█▋        | 62/367 [02:20<11:21,  2.23s/it]S1/S2 layer:  17%|█▋        | 63/367 [02:23<11:52,  2.34s/it]S1/S2 layer:  17%|█▋        | 64/367 [02:24<10:44,  2.13s/it]S1/S2 layer:  18%|█▊        | 65/367 [02:27<11:15,  2.24s/it]S1/S2 layer:  18%|█▊        | 66/367 [02:29<11:32,  2.30s/it]S1/S2 layer:  18%|█▊        | 67/367 [02:32<11:57,  2.39s/it]S1/S2 layer:  19%|█▊        | 68/367 [02:34<11:56,  2.40s/it]S1/S2 layer:  19%|█▉        | 69/367 [02:37<12:14,  2.46s/it]S1/S2 layer:  19%|█▉        | 70/367 [02:39<11:59,  2.42s/it]S1/S2 layer:  19%|█▉        | 71/367 [02:42<12:01,  2.44s/it]S1/S2 layer:  20%|█▉        | 72/367 [02:44<12:14,  2.49s/it]S1/S2 layer:  20%|█▉        | 73/367 [02:46<11:10,  2.28s/it]S1/S2 layer:  20%|██        | 74/367 [02:48<10:02,  2.06s/it]S1/S2 layer:  20%|██        | 75/367 [02:50<10:35,  2.18s/it]S1/S2 layer:  21%|██        | 76/367 [02:52<10:04,  2.08s/it]S1/S2 layer:  21%|██        | 77/367 [02:54<10:03,  2.08s/it]S1/S2 layer:  21%|██▏       | 78/367 [02:57<10:50,  2.25s/it]S1/S2 layer:  22%|██▏       | 79/367 [02:59<10:54,  2.27s/it]S1/S2 layer:  22%|██▏       | 80/367 [03:01<11:07,  2.33s/it]S1/S2 layer:  22%|██▏       | 81/367 [03:04<11:41,  2.45s/it]S1/S2 layer:  22%|██▏       | 82/367 [03:06<11:22,  2.40s/it]S1/S2 layer:  23%|██▎       | 83/367 [03:09<11:20,  2.40s/it]S1/S2 layer:  23%|██▎       | 84/367 [03:12<12:16,  2.60s/it]S1/S2 layer:  23%|██▎       | 85/367 [03:14<11:57,  2.54s/it]S1/S2 layer:  23%|██▎       | 86/367 [03:17<12:09,  2.60s/it]S1/S2 layer:  24%|██▎       | 87/367 [03:20<12:15,  2.63s/it]S1/S2 layer:  24%|██▍       | 88/367 [03:22<12:13,  2.63s/it]S1/S2 layer:  24%|██▍       | 89/367 [03:25<12:15,  2.65s/it]S1/S2 layer:  25%|██▍       | 90/367 [03:28<12:13,  2.65s/it]S1/S2 layer:  25%|██▍       | 91/367 [03:30<12:02,  2.62s/it]S1/S2 layer:  25%|██▌       | 92/367 [03:32<11:08,  2.43s/it]S1/S2 layer:  25%|██▌       | 93/367 [03:35<11:09,  2.44s/it]S1/S2 layer:  26%|██▌       | 94/367 [03:37<11:17,  2.48s/it]S1/S2 layer:  26%|██▌       | 95/367 [03:39<10:41,  2.36s/it]S1/S2 layer:  26%|██▌       | 96/367 [03:42<11:05,  2.46s/it]S1/S2 layer:  26%|██▋       | 97/367 [03:45<11:09,  2.48s/it]S1/S2 layer:  27%|██▋       | 98/367 [03:47<10:20,  2.31s/it]S1/S2 layer:  27%|██▋       | 99/367 [03:49<10:37,  2.38s/it]S1/S2 layer:  27%|██▋       | 100/367 [03:51<10:35,  2.38s/it]S1/S2 layer:  28%|██▊       | 101/367 [03:54<10:32,  2.38s/it]S1/S2 layer:  28%|██▊       | 102/367 [03:56<10:49,  2.45s/it]S1/S2 layer:  28%|██▊       | 103/367 [03:59<10:53,  2.48s/it]S1/S2 layer:  28%|██▊       | 104/367 [04:02<11:02,  2.52s/it]S1/S2 layer:  29%|██▊       | 105/367 [04:04<11:05,  2.54s/it]S1/S2 layer:  29%|██▉       | 106/367 [04:07<11:09,  2.57s/it]S1/S2 layer:  29%|██▉       | 107/367 [04:09<10:53,  2.51s/it]S1/S2 layer:  29%|██▉       | 108/367 [04:12<10:51,  2.51s/it]S1/S2 layer:  30%|██▉       | 109/367 [04:14<10:37,  2.47s/it]S1/S2 layer:  30%|██▉       | 110/367 [04:16<09:34,  2.24s/it]S1/S2 layer:  30%|███       | 111/367 [04:18<09:16,  2.18s/it]S1/S2 layer:  31%|███       | 112/367 [04:20<09:04,  2.13s/it]S1/S2 layer:  31%|███       | 113/367 [04:22<09:03,  2.14s/it]S1/S2 layer:  31%|███       | 114/367 [04:24<09:12,  2.19s/it]S1/S2 layer:  31%|███▏      | 115/367 [04:27<09:14,  2.20s/it]S1/S2 layer:  32%|███▏      | 116/367 [04:28<08:52,  2.12s/it]S1/S2 layer:  32%|███▏      | 117/367 [04:30<08:42,  2.09s/it]S1/S2 layer:  32%|███▏      | 118/367 [04:33<09:22,  2.26s/it]S1/S2 layer:  32%|███▏      | 119/367 [04:35<09:26,  2.28s/it]S1/S2 layer:  33%|███▎      | 120/367 [04:38<09:26,  2.29s/it]S1/S2 layer:  33%|███▎      | 121/367 [04:40<09:23,  2.29s/it]S1/S2 layer:  33%|███▎      | 122/367 [04:43<09:44,  2.39s/it]S1/S2 layer:  34%|███▎      | 123/367 [04:45<10:01,  2.47s/it]S1/S2 layer:  34%|███▍      | 124/367 [04:48<09:51,  2.43s/it]S1/S2 layer:  34%|███▍      | 125/367 [04:50<09:18,  2.31s/it]S1/S2 layer:  34%|███▍      | 126/367 [04:52<09:40,  2.41s/it]S1/S2 layer:  35%|███▍      | 127/367 [04:55<09:47,  2.45s/it]S1/S2 layer:  35%|███▍      | 128/367 [04:57<09:18,  2.34s/it]S1/S2 layer:  35%|███▌      | 129/367 [04:59<08:34,  2.16s/it]S1/S2 layer:  35%|███▌      | 130/367 [05:00<08:06,  2.05s/it]S1/S2 layer:  36%|███▌      | 131/367 [05:02<07:37,  1.94s/it]S1/S2 layer:  36%|███▌      | 132/367 [05:04<07:23,  1.89s/it]S1/S2 layer:  36%|███▌      | 133/367 [05:06<08:01,  2.06s/it]S1/S2 layer:  37%|███▋      | 134/367 [05:09<08:38,  2.22s/it]S1/S2 layer:  37%|███▋      | 135/367 [05:11<08:35,  2.22s/it]S1/S2 layer:  37%|███▋      | 136/367 [05:14<08:54,  2.31s/it]S1/S2 layer:  37%|███▋      | 137/367 [05:16<08:59,  2.34s/it]S1/S2 layer:  38%|███▊      | 138/367 [05:18<08:43,  2.29s/it]S1/S2 layer:  38%|███▊      | 139/367 [05:21<08:40,  2.28s/it]S1/S2 layer:  38%|███▊      | 140/367 [05:23<09:01,  2.38s/it]S1/S2 layer:  38%|███▊      | 141/367 [05:25<08:11,  2.17s/it]S1/S2 layer:  39%|███▊      | 142/367 [05:27<08:23,  2.24s/it]S1/S2 layer:  39%|███▉      | 143/367 [05:29<08:16,  2.22s/it]S1/S2 layer:  39%|███▉      | 144/367 [05:32<08:18,  2.24s/it]S1/S2 layer:  40%|███▉      | 145/367 [05:34<08:15,  2.23s/it]S1/S2 layer:  40%|███▉      | 146/367 [05:36<08:23,  2.28s/it]S1/S2 layer:  40%|████      | 147/367 [05:38<07:50,  2.14s/it]S1/S2 layer:  40%|████      | 148/367 [05:40<07:10,  1.96s/it]S1/S2 layer:  41%|████      | 149/367 [05:42<07:00,  1.93s/it]S1/S2 layer:  41%|████      | 150/367 [05:44<07:26,  2.06s/it]S1/S2 layer:  41%|████      | 151/367 [05:46<07:57,  2.21s/it]S1/S2 layer:  41%|████▏     | 152/367 [05:49<07:52,  2.20s/it]S1/S2 layer:  42%|████▏     | 153/367 [05:51<08:00,  2.25s/it]S1/S2 layer:  42%|████▏     | 154/367 [05:53<08:08,  2.29s/it]S1/S2 layer:  42%|████▏     | 155/367 [05:56<08:30,  2.41s/it]S1/S2 layer:  43%|████▎     | 156/367 [05:59<08:45,  2.49s/it]S1/S2 layer:  43%|████▎     | 157/367 [06:01<08:51,  2.53s/it]S1/S2 layer:  43%|████▎     | 158/367 [06:04<08:44,  2.51s/it]S1/S2 layer:  43%|████▎     | 159/367 [06:06<08:48,  2.54s/it]S1/S2 layer:  44%|████▎     | 160/367 [06:09<08:41,  2.52s/it]S1/S2 layer:  44%|████▍     | 161/367 [06:11<07:48,  2.28s/it]S1/S2 layer:  44%|████▍     | 162/367 [06:13<07:33,  2.21s/it]S1/S2 layer:  44%|████▍     | 163/367 [06:14<06:53,  2.03s/it]S1/S2 layer:  45%|████▍     | 164/367 [06:16<06:59,  2.06s/it]S1/S2 layer:  45%|████▍     | 165/367 [06:18<06:51,  2.03s/it]S1/S2 layer:  45%|████▌     | 166/367 [06:21<07:25,  2.21s/it]S1/S2 layer:  46%|████▌     | 167/367 [06:23<07:00,  2.10s/it]S1/S2 layer:  46%|████▌     | 168/367 [06:26<07:29,  2.26s/it]S1/S2 layer:  46%|████▌     | 169/367 [06:28<07:38,  2.32s/it]S1/S2 layer:  46%|████▋     | 170/367 [06:31<07:54,  2.41s/it]S1/S2 layer:  47%|████▋     | 171/367 [06:33<08:03,  2.47s/it]S1/S2 layer:  47%|████▋     | 172/367 [06:36<07:58,  2.45s/it]S1/S2 layer:  47%|████▋     | 173/367 [06:38<07:47,  2.41s/it]S1/S2 layer:  47%|████▋     | 174/367 [06:41<07:58,  2.48s/it]S1/S2 layer:  48%|████▊     | 175/367 [06:43<08:03,  2.52s/it]S1/S2 layer:  48%|████▊     | 176/367 [06:46<07:52,  2.47s/it]S1/S2 layer:  48%|████▊     | 177/367 [06:48<07:57,  2.51s/it]S1/S2 layer:  49%|████▊     | 178/367 [06:51<08:08,  2.59s/it]S1/S2 layer:  49%|████▊     | 178/367 [06:53<07:19,  2.33s/it]
Traceback (most recent call last):
  File "/home/jaeung/activation-patching-unlearning/exp_s1_teacher_forcing.py", line 1135, in main
    results, gk_count, categories, avg_udr, skipped_indices = run_s1_s2_side_by_side(
  File "/home/jaeung/activation-patching-unlearning/exp_s1_teacher_forcing.py", line 951, in run_s1_s2_side_by_side
    log_file.flush()
OSError: [Errno 28] No space left on device

During handling of the above exception, another exception occurred:

OSError: [Errno 28] No space left on device

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jaeung/activation-patching-unlearning/exp_s1_teacher_forcing.py", line 1205, in <module>
    main()
  File "/home/jaeung/activation-patching-unlearning/exp_s1_teacher_forcing.py", line 1173, in main
    print(summary_msg)
OSError: [Errno 28] No space left on device
